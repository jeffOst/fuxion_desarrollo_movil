"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6728],{5897:(B,D,d)=>{d.d(D,{A:()=>I});const I=(0,d(2726).fo)("Browser",{web:()=>d.e(3671).then(d.bind(d,3671)).then(C=>new C.BrowserWeb)})},5961:(B,D,d)=>{d.d(D,{GW:()=>I,dk:()=>C,oK:()=>v});var v=function(b){return b.Prompt="PROMPT",b.Camera="CAMERA",b.Photos="PHOTOS",b}(v||{}),I=function(b){return b.Rear="REAR",b.Front="FRONT",b}(I||{}),C=function(b){return b.Uri="uri",b.Base64="base64",b.DataUrl="dataUrl",b}(C||{})},8162:(B,D,d)=>{d.d(D,{V1:()=>C,dk:()=>I.dk,oK:()=>I.oK});var v=d(2726),I=d(5961);const C=(0,v.fo)("Camera",{web:()=>d.e(6468).then(d.bind(d,6468)).then(b=>new b.CameraWeb)})},5346:(B,D,d)=>{d.d(D,{ez:()=>I,tP:()=>v});var v=function(m){return m.Documents="DOCUMENTS",m.Data="DATA",m.Library="LIBRARY",m.Cache="CACHE",m.External="EXTERNAL",m.ExternalStorage="EXTERNAL_STORAGE",m}(v||{}),I=function(m){return m.UTF8="utf8",m.ASCII="ascii",m.UTF16="utf16",m}(I||{})},1461:(B,D,d)=>{d.d(D,{fy:()=>C,tP:()=>I.tP});var v=d(2726),I=d(5346);const C=(0,v.fo)("Filesystem",{web:()=>d.e(4522).then(d.bind(d,4522)).then(b=>new b.FilesystemWeb)})},4160:(B,D,d)=>{d.d(D,{J:()=>P});var v=d(5861),I=d(2519),C=d(6242),b=d(9862),m=d(2014);let P=(()=>{var T;class L{constructor(l,c){this.httpClient=l,this.storage=c,this.urlApiProd=I.N.UrlDomainLocal+"aw_modulos/mante/api/CApiInformeTecnico.php",this.urlApiInf=I.N.UrlDomainLocal+"aw_modulos/mante/api/CApiInformeTablero.php",this.confirmRequest=""}ListFindOts(l,c,g){let u=JSON.stringify({acc:1,s:l,idusu:c,iddevice:g});return this.httpClient.post(this.urlApiProd,u).toPromise().then(f=>f)}SaveCheckListCab(l,c,g){let u=JSON.stringify({acc:2,id_orden_trab_cab:l,idusu:c,iddevice:g});return this.httpClient.post(this.urlApiProd,u).toPromise().then(f=>f)}FormFindPaso1(l,c,g){let u=JSON.stringify({acc:3,idchecklistcab:l,idusu:c,iddevice:g});return this.httpClient.post(this.urlApiProd,u).toPromise().then(f=>f)}FLoadPiezasAcordion(l,c,g){let u=JSON.stringify({acc:7,id:l,p2:c,cod_inf:g});return this.httpClient.post(this.urlApiProd,u).toPromise().then(f=>f)}FLoadServiciosxPiezas(l,c){let g=JSON.stringify({acc:8,id:l,p2:c});return this.httpClient.post(this.urlApiProd,g).toPromise().then(u=>u)}GuardarFormPaso1(l){var c=this;return(0,v.Z)(function*(){console.log("Dentro::GuardarFormulario::>",l);let u=c.urlApiProd,f=JSON.stringify(l);return c.httpClient.post(u+"?acc=4",f).toPromise()})()}GuardarinfPaso1(l){var c=this;return(0,v.Z)(function*(){console.log("Dentro::GuardarFormulario::>",l);let u=c.urlApiInf,f=JSON.stringify(l);return c.httpClient.post(u+"?acc=2",f).toPromise()})()}GuardarinfPaso2(l){var c=this;return(0,v.Z)(function*(){console.log("Dentro::GuardarFormulario::>",l);let u=c.urlApiInf,f=JSON.stringify(l);return c.httpClient.post(u+"?acc=3",f).toPromise()})()}GuardarinfPaso3(l){var c=this;return(0,v.Z)(function*(){console.log("Dentro::GuardarFormulario::>",l);let u=c.urlApiInf,f=JSON.stringify(l);return c.httpClient.post(u+"?acc=4",f).toPromise()})()}GuardarinfPaso4(l){var c=this;return(0,v.Z)(function*(){console.log("Dentro::GuardarFormulario::>",l);let u=c.urlApiInf,f=JSON.stringify(l);return c.httpClient.post(u+"?acc=5",f).toPromise()})()}GuardarinfPaso5(l){var c=this;return(0,v.Z)(function*(){let u=c.urlApiInf,f=JSON.stringify(l);return console.log("datos enviados",f),c.httpClient.post(u+"?acc=6",f).toPromise()})()}GuardarFormPaso2(l,c,g,u,f,F,R){var N=this;return(0,v.Z)(function*(){let w,Y=N.urlApiProd,W=JSON.stringify({idservicio:l,idpapa:c,idhijo:g,idusuario:u,acc:9,idclase:f,ck:F,cod_material:R});return N.httpClient.post(Y+"?acc=6",W).toPromise().then(x=>{console.log(x),w=x,N.confirmSaveBd=w[0].o_nres,N.confirmRequest=w},x=>{console.log(x,"Error- something is wrong!")})})()}FormFindPaso3(l,c,g){let u=JSON.stringify({acc:7,idchecklistcab:l,idusu:c,iddevice:g});return this.httpClient.post(this.urlApiProd,u).toPromise().then(f=>f)}GuardarFormPaso3(l){var c=this;return(0,v.Z)(function*(){let g,u=c.urlApiProd,f=JSON.stringify(l);return c.httpClient.post(u+"?acc=8",f).toPromise().then(F=>{console.log(F),g=F,c.confirmSaveBd=g[0].o_nres,c.confirmRequest=g},F=>{console.log(F,"Error- something is wrong!")})})()}FormFindPaso5(l,c,g){let u=JSON.stringify({acc:10,id:l,idusu:c,iddevice:g});return this.httpClient.post(this.urlApiProd,u).toPromise().then(f=>f)}GuardarFormPaso5(l){var c=this;return(0,v.Z)(function*(){let u=c.urlApiProd,f=JSON.stringify(l);return c.httpClient.post(u+"?acc=11",f).toPromise()})()}FormFindPaso6(l,c,g){let u=JSON.stringify({acc:12,idchecklistcab:l,idusu:c,iddevice:g});return this.httpClient.post(this.urlApiProd,u).toPromise().then(f=>f)}GuardarFormPaso6(l){var c=this;return(0,v.Z)(function*(){let u=c.urlApiProd,f=JSON.stringify(l);return c.httpClient.post(u+"?acc=13",f).toPromise()})()}GuardarAplicaPaso(l,c,g){var u=this;return(0,v.Z)(function*(){let f,R,F=u.urlApiProd;R={idchecklistcab:l,numeroPaso:c,ck:g};let N=JSON.stringify(R);return u.httpClient.post(F+"?acc=15",N).toPromise().then(w=>{console.log(w),f=w,u.confirmSaveBd=f[0].o_nres,u.confirmRequest=f},w=>{console.log(w,"Error- something is wrong!")})})()}getImages(l){return this.httpClient.get(`${this.urlApiProd}?acc=5&id=`+l)}uploadImage(l,c,g){let u=new FormData;return u.append("file",l,"myimage."+g),u.append("id",c),u.append("acc","6"),u.append("type","image/png"),this.httpClient.post(this.urlApiProd,u)}UpLoadImageMultiple(l,c,g){try{let u=new FormData;u.append("id",c),u.append("acc","15"),u.append("type","image/png");for(let f=0;f<l.length;f++)console.log("image::ruta=>::>",l[f]),u.append("images[]",l[f],`image_${f}.jpg`);return this.httpClient.post(this.urlApiProd,u)}catch(u){console.error("Error al enviar im\xe1genes al API:",u)}}LoadPdfInformeTecnico(l){let c=JSON.stringify({acc:14,idchecklistcab:l});return this.httpClient.post(this.urlApiProd,c).toPromise().then(g=>g)}deleteImage(l){return this.httpClient.delete(`${this.urlApiProd}?acc=16&id=${l}`)}}return(T=L).\u0275fac=function(l){return new(l||T)(C.LFG(b.eN),C.LFG(m.K))},T.\u0275prov=C.Yz7({token:T,factory:T.\u0275fac,providedIn:"root"}),L})()},2087:(B,D,d)=>{function C(){const b=new FileReader;return b.__zone_symbol__originalInstance||b}d.d(D,{y3:()=>C})},169:(B,D,d)=>{d.r(D),d.d(D,{MttoWinInformeTecnico1Page:()=>Pe});var v=d(5861),I=d(5897),C=d(6814),b=d(2519),m=d(95),P=d(6728),T=d(8162),L=d(1461),V=d(2087),l=d(7582),g=d(5592),u=d(2438),f={error:"cordova_not_available"},F={error:"plugin_not_installed"};function R(i){if(typeof window<"u"&&window.angular){var r=window.document,e=window.angular.element(r.querySelector("[ng-app]")||r.body).injector();if(e)return e.get("$q")(function(a,s){i(a,s)});console.warn("Angular 1 was detected but $q couldn't be retrieved. This is usually when the app is not bootstrapped on the html or body tag. Falling back to native promises which won't trigger an automatic digest when promises resolve.")}return function(){if(Promise)return new Promise(function(a,s){i(a,s)});console.error("No Promise support or polyfill found. To enable Ionic Native support, please add the es6-promise polyfill before this script, or run with a library like Angular or on a recent browser.")}()}function W(i,o,r){var e,n;"string"==typeof i?e=i:(e=i.constructor.getPluginRef(),r=i.constructor.getPluginName(),n=i.constructor.getPluginInstallName());var a=H(e);return!(!a||o&&typeof a[o]>"u")||(typeof window>"u"||!window.cordova?(function ie(i,o){typeof process>"u"&&console.warn(o?"Native: tried calling "+i+"."+o+", but Cordova is not available. Make sure to include cordova.js or run in a device/simulator":"Native: tried accessing the "+i+" plugin but Cordova is not available. Make sure to include cordova.js or run in a device/simulator")}(r,o),f):(function oe(i,o,r){console.warn(r?"Native: tried calling "+i+"."+r+", but the "+i+" plugin is not installed.":"Native: tried accessing the "+i+" plugin but it's not installed."),o&&console.warn("Install the "+i+" plugin: 'ionic cordova plugin add "+o+"'")}(r,n,o),F))}function Z(i,o,r,e,n,a){void 0===e&&(e={}),r=function $(i,o,r,e){if(void 0===o&&(o={}),o.sync)return i;if("reverse"===o.callbackOrder)i.unshift(e),i.unshift(r);else if("node"===o.callbackStyle)i.push(function(h,p){h?e(h):r(p)});else if("object"===o.callbackStyle&&o.successName&&o.errorName){var n={};n[o.successName]=r,n[o.errorName]=e,i.push(n)}else if(typeof o.successIndex<"u"||typeof o.errorIndex<"u"){var a=function(){o.successIndex>i.length?i[o.successIndex]=r:i.splice(o.successIndex,0,r)},s=function(){o.errorIndex>i.length?i[o.errorIndex]=e:i.splice(o.errorIndex,0,e)};o.successIndex>o.errorIndex?(s(),a()):(a(),s())}else i.push(r),i.push(e);return i}(r,e,n,a);var s=W(i,o);if(!0===s){var h=H(i.constructor.getPluginRef());return h[o].apply(h,r)}return s}function H(i){return typeof window<"u"?X(window,i):null}function X(i,o){for(var r=o.split("."),e=i,n=0;n<r.length;n++){if(!e)return null;e=e[r[n]]}return e}var ae=function(){function i(){}return i.installed=function(){return!0===W(this.pluginRef)},i.getPlugin=function(){return typeof window<"u"?function re(i,o){for(var r=o.split("."),e=i,n=0;n<r.length;n++){if(!e)return null;e=e[r[n]]}return e}(window,this.pluginRef):null},i.getPluginName=function(){return this.pluginName},i.getPluginRef=function(){return this.pluginRef},i.getPluginInstallName=function(){return this.plugin},i.getSupportedPlatforms=function(){return this.platforms},i.pluginName="",i.pluginRef="",i.plugin="",i.repo="",i.platforms=[],i.install="",i}();function K(i,o,r,e){return function(i,o,r){return void 0===r&&(r={}),function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return r.sync?Z(i,o,e,r):r.observable?function z(i,o,r,e){return void 0===e&&(e={}),new g.y(function(n){var a;return a=e.destruct?Z(i,o,r,e,function(){for(var s=[],h=0;h<arguments.length;h++)s[h]=arguments[h];return n.next(s)},function(){for(var s=[],h=0;h<arguments.length;h++)s[h]=arguments[h];return n.error(s)}):Z(i,o,r,e,n.next.bind(n),n.error.bind(n)),a&&a.error&&(n.error(a.error),n.complete()),function(){try{if(e.clearFunction)return e.clearWithArgs?Z(i,e.clearFunction,r,e,n.next.bind(n),n.error.bind(n)):Z(i,e.clearFunction,[])}catch(s){console.warn("Unable to clear the previous observable watch for",i.constructor.getPluginName(),o),console.warn(s)}}})}(i,o,e,r):r.eventObservable&&r.event?function Y(i,o){return o=typeof window<"u"&&o?X(window,o):o||(typeof window<"u"?window:{}),(0,u.R)(o,i)}(r.event,r.element):r.otherPromise?function w(i,o,r,e){return void 0===e&&(e={}),R(function(n,a){var s=Z(i,o,r,e);s?s.error?a(s.error):s.then&&s.then(n).catch(a):a({error:"unexpected_error"})})}(i,o,e,r):function N(i,o,r,e){void 0===e&&(e={});var n,a,s=R(function(h,p){n=e.destruct?Z(i,o,r,e,function(){for(var y=[],_=0;_<arguments.length;_++)y[_]=arguments[_];return h(y)},function(){for(var y=[],_=0;_<arguments.length;_++)y[_]=arguments[_];return p(y)}):Z(i,o,r,e,h,p),a=p});return n&&n.error&&(s.catch(function(){}),"function"==typeof a&&a(n.error)),s}(i,o,e,r)}}(i,o,r).apply(this,e)}!function c(){if(typeof process>"u"){var i=typeof window<"u"?window:{},r=Date.now(),e=!1;i.document.addEventListener("deviceready",function(){console.log("Ionic Native: deviceready event fired after "+(Date.now()-r)+" ms"),e=!0}),setTimeout(function(){!e&&i.cordova&&console.warn("Ionic Native: deviceready did not fire within 5000ms. This can happen when plugins are in an inconsistent state. Try removing plugins from plugins/ and reinstalling them.")},5e3)}}();var t=d(6242),j=function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return(0,l.ZT)(o,i),o.prototype.getSupportInfo=function(){return K(this,"getSupportInfo",{},arguments)},o.prototype.canViewDocument=function(r,e,n,a,s,h,p){return K(this,"canViewDocument",{sync:!0},arguments)},o.prototype.viewDocument=function(r,e,n,a,s,h,p){return K(this,"viewDocument",{sync:!0},arguments)},o.\u0275fac=(()=>{let r;return function(n){return(r||(r=t.n5z(o)))(n||o)}})(),o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),o.pluginName="Document Viewer",o.plugin="cordova-plugin-document-viewer",o.pluginRef="SitewaertsDocumentViewer",o.repo="https://github.com/sitewaerts/cordova-plugin-document-viewer",o.platforms=["Android","iOS","Windows"],o=(0,l.gn)([],o)}(ae),ce=(d(2726),d(5472)),ue=d(4160),de=d(2014),fe=d(4248),he=d(6172);function me(i,o){if(1&i&&(t.TgZ(0,"ion-select-option",22),t._uU(1),t.qZA()),2&i){const r=o.$implicit;t.Q6J("value",r.codigo),t.xp6(1),t.hij("",r.nombre," ")}}function ge(i,o){if(1&i&&(t.TgZ(0,"ion-item")(1,"ion-radio",23),t._uU(2),t.qZA()()),2&i){const r=o.$implicit;t.xp6(1),t.s9C("value",r.id),t.xp6(1),t.Oqu(r.text)}}function pe(i,o){if(1&i&&(t.TgZ(0,"ion-list")(1,"ion-item-divider")(2,"ion-label"),t._uU(3),t.qZA()(),t.YNc(4,ge,3,2,"ion-item",15),t.qZA()),2&i){const r=o.$implicit;t.xp6(3),t.hij(" ",r.text," "),t.xp6(1),t.Q6J("ngForOf",r.children)}}function ve(i,o){if(1&i&&(t.TgZ(0,"ion-select-option",22),t._uU(1),t.qZA()),2&i){const r=o.$implicit;t.Q6J("value",r.codigo),t.xp6(1),t.hij("",r.nombre," ")}}function _e(i,o){if(1&i){const r=t.EpF();t.TgZ(0,"ion-item")(1,"ion-thumbnail",24),t._UZ(2,"ion-img",25),t.qZA(),t._UZ(3,"ion-img",25),t.TgZ(4,"ion-label"),t._uU(5),t.qZA(),t.TgZ(6,"ion-button",26),t.NdJ("click",function(){const n=t.CHM(r),a=n.$implicit,s=n.index,h=t.oxw();return t.KtG(h.deleteImage(a.idadjunto,s))}),t._UZ(7,"ion-icon",27),t.qZA()()}if(2&i){const r=o.$implicit,e=t.oxw();t.xp6(2),t.Q6J("src",e.DirectorioFotos+r.idnomadjunto),t.xp6(1),t.Q6J("src",r.webviewPath),t.xp6(2),t.Oqu(r.name)}}let Pe=(()=>{var i;class o{constructor(e,n,a,s,h,p,y,_,A,E,be){let k;this.formBuilder=e,this.navCtrl=n,this.loadingController=a,this.ApiService=s,this.storage=h,this.alertController=p,this.router=y,this.globalVal=_,this.ref=A,this.actionSheetCtrl=E,this.documentViewer=be,this.disableButtonPaso1=!0,this.checklist_paso1_apli_ck=!1,this.aisla_tierra_apl_ck=!0,this.aisla_entre_fases_apl_ck=!0,this.repara_chapa_apl_ck=!0,this.montaje_estator_apl_ck=!0,this.imgs=[],this.images=[],this.DirectorioFotos=b.N.UrlDomainLocal+"aw_file/adjuntos/",this.imageBlobs=[],this.convertBlobToBase64=O=>new Promise((U,te)=>{this.popLodingMenaje=this.loadingController.create({message:"Guardando foto...",translucent:!0}).then(J=>{J.present()}),new FileReader;let M=(0,V.y3)();M.readAsDataURL(O),M.onload=J=>{let q;q=J.target.result,q=this.dataURLtoBlob(q),this.ApiService.uploadImage(q,this.corre_inf_cab,"png").subscribe(Q=>{this.loadingController.dismiss(),this.loadImages(this.corre_inf_cab),console.log("salio okkkk::",Q)},Q=>{console.log("error__::>",Q)})}}).finally(()=>{console.log("convertBlobToBase64:::",this.convertBlobToBase64)}),this.ConvertToBlobToBase64=O=>new Promise((U,te)=>{const G=new FileReader;G.readAsDataURL(O),G.onload=()=>{const J=new Blob([G.result],{type:"image/jpeg"});this.addImageBlob(J),U()},G.onerror=M=>{te(M)}}),this.storage.get("USER_INFO").then(O=>{k=O,this.NombresUsuarioLocal=k.user_name,this.IdUsuarioLocal=k.user_id,this.storage.get("DEVICE_INFO").then(U=>{k=U,this.NombreDispositivo=k.name,this.IdDispositivo=k.uuid})}),this.FormCheckListPaso1=this.formBuilder.group({fech_de_registro:["",m.kI.required],corre_fisico:["",m.kI.required],id_persona:["",m.kI.required],Fech_de_sistema:[""],fech_de_inicio:["",m.kI.required],tec_responsable:["",m.kI.required],Procedencia:["",m.kI.required],equipo:["",m.kI.required],equipo_model:["",m.kI.required],dias_trabajados:[""],Taller_lima:["",m.kI.required],operaciones:["",m.kI.required],estado_informe:["",m.kI.required],conf_jefe_planta:[""],conf_super_planta:["",m.kI.required],Conf_tecnico:["",m.kI.required],analisis_del_problema:[""],componentes_de_reclamo:[""],nro_fotos:[""],Y06002:["",m.kI.required],nrofisico_alternativo:[""],codsmg:[""],corre_inf_cab:["",m.kI.required],idactivos:[""],idisla_ic:[""],dias_trabajados_manual:[""],idresponsabilidad:[""],falla_primaria_ic:["",m.kI.required],falla_secundaria_ic:["",m.kI.required]}),console.log(this.router.getCurrentNavigation().extras);var ee=this;if(""==this.globalVal.checklist_paso_pivot)try{this.navParamsAny=this.router.getCurrentNavigation().extras.state.Row,_.corre_inf_cab=this.navParamsAny.corre_inf_cab}catch(O){console.log(O),this.corre_inf_cab=_.corre_inf_cab}else this.corre_inf_cab=_.corre_inf_cab;this.storage.get("USER_PERMISO").then(O=>{O.forEach(function(U){ee.disableButtonPaso1=32!=U.Nivel})})}onTouched(e){console.log(e)}FLoadForms(){this.loadingController.create({message:"Cargando lista....",translucent:!0}).then(n=>{n.present(),this.corre_inf_cab=this.globalVal.corre_inf_cab,console.log(this.corre_inf_cab),this.ApiService.FormFindPaso1(this.corre_inf_cab,"1","H").then(a=>{this.EditDataRest=a.form,console.log("formularrioooo",this.EditDataRest),this.DsResponabilidad=a.responsabilidad,this.Opciones1=a.responsable,this.DsIsla=a.isla,console.log("this.Opciones1",this.Opciones1),console.log(this.DsResponabilidad);try{this.FormCheckListPaso1.setValue({dias_trabajados_manual:this.EditDataRest[0].dias_trabajados_manual,Y06002:this.EditDataRest[0].Y06002,estado_informe:this.EditDataRest[0].estado_informe,fech_de_registro:this.EditDataRest[0].fech_de_registro,corre_fisico:this.EditDataRest[0].corre_fisico,id_persona:this.EditDataRest[0].id_persona,Fech_de_sistema:this.EditDataRest[0].Fech_de_sistema,fech_de_inicio:this.EditDataRest[0].fech_de_inicio,tec_responsable:this.EditDataRest[0].tec_responsable,Procedencia:this.EditDataRest[0].Procedencia,equipo:this.EditDataRest[0].equipo,equipo_model:this.EditDataRest[0].equipo_model,dias_trabajados:this.EditDataRest[0].dias_trabajados,Taller_lima:this.EditDataRest[0].Taller_lima,operaciones:this.EditDataRest[0].operaciones,conf_jefe_planta:this.EditDataRest[0].conf_jefe_planta,conf_super_planta:this.EditDataRest[0].conf_super_planta,Conf_tecnico:this.EditDataRest[0].Conf_tecnico,analisis_del_problema:this.EditDataRest[0].analisis_del_problema,componentes_de_reclamo:this.EditDataRest[0].componentes_de_reclamo,nro_fotos:this.EditDataRest[0].nro_fotos,nrofisico_alternativo:this.EditDataRest[0].nrofisico_alternativo,codsmg:this.EditDataRest[0].codsmg,corre_inf_cab:this.EditDataRest[0].corre_inf_cab,idactivos:this.EditDataRest[0].idactivos,idisla_ic:this.EditDataRest[0].idisla_ic,idresponsabilidad:this.EditDataRest[0].idresponsabilidad,falla_primaria_ic:this.EditDataRest[0].falla_primaria_ic,falla_secundaria_ic:this.EditDataRest[0].falla_secundaria_ic}),this.reponsablePivotSelectedText=this.EditDataRest[0].responsabilidad,this.islaPivotSelectedText=this.EditDataRest[0].isla,this.loadImages(this.corre_inf_cab)}catch(s){console.log("error:::>",s)}}).finally(()=>{this.loadingController.dismiss()})})}SaveFormTerminadoPaso1(){if(this.FormCheckListPaso1.valid)this.alertSiNo=this.alertController.create({header:"CONTROL DE MOTOR ELECTRICO",subHeader:"",mode:"ios",backdropDismiss:!0,message:"Confirmar que desea guardar?",buttons:[{text:"Aceptar",cssClass:"alert-button-group",role:"A",handler:()=>{}},{text:"Cancelar",role:"F",handler:()=>{}}]}).then(e=>{e.present(),e.onDidDismiss().then(n=>{console.log("aceptaPop::::>>",n),"A"==n.role&&(this.corre_inf_cab=this.globalVal.corre_inf_cab,0==this.disableButtonPaso1&&this.FormCheckListPaso1.controls.idsupervisor_responsable_cmc.setValue(this.IdUsuarioLocal),this.loadingController.create({message:"Guardando Paso 1...",translucent:!0}).then(s=>{s.present()}),this.ApiService.GuardarFormPaso1(this.FormCheckListPaso1.value).then(s=>{this.loadingController.dismiss(),alert("Guardado correctamente.")}).finally(()=>{}).catch(s=>{console.log("errror:::>>>>>>>>>",s)}))})});else{for(let e in this.FormCheckListPaso1.controls)this.FormCheckListPaso1.controls[e].setValue(this.FormCheckListPaso1.controls[e].value),this.FormCheckListPaso1.controls[e].markAsTouched();this.alertSiNo=this.alertController.create({header:"CONTROL DE MOTOR ELECTRICO",subHeader:"",mode:"ios",backdropDismiss:!0,message:"Falta seleccionar todos los datos",buttons:[{text:"Aceptar",cssClass:"alert-button-group",role:"A",handler:()=>{}}]}).then(e=>{e.present(),e.onDidDismiss().then(n=>{})})}}SaveFormBorradorPaso1(){var e=this;this.alertSiNo=this.alertController.create({header:"INFORME TECNICO",subHeader:"DATOS GENERALES",mode:"ios",backdropDismiss:!0,cssClass:"alerta-ok",message:"Confirmar que desea guardar?",buttons:[{text:"Aceptar",cssClass:"alert-button-group",role:"A",handler:()=>{}},{text:"Cancelar",role:"F",handler:()=>{}}]}).then(n=>{n.present(),n.onDidDismiss().then(a=>{"A"==a.role&&(this.loadingController.create({message:"Guardando datos generales...",translucent:!0}).then(h=>{h.present()}),this.corre_inf_cab=this.globalVal.corre_inf_cab,this.ApiService.GuardarFormPaso1(this.FormCheckListPaso1.value).then(function(){var h=(0,v.Z)(function*(p){e.loadingController.dismiss();let y="0"==p[0].o_nres?"alerta-error":"alerta-ok";yield(yield e.alertController.create({header:"ORDEN DE TRABAJO",subHeader:"DATOS GENERALES",cssClass:y,mode:"ios",animated:!0,message:p[0].o_msj,buttons:[{text:"Aceptar",handler:()=>{console.log("Operaci\xf3n confirmada")}}]})).present()});return function(p){return h.apply(this,arguments)}}()).finally(()=>{}).catch(h=>{console.log("errror:::>>>>>>>>>",h)}))})})}ionViewWillEnter(){let e;this.checklist_paso1_apli_ck="0"==this.globalVal.checklist_paso1_apli,this.FLoadForms(),e={detail:{checked:this.checklist_paso1_apli_ck,jc:0}}}ngOnInit(){}FSelectChangeResponsable(e,n){console.log("select_change_material::",this.DsResponabilidad);for(const a of this.DsResponabilidad)console.log(a.codigo,e.detail.value),a.codigo==e.detail.value&&(this.FormCheckListPaso1.controls.idresponsabilidad.setValue(a.codigo),this.reponsablePivotSelectedText=a.nombre)}FSelectChangeIsla(e,n){for(const a of this.DsIsla)console.log(a.codigo,e.detail.value),a.codigo==e.detail.value&&(this.FormCheckListPaso1.controls.idisla_ic.setValue(a.codigo),this.islaPivotSelectedText=a.nombre)}deleteImage(e,n){this.alertSiNo=this.alertController.create({header:"INFORME TECNICO",subHeader:"GENERAL",mode:"ios",backdropDismiss:!0,message:"Confirmar que desea eliminar?",buttons:[{text:"Aceptar",cssClass:"alert-button-group",role:"A",handler:()=>{}},{text:"Cancelar",role:"F",handler:()=>{}}]}).then(a=>{a.present(),a.onDidDismiss().then(s=>{console.log("aceptaPop::::>>",s),"A"==s.role&&this.ApiService.deleteImage(e).subscribe(h=>{this.images.splice(n,1)})})})}loadImages(e){this.ApiService.getImages(e).subscribe(n=>{this.images=n,this.ref.detectChanges()})}selectImageSource(){var e=this;return(0,v.Z)(function*(){const n=[{text:"Tome una Foto",icon:"camera",handler:()=>{console.log(T.oK.Camera),e.addNewToGallery(1)}},{text:"Elegir desde las fotos",icon:"image",handler:()=>{console.log("Photos",T.oK.Photos),e.pickImages_buton()}}];yield(yield e.actionSheetCtrl.create({header:"Selecionar Image",buttons:n})).present()})()}addNewToGallery(e){var n=this;return(0,v.Z)(function*(){let a;console.log("addNewToGallery::::tp::::>",e),1==e&&(a=yield T.V1.getPhoto({resultType:T.dk.Uri,source:T.oK.Camera,quality:100,width:800,height:800}).finally(()=>{console.log("capturedPhoto::::",a)})),yield n.savePicture(a)})()}convertToBase64(e){return(0,v.Z)(function*(){return(yield L.fy.readFile({path:e})).data.toString()})()}sendImagesToAPI(e){var n=this;return(0,v.Z)(function*(){for(const h of e){const y=yield(yield fetch(h)).blob();yield n.ConvertToBlobToBase64(y)}return n.imageBlobs})()}savePicture(e){var n=this;return(0,v.Z)(function*(){const a=yield n.readAsBase64(e),s=(new Date).getTime()+".jpeg";return yield L.fy.writeFile({path:s,data:a,directory:L.tP.Data}),{filepath:s,webviewPath:e.webPath}})()}readAsBase64(e){var n=this;return(0,v.Z)(function*(){const s=yield(yield fetch(e.webPath)).blob();return yield n.convertBlobToBase64(s)})()}dataURLtoBlob(e){console.log("dentro fucion dataURLtoBlob:",e);for(var n=e.split(","),a=n[0].match(/:(.*?);/)[1],s=atob(n[1]),h=s.length,p=new Uint8Array(h);h--;)p[h]=s.charCodeAt(h);return new Blob([p],{type:a})}DownloadOpenLocalPdf(){this.ApiService.LoadPdfInformeTecnico(this.corre_inf_cab).then(e=>{this.EditDataRest=e,console.log("this.Opciones1",this.EditDataRest);try{let n=b.N.UrlDomainLocal+"aw_file/"+this.EditDataRest.nomfile;console.log(n),I.A.open({url:n}),setTimeout(()=>{I.A.close()},5e3)}catch(n){console.log("error:::>",n)}}).finally(()=>{this.loadingController.dismiss()})}OpenLocalPdf(){let e=b.N.UrlDomainLocal+"aw_file/pdfxd.pdf";console.log(e),this.documentViewer.viewDocument(e,"application/pdf",{title:"My PDF"})}addImageBlob(e){this.imageBlobs.push(e)}pickImages_buton(){var e=this;return(0,v.Z)(function*(){const n={width:800,height:800,quality:100,correctOrientation:!0};try{const s=(yield T.V1.pickImages(n)).photos;e.imgs=[],e.imageBlobs=[];for(let h=0;h<s.length;h++)e.imgs.push(s[h].webPath);e.sendImages()}catch(a){console.error("Error picking images",a)}})()}sendImages(){this.popLodingMenaje=this.loadingController.create({message:"Guardando foto...",translucent:!0}).then(e=>{e.present()}),Promise.all(this.imgs.map(e=>this.convertAndAddToBlobs(e))).then(()=>{this.ApiService.UpLoadImageMultiple(this.imageBlobs,this.corre_inf_cab,"png").subscribe(n=>{this.loadingController.dismiss(),this.loadImages(this.corre_inf_cab),console.log("salio okkkk::",n)},n=>{console.log("error__::>",n)})}).catch(e=>{console.error("Error converting and adding Blobs",e)})}convertAndAddToBlobs(e){var n=this;return(0,v.Z)(function*(){try{console.log("convertAndAddToBlobs",e);const a=yield n.getBlobFromImagePath(e);n.addImageBlob(a)}catch(a){console.error("Error converting image to Blob",a)}})()}getBlobFromImagePath(e){return(0,v.Z)(function*(){return yield(yield fetch(e)).blob()})()}}return(i=o).\u0275fac=function(e){return new(e||i)(t.Y36(m.QS),t.Y36(ce.SH),t.Y36(P.HT),t.Y36(ue.J),t.Y36(de.K),t.Y36(P.Br),t.Y36(fe.F0),t.Y36(he.X),t.Y36(t.sBO),t.Y36(P.BX),t.Y36(j))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-mtto-win-informe-tecnico1"]],standalone:!0,features:[t._Bn([j]),t.jDz],decls:63,vars:8,consts:[["mode","ios"],["text-capitalize",""],[1,"ion-padding"],[3,"formGroup"],["f","ngForm"],["mode","ios",1,"ion-no-padding"],["slot","start",3,"click"],["slot","start","name","cloud-download-sharp"],["cancelText","Cancelar","placeholder","Seleccionar Responsabilidad","color","primary","interface","action-sheet","mode","ios",3,"selectedText","ionChange"],[3,"value",4,"ngFor","ngForOf"],["type","text","formControlName","dias_trabajados_manual"],["type","text","maxlength","80","formControlName","Y06002"],["type","text","maxlength","80","formControlName","equipo_model"],[2,"width","50%"],["formControlName","Taller_lima",3,"allowEmptySelection"],[4,"ngFor","ngForOf"],["type","text","maxlength","80","formControlName","fech_de_registro"],["cancelText","Cancelar","placeholder","Seleccionar Isla","color","primary","interface","action-sheet","mode","ios",3,"selectedText","ionChange"],["expand","block"],["slot","end",3,"click"],["name","camera"],["expand","full",3,"click"],[3,"value"],["aria-label","Custom checkbox",3,"value"],["slot","start"],[3,"src"],["slot","end","fill","clear",3,"click"],["slot","icon-only","name","trash-outline"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-item")(3,"ion-title",1)(4,"ion-label"),t._uU(5,"DATOS GENERALES"),t.qZA()()()()(),t.TgZ(6,"ion-content",2)(7,"form",3,4)(9,"ion-list",5)(10,"ion-item")(11,"ion-button",6),t.NdJ("click",function(){return n.DownloadOpenLocalPdf()}),t._UZ(12,"ion-icon",7),t._uU(13," Descargar PDF"),t.qZA()(),t.TgZ(14,"ion-item")(15,"ion-label")(16,"p"),t._uU(17,"RESPONSABILIDAD"),t.qZA(),t.TgZ(18,"ion-select",8),t.NdJ("ionChange",function(s){return n.FSelectChangeResponsable(s,0)}),t.YNc(19,me,2,2,"ion-select-option",9),t.qZA()()(),t.TgZ(20,"ion-item")(21,"ion-label")(22,"p"),t._uU(23,"DIAS TRABAJADOS"),t.qZA(),t._UZ(24,"ion-input",10),t.qZA()(),t.TgZ(25,"ion-item")(26,"ion-label")(27,"p"),t._uU(28,"PROCEDENCIA"),t.qZA(),t._UZ(29,"ion-input",11),t.qZA()(),t.TgZ(30,"ion-item")(31,"ion-label")(32,"p"),t._uU(33,"POTENCIA TIPO:"),t.qZA(),t._UZ(34,"ion-input",12),t.qZA()(),t.TgZ(35,"ion-item")(36,"ion-label")(37,"p"),t._uU(38,"FALLA COM\xdaN"),t.qZA(),t.TgZ(39,"ion-card",13)(40,"ion-card-content")(41,"ion-radio-group",14),t.YNc(42,pe,5,2,"ion-list",15),t.qZA()()()()(),t.TgZ(43,"ion-item")(44,"ion-label")(45,"p"),t._uU(46,"F.INFORME:"),t.qZA(),t._UZ(47,"ion-input",16),t.qZA()(),t.TgZ(48,"ion-item")(49,"ion-label")(50,"p"),t._uU(51,"ISLA:"),t.qZA(),t.TgZ(52,"ion-select",17),t.NdJ("ionChange",function(s){return n.FSelectChangeIsla(s,0)}),t.YNc(53,ve,2,2,"ion-select-option",9),t.qZA()()(),t.TgZ(54,"ion-item",18),t._uU(55,"Fotos: "),t.TgZ(56,"ion-fab-button",19),t.NdJ("click",function(){return n.selectImageSource()}),t._UZ(57,"ion-icon",20),t.qZA()(),t.TgZ(58,"ion-list"),t.YNc(59,_e,8,3,"ion-item",15),t.qZA()()()(),t.TgZ(60,"ion-footer")(61,"ion-button",21),t.NdJ("click",function(){return n.SaveFormBorradorPaso1()}),t._uU(62,"GUARDAR"),t.qZA()()),2&e&&(t.xp6(7),t.Q6J("formGroup",n.FormCheckListPaso1),t.xp6(11),t.Q6J("selectedText",n.reponsablePivotSelectedText),t.xp6(1),t.Q6J("ngForOf",n.DsResponabilidad),t.xp6(22),t.Q6J("allowEmptySelection",!0),t.xp6(1),t.Q6J("ngForOf",n.Opciones1),t.xp6(10),t.Q6J("selectedText",n.islaPivotSelectedText),t.xp6(1),t.Q6J("ngForOf",n.DsIsla),t.xp6(6),t.Q6J("ngForOf",n.images))},dependencies:[P.Pc,P.YG,P.PM,P.FN,P.W2,P.W4,P.fr,P.Gu,P.gu,P.Xz,P.pK,P.Ie,P.rH,P.Q$,P.q_,P.B7,P.se,P.t9,P.n0,P.Bs,P.wd,P.sr,P.U5,P.QI,P.j9,C.ez,C.sg,m.u5,m._Y,m.JJ,m.JL,m.nD,m.UX,m.sg,m.u]}),o})()}}]);