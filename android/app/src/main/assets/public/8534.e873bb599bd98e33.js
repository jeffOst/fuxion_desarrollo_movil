"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8534],{8534:(L,h,s)=>{s.r(h),s.d(h,{MttoOtisPopUpAddPartListPage:()=>U});var _=s(5861),M=s(6895),p=s(433),a=s(5562),e=s(8256),f=s(1456),A=s(1407),O=s(849),T=s(7883);const C=["idinputsearch_equipo"];function Z(l,u){if(1&l){const o=e.EpF();e.TgZ(0,"ion-item-group",16),e.NdJ("click",function(){const i=e.CHM(o).$implicit,r=e.oxw();return e.KtG(r.SeleccionarEquipo(i))}),e.TgZ(1,"ion-item-divider")(2,"ion-note",1),e._uU(3),e.qZA(),e.TgZ(4,"ion-label")(5,"ion-chip",17),e._UZ(6,"ion-icon",18),e.TgZ(7,"ion-label",19),e._uU(8),e.qZA(),e._UZ(9,"ion-icon",20),e.qZA(),e.TgZ(10,"ion-chip",21),e._uU(11),e.qZA()()(),e.TgZ(12,"ion-item",4)(13,"ion-note",1),e._uU(14,"Tipo:"),e.qZA(),e.TgZ(15,"ion-label"),e._uU(16),e.qZA(),e.TgZ(17,"ion-note",22),e._uU(18,"Potencia:"),e.qZA(),e.TgZ(19,"ion-label",22),e._uU(20),e.qZA()(),e.TgZ(21,"ion-item",4)(22,"ion-note",1),e._uU(23,"Marca:"),e.qZA(),e.TgZ(24,"ion-label"),e._uU(25),e.qZA(),e.TgZ(26,"ion-note",22),e._uU(27,"Modelo:\xa0"),e.qZA(),e.TgZ(28,"ion-label",22),e._uU(29),e.qZA()(),e.TgZ(30,"ion-item",4)(31,"ion-note",1),e._uU(32,"Configuracion:"),e.qZA(),e.TgZ(33,"ion-label"),e._uU(34),e.qZA()()()}if(2&l){const o=u.$implicit,t=u.index;e.xp6(3),e.Oqu(t+1),e.xp6(2),e.s9C("color",o.color),e.xp6(3),e.Oqu(o.tipofuente),e.xp6(3),e.hij("",o.totitem,"\xa0Items"),e.xp6(5),e.Oqu(o.tipo),e.xp6(4),e.Oqu(o.potencia),e.xp6(5),e.Oqu(o.marca),e.xp6(4),e.Oqu(o.modelo),e.xp6(5),e.Oqu(o.configuracion)}}let U=(()=>{class l{constructor(o,t,n,i,r,c,P,g,d){let m;this.loadingController=o,this.ApiService=t,this.modalCtrl=n,this.route=i,this.navParams=r,this.alertController=c,this.toastController=P,this.storage=g,this.globalVal=d,this.search_term_equipo="",this.switchButtonSegmento="",this.selectedRow=null,this.tituloVentana="",this.searchTerm="",this.storage.get("USER_INFO").then(q=>{m=q,this.NombresUsuarioLocal=m.user_name,this.IdUsuarioLocal=m.user_id}),this.FormModel={},this.FormModel.idot=this.navParams.get("row").id_orden_trab_cab,this.FormModel.ot=!1,this.FormModel.im=!0,this.FormModel.it=!0,this.FormModel.o_nres=0,this.tituloVentana="PartList",this.FormModel.tipo=d.tipo,this.FormModel.modelo=d.modelo,this.FormModel.marca=d.marca,this.FormModel.potencia=d.potencia}ngOnInit(){}cancelar_listaequipos(o,t,n){var i=this;return(0,_.Z)(function*(){const r={idequipo:o,id_orden_trab_fis_cab:t,fch_inicio_ot:n};yield i.modalCtrl.dismiss(r)})()}lista_equipos(o,t){o.preventDefault(),this.searchTerm=o.target.value,(this.searchTerm.trim().length>=5||1===t)&&this.loadingController.create({message:"Cargando lista...::",translucent:!0}).then(i=>{i.present(),this.ApiService.ListaPartList(this.search_term_equipo,this.FormModel.pd,this.FormModel.ot,this.FormModel.im,this.FormModel.it,"31",this.FormModel.idot).then(c=>{this.results_equipos=c,this.loadingController.dismiss()}).finally(()=>{this.loadingController.dismiss(),setTimeout(()=>{this.idinputsearch_equipo.setFocus()},700)})})}SeleccionarEquipo(o){var t=this;return(0,_.Z)(function*(){yield(yield t.alertController.create({header:"Confirmaci\xf3n",message:"\xbfDesea cargar el PartList seleccionado?",cssClass:"alerta-confirma",mode:"ios",buttons:[{text:"Cancelar",role:"cancel",handler:()=>{console.log("Acci\xf3n cancelada")}},{text:"Aceptar",handler:()=>{t.SaveItemAdded(o)}}]})).present()})()}SaveItemAdded(o){var t=this;return(0,_.Z)(function*(){""!=t.FormModel.potencia?(t.loadingController.create({message:"Guardando PartList...",translucent:!0}).then(i=>{i.present()}),t.FormModel.Y04001=o.Y04001,t.FormModel.IdUsuarioLocal=t.IdUsuarioLocal,yield t.ApiService.GuardarPartList(o).then(function(){var i=(0,_.Z)(function*(r){t.loadingController.dismiss();let c="0"==r[0].o_nres?"alerta-error":"alerta-ok";var g;yield(yield t.alertController.create({header:"ORDEN DE TRABAJO",subHeader:"PartList",cssClass:c,mode:"ios",animated:!0,message:r[0].o_msj,buttons:[{text:"Aceptar",handler:(g=(0,_.Z)(function*(){if(console.log("Operaci\xf3n confirmada"),t.FormModel.o_nres=r[0].o_nres,"1"==r[0].o_nres){if(console.log(t.FormModel.window),t.presentToast(r[0].o_msj),!t.FormModel.window){const d=o;yield t.modalCtrl.dismiss(d)}}else t.presentToast(r[0].o_msj)}),function(){return g.apply(this,arguments)})}]})).present()});return function(r){return i.apply(this,arguments)}}()).finally(()=>{console.log("finally:::>>LN:394")}).catch(i=>{console.log("errror:::>>>>>>>>>",i)})):yield(yield t.alertController.create({header:"ORDEN DE TRABAJO",subHeader:"MATERIALES",cssClass:"alerta-error",mode:"ios",animated:!0,message:"Falta asignar cantidad",buttons:[{text:"Aceptar",handler:()=>{console.log("Operaci\xf3n confirmada")}}]})).present()})()}FSelectChangeTipoMotivo(o){}ionViewWillEnter(){this.FLoadForms()}FLoadForms(){this.loadingController.create({message:"Cargando lista....",translucent:!0}).then(t=>{t.present(),this.ApiService.FLoadMotivoAdicional("0","1").then(n=>{this.DsTipoMotivo=n.motivo,t.dismiss()})})}presentToast(o){var t=this;return(0,_.Z)(function*(){console.log("ingreso toast"),yield(yield t.toastController.create({message:o,duration:1500,position:"bottom"})).present()})()}}return l.\u0275fac=function(o){return new(o||l)(e.Y36(a.HT),e.Y36(f.k),e.Y36(a.IN),e.Y36(A.gz),e.Y36(a.X1),e.Y36(a.Br),e.Y36(a.yF),e.Y36(O.K),e.Y36(T.X))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-mtto-otis-pop-up-add-part-list"]],viewQuery:function(o,t){if(1&o&&e.Gf(C,5),2&o){let n;e.iGM(n=e.CRH())&&(t.idinputsearch_equipo=n.first)}},standalone:!0,features:[e.jDz],decls:47,vars:19,consts:[["mode","ios"],["slot","start"],["color","danger",3,"click"],["name","close"],[2,"font-size","x-small","padding","0px","min-height","0px"],[2,"font-size","x-small"],["color","dark"],["lines","none",2,"font-size","x-small","padding","0px","min-height","0px"],["slot","start","mode","ios",2,"font-size","x-small",3,"enableOnOffLabels","checked","ngModel","ngModelChange","ionChange"],["slot","end","mode","ios",2,"font-size","x-small",3,"enableOnOffLabels","checked","ngModel","ngModelChange","ionChange"],[2,"font-size","x-small","padding","0px","min-height","10px !important"],["show-clear-button","focus","animated","true","mode","ios","cancelButtonText","Cancelar","enterkeyhint","done","placeholder","Buscar...","color","secondary",3,"ngModel","ngModelChange","ionInput"],["idinputsearch_equipo",""],["slot","end","name","sync-outline",3,"click"],["idIconButtonSync",""],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[3,"color"],["name","add-outline"],[2,"font-size","smaller"],["name","caret-forward-outline"],["color","danger"],["slot","end"]],template:function(o,t){1&o&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),e._uU(3),e.qZA(),e.TgZ(4,"ion-buttons",1)(5,"ion-button",2),e.NdJ("click",function(){return t.cancelar_listaequipos(0,0,0)}),e._UZ(6,"ion-icon",3),e._uU(7," Cancelar "),e.qZA()()(),e.TgZ(8,"ion-item",4)(9,"ion-label")(10,"h3",5),e._uU(11,"Caracteristicas del equipo:"),e.qZA(),e.TgZ(12,"p"),e._uU(13," Modelo:"),e.TgZ(14,"ion-text",6),e._uU(15),e.qZA(),e._uU(16,", Marca:"),e.TgZ(17,"ion-text",6),e._uU(18),e.qZA(),e._uU(19,", Tipo:"),e.TgZ(20,"ion-text",6),e._uU(21),e.qZA(),e._uU(22,", Potencia:"),e.TgZ(23,"ion-text",6),e._uU(24),e.qZA()()()(),e.TgZ(25,"ion-item-group")(26,"ion-item-divider")(27,"ion-label"),e._uU(28," Filtros: "),e.qZA()(),e.TgZ(29,"ion-item",7)(30,"ion-toggle",8),e.NdJ("ngModelChange",function(i){return t.FormModel.ot=i})("ionChange",function(i){return t.lista_equipos(i,1)}),e._uU(31," Solo Plantillas de OTs: "),e.qZA(),e.TgZ(32,"ion-toggle",9),e.NdJ("ngModelChange",function(i){return t.FormModel.pd=i})("ionChange",function(i){return t.lista_equipos(i,1)}),e._uU(33," Solo PartList Dise\xf1o: "),e.qZA()(),e.TgZ(34,"ion-item",7)(35,"ion-toggle",8),e.NdJ("ngModelChange",function(i){return t.FormModel.im=i})("ionChange",function(i){return t.lista_equipos(i,1)}),e._uU(36," Igual al Modelo: "),e.qZA(),e.TgZ(37,"ion-toggle",9),e.NdJ("ngModelChange",function(i){return t.FormModel.it=i})("ionChange",function(i){return t.lista_equipos(i,1)}),e._uU(38," Igual al Tipo: "),e.qZA()()(),e.TgZ(39,"ion-item",10)(40,"ion-searchbar",11,12),e.NdJ("ngModelChange",function(i){return t.search_term_equipo=i})("ionInput",function(i){return t.lista_equipos(i,2)}),e.qZA(),e.TgZ(42,"ion-icon",13,14),e.NdJ("click",function(i){return t.lista_equipos(i,1)}),e.qZA()()(),e.TgZ(44,"ion-content")(45,"ion-list"),e.YNc(46,Z,35,9,"ion-item-group",15),e.qZA()()),2&o&&(e.xp6(3),e.Oqu(t.tituloVentana),e.xp6(12),e.Oqu(t.FormModel.modelo),e.xp6(3),e.Oqu(t.FormModel.marca),e.xp6(3),e.Oqu(t.FormModel.tipo),e.xp6(3),e.Oqu(t.FormModel.potencia),e.xp6(6),e.Q6J("enableOnOffLabels",!0)("checked",!0)("ngModel",t.FormModel.ot),e.xp6(2),e.Q6J("enableOnOffLabels",!0)("checked",!0)("ngModel",t.FormModel.pd),e.xp6(3),e.Q6J("enableOnOffLabels",!0)("checked",!0)("ngModel",t.FormModel.im),e.xp6(2),e.Q6J("enableOnOffLabels",!0)("checked",!0)("ngModel",t.FormModel.it),e.xp6(3),e.Q6J("ngModel",t.search_term_equipo),e.xp6(6),e.Q6J("ngForOf",t.results_equipos))},dependencies:[a.Pc,a.YG,a.Sm,a.hM,a.W2,a.Gu,a.gu,a.Ie,a.rH,a.Ub,a.Q$,a.q_,a.uN,a.VI,a.yW,a.wd,a.ho,a.sr,a.w,a.j9,M.ez,M.sg,p.u5,p.JJ,p.On],styles:["ion-item[_ngcontent-%COMP%]{min-height:0px}"]}),l})()}}]);