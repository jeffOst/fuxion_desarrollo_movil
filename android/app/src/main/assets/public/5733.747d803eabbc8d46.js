"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5733],{5733:(S,h,n)=>{n.r(h),n.d(h,{ProdAteServReporteFallaPage:()=>y});var f=n(5861),D=n(6814),g=n(95),r=n(6728),u=n(5481),v=n(3820),R=n(1811),e=n(6242),C=n(6485),T=n(5472),M=n(2014),P=n(4248);function Z(s,p){if(1&s){const d=e.EpF();e.TgZ(0,"ion-datetime",21,22),e.NdJ("ionChange",function(){e.CHM(d);const o=e.MAs(1),t=e.oxw();return e.KtG(t.dateChanged(o.value))}),e.qZA()}2&s&&e.Q6J("preferWheel",!0)("showDefaultButtons",!0)}function A(s,p){if(1&s&&(e.TgZ(0,"ion-select-option",23),e._uU(1),e.qZA()),2&s){const d=p.$implicit;e.Q6J("value",d.codigo),e.xp6(1),e.hij("",d.nombre," ")}}function q(s,p){if(1&s&&(e.TgZ(0,"ion-select-option",23),e._uU(1),e.qZA()),2&s){const d=p.$implicit;e.Q6J("value",d.codigo),e.xp6(1),e.hij("",d.nombre," ")}}let y=(()=>{var s;class p{constructor(i,o,t,a,F,c,m){let l;this.ApiServices=i,this.loadingController=o,this.modalCtrl=t,this.toastController=a,this.storage=F,this.router=c,this.navCtrl=m,this.showPicker=!1,this.dateValue=(0,u.Z)(new Date,"yyyy-MM-dd")+"T09:00:00.000Z",this.formattedString="",this.Cancelar="Cancelar",this.disableButton=!1,this.navParams=this.router.getCurrentNavigation().extras.state,console.log("this.navParams::>",this.navParams),this.idMenu=this.navParams.idmenu,this.menu=this.navParams.menu,this.DsFormReporteFalla={},this.storage.get("USER_INFO").then(_=>{l=_,this.NombresUsuarioLocal=l.user_name,this.IdUsuarioLocal=l.user_id,this.DsFormReporteFalla.idtecnico_rfc=this.IdUsuarioLocal,this.DsFormReporteFalla.nombres_tecnico=this.NombresUsuarioLocal}),this.storage.get("DEVICE_INFO").then(_=>{l=_,this.NombreDispositivo=l.name,this.IdDispositivo=l.uuid}),this.setToday(),this.DsFormReporteFalla.correlativo_rfc="",this.DsFormReporteFalla.maquina=this.menu,this.DsFormReporteFalla.idmaquina_rfc=this.idMenu,this.DsFormReporteFalla.nombres_tecnico="",this.DsFormReporteFalla.idtipofalla_rfc="",this.DsFormReporteFalla.descripcion_rfc="",this.DsFormReporteFalla.se_solicita_rfc="",console.log(this.DsFormReporteFalla)}ngOnInit(){}setToday(){this.formattedString=(0,u.Z)((0,v.Z)((0,u.Z)(new Date,"yyyy-MM-dd")+"T09:00:00.000Z"),"HH:mm,MMM d,yyyy")}ionViewDidEnter(){this.load_cbos_ma00(),this.FCreaCorrelativo()}dateChanged(i){console.log(i),this.dateValue=i,this.formattedString=(0,u.Z)((0,v.Z)(i),"HH:mm,MMM d,yyyy"),this.showPicker=!1}FCreaCorrelativo(){this.ApiServices.FCreaCorrelativo().then(i=>{let o;o=i[0],console.log(o),console.log(o.o_nres),0==o.o_nres?alert("Error, no se pudo crear correctamente el correlativo."):(this.DsFormReporteFalla.idreportefallacab=o.o_nres,this.DsFormReporteFalla.correlativo_rfc=o.param1)}).finally(()=>{console.log("finalyyyy")})}load_cbos_ma00(){this.loadingController.create({message:"Cargando listas...",translucent:!0}).then(o=>{o.present(),this.ApiServices.load_cbos_ma00().then(t=>{this.rest_tipofalla=t.tipo_falla,this.rest_maquina=t.maquinas,console.log("this.rest_maquina",this.rest_maquina)}).finally(()=>{this.loadingController.dismiss()})})}select_change_falla(i,o){console.log("select_change_material::",this.rest_tipofalla);for(const t of this.rest_tipofalla)console.log(this.DsFormReporteFalla.falla),console.log(t.codigo,i.detail.value),t.codigo==i.detail.value&&(this.DsFormReporteFalla.falla=t.nombre,this.DsFormReporteFalla.idtipofalla_rfc=t.codigo,console.log(this.DsFormReporteFalla.falla))}select_change_maquina(i,o){for(const t of this.rest_maquina)t.codigo==i.detail.value&&(this.DsFormReporteFalla.maquina=t.nombre,this.DsFormReporteFalla.idmaquina_rfc=t.codigo)}FOpenModalTecnico(){var i=this;return(0,f.Z)(function*(){let o,t,a,c;o=i.DsFormReporteFalla.nombres_tecnico,a=i.DsFormReporteFalla.idtecnico_rfc,t=i.DsFormReporteFalla.avatar,""==o&&(c=" Pieza");const l=yield i.modalCtrl.create({component:R.ProdAteServPopPersonalPage,backdropDismiss:!0,showBackdrop:!0,mode:"ios",componentProps:{index_p:0,nombre_tecnico:o,idtablet:"0",titulo_modal:"Lista de Tecnicos",id_personal:a}});return l.onDidDismiss().then(_=>{null!=_.data&&(i.dataReturned=_.data,console.log("dataReturned::206",_),i.DsFormReporteFalla.nombres_tecnico=_.data.nombres,i.DsFormReporteFalla.idtecnico_rfc=_.data.id)}),yield l.present()})()}FSaveFormulario(){let a="",c=0;return this.CssNotiMaquina="field_required_ok",null==this.DsFormReporteFalla.maquina||""==this.DsFormReporteFalla.maquina?(c=2,a=" Fala seleccionar maquina",this.CssNotiMaquina="field_required",this.presentToast(a,"danger"),!1):(this.CssNotiTenico="field_required_ok",null==this.DsFormReporteFalla.nombres_tecnico||""==this.DsFormReporteFalla.nombres_tecnico?(c=2,a=" Fala seleccionar tecnico",this.CssNotiTenico="field_required",this.presentToast(a,"danger"),!1):(this.CssNotiTipoFalla="field_required_ok",null==this.DsFormReporteFalla.falla||""==this.DsFormReporteFalla.falla?(c=2,a=" Fala seleccionar tipo de falla",this.CssNotiTipoFalla="field_required",this.presentToast(a,"danger"),!1):(this.CssNotiDescFalla="field_required_ok",null==this.DsFormReporteFalla.descripcion_rfc||""==this.DsFormReporteFalla.descripcion_rfc?(c=2,a=" Fala tipear descrion de la falla",this.CssNotiDescFalla="field_required",this.presentToast(a,"danger"),!1):(this.CssNotiSeSolicita="field_required_ok",null==this.DsFormReporteFalla.se_solicita_rfc||""==this.DsFormReporteFalla.se_solicita_rfc?(c=2,a=" Fala tipear descrion de la se solicita",this.CssNotiSeSolicita="field_required",this.presentToast(a,"danger"),!1):(this.DsFormReporteFalla.acc="17",void this.ApiServices.SaveReporteFalla(this.DsFormReporteFalla).then(m=>{let l;l=m[0],console.log(l),console.log(l.o_nres),0==l.o_nres?alert("Error, no se pudo guardar correctamente."):(this.DsFormReporteFalla.idotsolse=l.o_nres,this.navCtrl.navigateForward(["prod-ate-serv-list-actividades"],{state:this.DsFormReporteFalla}),this.presentToast(l.o_msj))}).finally(()=>{console.log("finalyyyy")}))))))}presentToast(i,o="primary"){var t=this;return(0,f.Z)(function*(){(yield t.toastController.create({message:i,duration:2e3,position:"top",color:o})).present()})()}}return(s=p).\u0275fac=function(i){return new(i||s)(e.Y36(C.Z),e.Y36(r.HT),e.Y36(r.IN),e.Y36(r.yF),e.Y36(M.K),e.Y36(P.F0),e.Y36(T.SH))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-prod-ate-serv-reporte-falla"]],standalone:!0,features:[e.jDz],decls:76,vars:36,consts:[["mode","ios"],["text-capitalize",""],["slot","start"],["defaultHref","prod-list-acti-programada",3,"text","disabled"],[1,"ion-align-items-center"],["size","3",1,"ion-text-end"],["size","9"],["type","text","mode","ios","readonly","",3,"ngModel","value","ngModelChange"],["label","F.Registro:","locale","es-ES","datetime","datetime"],["trigger","popover-button","animated","true","arrow","true","mode","ios",3,"keepContentsMounted"],["size","3",1,"ion-text-end","ion-align-items-baseline"],["cancelText","Cancelar","placeholder","Seleccionar Maquina","color","primary","interface","action-sheet","mode","ios",3,"selectedText","ngModel","ionChange","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","text","placeholder","Buscar Tecnico","mode","ios","readonly","",3,"ngModel","value","click","ngModelChange"],["cancelText","Cancelar","placeholder","Seleccionar falla","color","primary","interface","action-sheet","mode","ios",3,"selectedText","ngModel","ionChange","ngModelChange"],["required","true","color","primary","type","number","mode","ios",3,"ngModel","value","ngModelChange"],["type","hidden",3,"ngModel","ngModelChange"],[2,"text-align","center"],["color","danger","defaultHref","prod-list-acti-programada","mode","ios",3,"text","disabled"],["color","primary",3,"disabled","click"],["name","save-outline"],["locale","es-ES","id","datetime","mode","ios","displayFormat","YYYY-MM-DD","presentation","date",3,"preferWheel","showDefaultButtons","ionChange"],["datetime",""],[3,"value"]],template:function(i,o){1&i&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title",1),e._uU(3,"Formulario Reporte de Fallas"),e.qZA(),e.TgZ(4,"ion-buttons",2),e._UZ(5,"ion-back-button",3),e.qZA()()(),e.TgZ(6,"ion-content")(7,"ion-list")(8,"ion-item")(9,"ion-grid")(10,"ion-row",4)(11,"ion-col")(12,"ion-grid")(13,"ion-row",4)(14,"ion-col",5),e._uU(15,"Correlativo de Registro: "),e.qZA(),e.TgZ(16,"ion-col",6)(17,"ion-item")(18,"ion-input",7),e.NdJ("ngModelChange",function(a){return o.DsFormReporteFalla.correlativo_rfc=a}),e.qZA()()()(),e.TgZ(19,"ion-row",4)(20,"ion-col",5),e._uU(21,"Fecha Registro: "),e.qZA(),e.TgZ(22,"ion-col",6)(23,"ion-item")(24,"ion-label"),e._uU(25,"F.Registro:"),e.qZA(),e._UZ(26,"ion-datetime-button",8),e.TgZ(27,"ion-popover",9),e.YNc(28,Z,2,2,"ng-template"),e.qZA()()()(),e.TgZ(29,"ion-row",4)(30,"ion-col",10),e._uU(31,"Maquina:"),e.qZA(),e.TgZ(32,"ion-col",6)(33,"ion-select",11),e.NdJ("ionChange",function(a){return o.select_change_maquina(a,0)})("ngModelChange",function(a){return o.DsFormReporteFalla.idmaquina_rfc=a}),e.YNc(34,A,2,2,"ion-select-option",12),e.qZA(),e._UZ(35,"div"),e.qZA()(),e.TgZ(36,"ion-row",4)(37,"ion-col",5),e._uU(38," Tecnico: "),e.qZA(),e.TgZ(39,"ion-col",6)(40,"ion-item")(41,"ion-searchbar",13),e.NdJ("click",function(){return o.FOpenModalTecnico()})("ngModelChange",function(a){return o.DsFormReporteFalla.nombres_tecnico=a}),e.qZA()(),e._UZ(42,"div"),e.qZA()(),e.TgZ(43,"ion-row",4)(44,"ion-col",5),e._uU(45," Tipo de Falla: "),e.qZA(),e.TgZ(46,"ion-col",6)(47,"ion-select",14),e.NdJ("ionChange",function(a){return o.select_change_falla(a,0)})("ngModelChange",function(a){return o.DsFormReporteFalla.idtipofalla_rfc=a}),e.YNc(48,q,2,2,"ion-select-option",12),e.qZA(),e._UZ(49,"div"),e.qZA()()()()(),e.TgZ(50,"ion-row",4)(51,"ion-col",5),e._uU(52," Descripci\xf3n de la Falla: "),e.qZA(),e.TgZ(53,"ion-col",6)(54,"ion-textarea",15),e.NdJ("ngModelChange",function(a){return o.DsFormReporteFalla.descripcion_rfc=a}),e.qZA(),e._UZ(55,"div"),e.qZA()(),e.TgZ(56,"ion-row",4)(57,"ion-col",5),e._uU(58," Se Solicita: "),e.qZA(),e.TgZ(59,"ion-col",6)(60,"ion-textarea",15),e.NdJ("ngModelChange",function(a){return o.DsFormReporteFalla.se_solicita_rfc=a}),e.qZA(),e._UZ(61,"div"),e.qZA()()()(),e.TgZ(62,"ion-input",16),e.NdJ("ngModelChange",function(a){return o.DsFormReporteFalla.idtecnico_rfc=a}),e.qZA()()(),e.TgZ(63,"ion-footer")(64,"ion-grid")(65,"ion-row"),e._UZ(66,"ion-col"),e.TgZ(67,"ion-col",17)(68,"ion-buttons")(69,"ion-back-button",18),e._uU(70,"Cancelar "),e.qZA(),e._uU(71," \xa0\xa0\xa0\xa0 "),e.TgZ(72,"ion-button",19),e.NdJ("click",function(){return o.FSaveFormulario()}),e._UZ(73,"ion-icon",20),e._uU(74,"\xa0 Guardar "),e.qZA()()(),e._UZ(75,"ion-col"),e.qZA()()()),2&i&&(e.xp6(5),e.Q6J("text",o.Cancelar)("disabled",o.disableButton),e.xp6(13),e.s9C("value",o.DsFormReporteFalla.correlativo_rfc),e.Q6J("ngModel",o.DsFormReporteFalla.correlativo_rfc),e.xp6(9),e.Q6J("keepContentsMounted",!0),e.xp6(6),e.Q6J("selectedText",o.DsFormReporteFalla.maquina)("ngModel",o.DsFormReporteFalla.idmaquina_rfc),e.xp6(1),e.Q6J("ngForOf",o.rest_maquina),e.xp6(1),e.Tol(o.CssNotiMaquina),e.xp6(6),e.s9C("value",o.DsFormReporteFalla.nombres_tecnico),e.Q6J("ngModel",o.DsFormReporteFalla.nombres_tecnico),e.xp6(1),e.Tol(o.CssNotiTenico),e.xp6(5),e.Q6J("selectedText",o.DsFormReporteFalla.falla)("ngModel",o.DsFormReporteFalla.idtipofalla_rfc),e.xp6(1),e.Q6J("ngForOf",o.rest_tipofalla),e.xp6(1),e.Tol(o.CssNotiTipoFalla),e.xp6(5),e.s9C("value",o.DsFormReporteFalla.descripcion_rfc),e.Q6J("ngModel",o.DsFormReporteFalla.descripcion_rfc),e.xp6(1),e.Tol(o.CssNotiDescFalla),e.xp6(5),e.s9C("value",o.DsFormReporteFalla.se_solicita_rfc),e.Q6J("ngModel",o.DsFormReporteFalla.se_solicita_rfc),e.xp6(1),e.Tol(o.CssNotiSeSolicita),e.xp6(1),e.Q6J("ngModel",o.DsFormReporteFalla.idtecnico_rfc),e.xp6(7),e.Q6J("text",o.Cancelar)("disabled",o.disableButton),e.xp6(3),e.Q6J("disabled",o.disableButton))},dependencies:[r.Pc,r.YG,r.Sm,r.wI,r.W2,r.x4,r.Mj,r.fr,r.jY,r.Gu,r.gu,r.pK,r.Ie,r.Q$,r.q_,r.Nd,r.VI,r.t9,r.n0,r.g2,r.wd,r.sr,r.d8,r.QI,r.j9,r.oU,D.ez,D.sg,g.u5,g.JJ,g.Q7,g.On]}),p})()}}]);