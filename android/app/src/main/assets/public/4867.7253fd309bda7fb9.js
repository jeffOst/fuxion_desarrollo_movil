"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4867],{4867:(q,F,s)=>{s.r(F),s.d(F,{ProdAteServReporteFallaPage:()=>A});var h=s(5861),f=s(6895),m=s(433),i=s(5562),g=s(2446),D=s(2993),v=s(5155),e=s(8256),R=s(5719),C=s(849),T=s(1407);function M(n,d){if(1&n){const a=e.EpF();e.TgZ(0,"ion-datetime",21,22),e.NdJ("ionChange",function(){e.CHM(a);const r=e.MAs(1),t=e.oxw();return e.KtG(t.dateChanged(r.value))}),e.qZA()}2&n&&e.Q6J("preferWheel",!0)("showDefaultButtons",!0)}function P(n,d){if(1&n&&(e.TgZ(0,"ion-select-option",23),e._uU(1),e.qZA()),2&n){const a=d.$implicit;e.Q6J("value",a.codigo),e.xp6(1),e.hij("",a.nombre," ")}}function Z(n,d){if(1&n&&(e.TgZ(0,"ion-select-option",23),e._uU(1),e.qZA()),2&n){const a=d.$implicit;e.Q6J("value",a.codigo),e.xp6(1),e.hij("",a.nombre," ")}}let A=(()=>{class n{constructor(a,o,r,t,u,c,p){let l;this.ApiServices=a,this.loadingController=o,this.modalCtrl=r,this.toastController=t,this.storage=u,this.router=c,this.navCtrl=p,this.showPicker=!1,this.dateValue=(0,g.Z)(new Date,"yyyy-MM-dd")+"T09:00:00.000Z",this.formattedString="",this.Cancelar="Cancelar",this.disableButton=!1,this.navParams=this.router.getCurrentNavigation().extras.state,console.log("this.navParams::>",this.navParams),this.idMenu=this.navParams.idmenu,this.menu=this.navParams.menu,this.DsFormReporteFalla={},this.storage.get("USER_INFO").then(_=>{l=_,this.NombresUsuarioLocal=l.user_name,this.IdUsuarioLocal=l.user_id,this.DsFormReporteFalla.idtecnico_rfc=this.IdUsuarioLocal,this.DsFormReporteFalla.nombres_tecnico=this.NombresUsuarioLocal}),this.storage.get("DEVICE_INFO").then(_=>{l=_,this.NombreDispositivo=l.name,this.IdDispositivo=l.uuid}),this.setToday(),this.DsFormReporteFalla.correlativo_rfc="",this.DsFormReporteFalla.maquina=this.menu,this.DsFormReporteFalla.idmaquina_rfc=this.idMenu,this.DsFormReporteFalla.nombres_tecnico="",this.DsFormReporteFalla.idtipofalla_rfc="",this.DsFormReporteFalla.descripcion_rfc="",this.DsFormReporteFalla.se_solicita_rfc="",console.log(this.DsFormReporteFalla)}ngOnInit(){}setToday(){this.formattedString=(0,g.Z)((0,D.Z)((0,g.Z)(new Date,"yyyy-MM-dd")+"T09:00:00.000Z"),"HH:mm,MMM d,yyyy")}ionViewDidEnter(){this.load_cbos_ma00(),this.FCreaCorrelativo()}dateChanged(a){console.log(a),this.dateValue=a,this.formattedString=(0,g.Z)((0,D.Z)(a),"HH:mm,MMM d,yyyy"),this.showPicker=!1}FCreaCorrelativo(){this.ApiServices.FCreaCorrelativo().then(a=>{let o;o=a[0],console.log(o),console.log(o.o_nres),0==o.o_nres?alert("Error, no se pudo crear correctamente el correlativo."):(this.DsFormReporteFalla.idreportefallacab=o.o_nres,this.DsFormReporteFalla.correlativo_rfc=o.param1)}).finally(()=>{console.log("finalyyyy")})}load_cbos_ma00(){this.loadingController.create({message:"Cargando listas...",translucent:!0}).then(o=>{o.present(),this.ApiServices.load_cbos_ma00().then(r=>{this.rest_tipofalla=r.tipo_falla,this.rest_maquina=r.maquinas,console.log("this.rest_maquina",this.rest_maquina)}).finally(()=>{this.loadingController.dismiss()})})}select_change_falla(a,o){console.log("select_change_material::",this.rest_tipofalla);for(const r of this.rest_tipofalla)console.log(this.DsFormReporteFalla.falla),console.log(r.codigo,a.detail.value),r.codigo==a.detail.value&&(this.DsFormReporteFalla.falla=r.nombre,this.DsFormReporteFalla.idtipofalla_rfc=r.codigo,console.log(this.DsFormReporteFalla.falla))}select_change_maquina(a,o){for(const r of this.rest_maquina)r.codigo==a.detail.value&&(this.DsFormReporteFalla.maquina=r.nombre,this.DsFormReporteFalla.idmaquina_rfc=r.codigo)}FOpenModalTecnico(){var a=this;return(0,h.Z)(function*(){let o,r,t,c;o=a.DsFormReporteFalla.nombres_tecnico,t=a.DsFormReporteFalla.idtecnico_rfc,r=a.DsFormReporteFalla.avatar,""==o&&(c=" Pieza");const l=yield a.modalCtrl.create({component:v.ProdAteServPopPersonalPage,backdropDismiss:!0,showBackdrop:!0,mode:"ios",componentProps:{index_p:0,nombre_tecnico:o,idtablet:"0",titulo_modal:"Lista de Tecnicos",id_personal:t}});return l.onDidDismiss().then(_=>{null!=_.data&&(a.dataReturned=_.data,console.log("dataReturned::206",_),a.DsFormReporteFalla.nombres_tecnico=_.data.nombres,a.DsFormReporteFalla.idtecnico_rfc=_.data.id)}),yield l.present()})()}FSaveFormulario(){let t="",c=0;return this.CssNotiMaquina="field_required_ok",null==this.DsFormReporteFalla.maquina||""==this.DsFormReporteFalla.maquina?(c=2,t=" Fala seleccionar maquina",this.CssNotiMaquina="field_required",this.presentToast(t,"danger"),!1):(this.CssNotiTenico="field_required_ok",null==this.DsFormReporteFalla.nombres_tecnico||""==this.DsFormReporteFalla.nombres_tecnico?(c=2,t=" Fala seleccionar tecnico",this.CssNotiTenico="field_required",this.presentToast(t,"danger"),!1):(this.CssNotiTipoFalla="field_required_ok",null==this.DsFormReporteFalla.falla||""==this.DsFormReporteFalla.falla?(c=2,t=" Fala seleccionar tipo de falla",this.CssNotiTipoFalla="field_required",this.presentToast(t,"danger"),!1):(this.CssNotiDescFalla="field_required_ok",null==this.DsFormReporteFalla.descripcion_rfc||""==this.DsFormReporteFalla.descripcion_rfc?(c=2,t=" Fala tipear descrion de la falla",this.CssNotiDescFalla="field_required",this.presentToast(t,"danger"),!1):(this.CssNotiSeSolicita="field_required_ok",null==this.DsFormReporteFalla.se_solicita_rfc||""==this.DsFormReporteFalla.se_solicita_rfc?(c=2,t=" Fala tipear descrion de la se solicita",this.CssNotiSeSolicita="field_required",this.presentToast(t,"danger"),!1):(this.DsFormReporteFalla.acc="17",void this.ApiServices.SaveReporteFalla(this.DsFormReporteFalla).then(p=>{let l;l=p[0],console.log(l),console.log(l.o_nres),0==l.o_nres?alert("Error, no se pudo guardar correctamente."):(this.DsFormReporteFalla.idotsolse=l.o_nres,this.navCtrl.navigateForward(["prod-ate-serv-list-actividades"],{state:this.DsFormReporteFalla}),this.presentToast(l.o_msj))}).finally(()=>{console.log("finalyyyy")}))))))}presentToast(a,o="primary"){var r=this;return(0,h.Z)(function*(){(yield r.toastController.create({message:a,duration:2e3,position:"top",color:o})).present()})()}}return n.\u0275fac=function(a){return new(a||n)(e.Y36(R.Z),e.Y36(i.HT),e.Y36(i.IN),e.Y36(i.yF),e.Y36(C.K),e.Y36(T.F0),e.Y36(i.SH))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-prod-ate-serv-reporte-falla"]],standalone:!0,features:[e.jDz],decls:76,vars:36,consts:[["mode","ios"],["text-capitalize",""],["slot","start"],["defaultHref","prod-list-acti-programada",3,"text","disabled"],[1,"ion-align-items-center"],["size","3",1,"ion-text-end"],["size","9"],["type","text","mode","ios","readonly","",3,"ngModel","value","ngModelChange"],["label","F.Registro:","locale","es-ES","datetime","datetime"],["trigger","popover-button","animated","true","arrow","true","mode","ios",3,"keepContentsMounted"],["size","3",1,"ion-text-end","ion-align-items-baseline"],["cancelText","Cancelar","placeholder","Seleccionar Maquina","color","primary","interface","action-sheet","mode","ios",3,"selectedText","ngModel","ionChange","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","text","placeholder","Buscar Tecnico","mode","ios","readonly","",3,"ngModel","value","click","ngModelChange"],["cancelText","Cancelar","placeholder","Seleccionar falla","color","primary","interface","action-sheet","mode","ios",3,"selectedText","ngModel","ionChange","ngModelChange"],["required","true","color","primary","type","number","mode","ios",3,"ngModel","value","ngModelChange"],["type","hidden",3,"ngModel","ngModelChange"],[2,"text-align","center"],["color","danger","defaultHref","prod-list-acti-programada","mode","ios",3,"text","disabled"],["color","primary",3,"disabled","click"],["name","save-outline"],["locale","es-ES","id","datetime","mode","ios","displayFormat","YYYY-MM-DD","presentation","date",3,"preferWheel","showDefaultButtons","ionChange"],["datetime",""],[3,"value"]],template:function(a,o){1&a&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title",1),e._uU(3,"Formulario Reporte de Fallas"),e.qZA(),e.TgZ(4,"ion-buttons",2),e._UZ(5,"ion-back-button",3),e.qZA()()(),e.TgZ(6,"ion-content")(7,"ion-list")(8,"ion-item")(9,"ion-grid")(10,"ion-row",4)(11,"ion-col")(12,"ion-grid")(13,"ion-row",4)(14,"ion-col",5),e._uU(15,"Correlativo de Registro: "),e.qZA(),e.TgZ(16,"ion-col",6)(17,"ion-item")(18,"ion-input",7),e.NdJ("ngModelChange",function(t){return o.DsFormReporteFalla.correlativo_rfc=t}),e.qZA()()()(),e.TgZ(19,"ion-row",4)(20,"ion-col",5),e._uU(21,"Fecha Registro: "),e.qZA(),e.TgZ(22,"ion-col",6)(23,"ion-item")(24,"ion-label"),e._uU(25,"F.Registro:"),e.qZA(),e._UZ(26,"ion-datetime-button",8),e.TgZ(27,"ion-popover",9),e.YNc(28,M,2,2,"ng-template"),e.qZA()()()(),e.TgZ(29,"ion-row",4)(30,"ion-col",10),e._uU(31,"Maquina:"),e.qZA(),e.TgZ(32,"ion-col",6)(33,"ion-select",11),e.NdJ("ionChange",function(t){return o.select_change_maquina(t,0)})("ngModelChange",function(t){return o.DsFormReporteFalla.idmaquina_rfc=t}),e.YNc(34,P,2,2,"ion-select-option",12),e.qZA(),e._UZ(35,"div"),e.qZA()(),e.TgZ(36,"ion-row",4)(37,"ion-col",5),e._uU(38," Tecnico: "),e.qZA(),e.TgZ(39,"ion-col",6)(40,"ion-item")(41,"ion-searchbar",13),e.NdJ("click",function(){return o.FOpenModalTecnico()})("ngModelChange",function(t){return o.DsFormReporteFalla.nombres_tecnico=t}),e.qZA()(),e._UZ(42,"div"),e.qZA()(),e.TgZ(43,"ion-row",4)(44,"ion-col",5),e._uU(45," Tipo de Falla: "),e.qZA(),e.TgZ(46,"ion-col",6)(47,"ion-select",14),e.NdJ("ionChange",function(t){return o.select_change_falla(t,0)})("ngModelChange",function(t){return o.DsFormReporteFalla.idtipofalla_rfc=t}),e.YNc(48,Z,2,2,"ion-select-option",12),e.qZA(),e._UZ(49,"div"),e.qZA()()()()(),e.TgZ(50,"ion-row",4)(51,"ion-col",5),e._uU(52," Descripci\xf3n de la Falla: "),e.qZA(),e.TgZ(53,"ion-col",6)(54,"ion-textarea",15),e.NdJ("ngModelChange",function(t){return o.DsFormReporteFalla.descripcion_rfc=t}),e.qZA(),e._UZ(55,"div"),e.qZA()(),e.TgZ(56,"ion-row",4)(57,"ion-col",5),e._uU(58," Se Solicita: "),e.qZA(),e.TgZ(59,"ion-col",6)(60,"ion-textarea",15),e.NdJ("ngModelChange",function(t){return o.DsFormReporteFalla.se_solicita_rfc=t}),e.qZA(),e._UZ(61,"div"),e.qZA()()()(),e.TgZ(62,"ion-input",16),e.NdJ("ngModelChange",function(t){return o.DsFormReporteFalla.idtecnico_rfc=t}),e.qZA()()(),e.TgZ(63,"ion-footer")(64,"ion-grid")(65,"ion-row"),e._UZ(66,"ion-col"),e.TgZ(67,"ion-col",17)(68,"ion-buttons")(69,"ion-back-button",18),e._uU(70,"Cancelar "),e.qZA(),e._uU(71," \xa0\xa0\xa0\xa0 "),e.TgZ(72,"ion-button",19),e.NdJ("click",function(){return o.FSaveFormulario()}),e._UZ(73,"ion-icon",20),e._uU(74,"\xa0 Guardar "),e.qZA()()(),e._UZ(75,"ion-col"),e.qZA()()()),2&a&&(e.xp6(5),e.Q6J("text",o.Cancelar)("disabled",o.disableButton),e.xp6(13),e.s9C("value",o.DsFormReporteFalla.correlativo_rfc),e.Q6J("ngModel",o.DsFormReporteFalla.correlativo_rfc),e.xp6(9),e.Q6J("keepContentsMounted",!0),e.xp6(6),e.Q6J("selectedText",o.DsFormReporteFalla.maquina)("ngModel",o.DsFormReporteFalla.idmaquina_rfc),e.xp6(1),e.Q6J("ngForOf",o.rest_maquina),e.xp6(1),e.Tol(o.CssNotiMaquina),e.xp6(6),e.s9C("value",o.DsFormReporteFalla.nombres_tecnico),e.Q6J("ngModel",o.DsFormReporteFalla.nombres_tecnico),e.xp6(1),e.Tol(o.CssNotiTenico),e.xp6(5),e.Q6J("selectedText",o.DsFormReporteFalla.falla)("ngModel",o.DsFormReporteFalla.idtipofalla_rfc),e.xp6(1),e.Q6J("ngForOf",o.rest_tipofalla),e.xp6(1),e.Tol(o.CssNotiTipoFalla),e.xp6(5),e.s9C("value",o.DsFormReporteFalla.descripcion_rfc),e.Q6J("ngModel",o.DsFormReporteFalla.descripcion_rfc),e.xp6(1),e.Tol(o.CssNotiDescFalla),e.xp6(5),e.s9C("value",o.DsFormReporteFalla.se_solicita_rfc),e.Q6J("ngModel",o.DsFormReporteFalla.se_solicita_rfc),e.xp6(1),e.Tol(o.CssNotiSeSolicita),e.xp6(1),e.Q6J("ngModel",o.DsFormReporteFalla.idtecnico_rfc),e.xp6(7),e.Q6J("text",o.Cancelar)("disabled",o.disableButton),e.xp6(3),e.Q6J("disabled",o.disableButton))},dependencies:[i.Pc,i.oU,i.YG,i.Sm,i.wI,i.W2,i.x4,i.Mj,i.fr,i.jY,i.Gu,i.gu,i.pK,i.Ie,i.Q$,i.q_,i.Nd,i.VI,i.t9,i.n0,i.g2,i.wd,i.sr,i.d8,i.QI,i.j9,i.cs,f.ez,f.sg,m.u5,m.JJ,m.Q7,m.On]}),n})()}}]);