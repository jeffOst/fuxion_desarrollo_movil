"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2626],{3951:(N,T,l)=>{l.d(T,{A:()=>C});const C=(0,l(7423).fo)("Browser",{web:()=>l.e(6874).then(l.bind(l,6874)).then(I=>new I.BrowserWeb)})},76:(N,T,l)=>{l.d(T,{GW:()=>C,dk:()=>I,oK:()=>m});var m=(()=>{return(A=m||(m={})).Prompt="PROMPT",A.Camera="CAMERA",A.Photos="PHOTOS",m;var A})(),C=(()=>{return(A=C||(C={})).Rear="REAR",A.Front="FRONT",C;var A})(),I=(()=>{return(A=I||(I={})).Uri="uri",A.Base64="base64",A.DataUrl="dataUrl",I;var A})()},6388:(N,T,l)=>{l.d(T,{V1:()=>I,dk:()=>C.dk,oK:()=>C.oK});var m=l(7423),C=l(76);const I=(0,m.fo)("Camera",{web:()=>l.e(3954).then(l.bind(l,3954)).then(A=>new A.CameraWeb)})},1443:(N,T,l)=>{l.d(T,{ez:()=>C,tP:()=>m});var m=(()=>{return(f=m||(m={})).Documents="DOCUMENTS",f.Data="DATA",f.Library="LIBRARY",f.Cache="CACHE",f.External="EXTERNAL",f.ExternalStorage="EXTERNAL_STORAGE",m;var f})(),C=(()=>{return(f=C||(C={})).UTF8="utf8",f.ASCII="ascii",f.UTF16="utf16",C;var f})()},1067:(N,T,l)=>{l.d(T,{fy:()=>I,tP:()=>C.tP});var m=l(7423),C=l(1443);const I=(0,m.fo)("Filesystem",{web:()=>l.e(6364).then(l.bind(l,6364)).then(A=>new A.FilesystemWeb)})},6101:(N,T,l)=>{l.d(T,{J:()=>v});var m=l(5861),C=l(4053),I=l(8256),A=l(529),f=l(849);let v=(()=>{class D{constructor(d,u){this.httpClient=d,this.storage=u,this.urlApiProd=C.N.UrlDomainLocal+"aw_modulos/mante/api/CApiInformeTecnico.php",this.confirmRequest=""}ListFindOts(d,u,g){let c=JSON.stringify({acc:1,s:d,idusu:u,iddevice:g});return this.httpClient.post(this.urlApiProd,c).toPromise().then(p=>p)}SaveCheckListCab(d,u,g){let c=JSON.stringify({acc:2,id_orden_trab_cab:d,idusu:u,iddevice:g});return this.httpClient.post(this.urlApiProd,c).toPromise().then(p=>p)}FormFindPaso1(d,u,g){let c=JSON.stringify({acc:3,idchecklistcab:d,idusu:u,iddevice:g});return this.httpClient.post(this.urlApiProd,c).toPromise().then(p=>p)}FLoadPiezasAcordion(d,u){let g=JSON.stringify({acc:7,id:d,p2:u});return this.httpClient.post(this.urlApiProd,g).toPromise().then(c=>c)}FLoadServiciosxPiezas(d,u){let g=JSON.stringify({acc:8,id:d,p2:u});return this.httpClient.post(this.urlApiProd,g).toPromise().then(c=>c)}GuardarFormPaso1(d){var u=this;return(0,m.Z)(function*(){console.log("Dentro::GuardarFormulario::>",d);let c=u.urlApiProd,p=JSON.stringify(d);return u.httpClient.post(c+"?acc=4",p).toPromise()})()}GuardarFormPaso2(d,u,g,c,p,w){var R=this;return(0,m.Z)(function*(){let F,V=R.urlApiProd,q=JSON.stringify({idservicio:d,idpapa:u,idhijo:g,idusuario:c,acc:9,idclase:p,ck:w});return R.httpClient.post(V+"?acc=6",q).toPromise().then(Z=>{console.log(Z),F=Z,R.confirmSaveBd=F[0].o_nres,R.confirmRequest=F},Z=>{console.log(Z,"Error- something is wrong!")})})()}FormFindPaso3(d,u,g){let c=JSON.stringify({acc:7,idchecklistcab:d,idusu:u,iddevice:g});return this.httpClient.post(this.urlApiProd,c).toPromise().then(p=>p)}GuardarFormPaso3(d){var u=this;return(0,m.Z)(function*(){let g,c=u.urlApiProd,p=JSON.stringify(d);return u.httpClient.post(c+"?acc=8",p).toPromise().then(w=>{console.log(w),g=w,u.confirmSaveBd=g[0].o_nres,u.confirmRequest=g},w=>{console.log(w,"Error- something is wrong!")})})()}FormFindPaso5(d,u,g){let c=JSON.stringify({acc:10,id:d,idusu:u,iddevice:g});return this.httpClient.post(this.urlApiProd,c).toPromise().then(p=>p)}GuardarFormPaso5(d){var u=this;return(0,m.Z)(function*(){let c=u.urlApiProd,p=JSON.stringify(d);return u.httpClient.post(c+"?acc=11",p).toPromise()})()}FormFindPaso6(d,u,g){let c=JSON.stringify({acc:12,idchecklistcab:d,idusu:u,iddevice:g});return this.httpClient.post(this.urlApiProd,c).toPromise().then(p=>p)}GuardarFormPaso6(d){var u=this;return(0,m.Z)(function*(){let c=u.urlApiProd,p=JSON.stringify(d);return u.httpClient.post(c+"?acc=13",p).toPromise()})()}GuardarAplicaPaso(d,u,g){var c=this;return(0,m.Z)(function*(){let p,R,w=c.urlApiProd;R={idchecklistcab:d,numeroPaso:u,ck:g};let F=JSON.stringify(R);return c.httpClient.post(w+"?acc=15",F).toPromise().then(B=>{console.log(B),p=B,c.confirmSaveBd=p[0].o_nres,c.confirmRequest=p},B=>{console.log(B,"Error- something is wrong!")})})()}getImages(d){return this.httpClient.get(`${this.urlApiProd}?acc=5&id=`+d)}uploadImage(d,u,g){let c=new FormData;return c.append("file",d,"myimage."+g),c.append("id",u),c.append("acc","6"),c.append("type","image/png"),this.httpClient.post(this.urlApiProd,c)}UpLoadImageMultiple(d,u,g){try{let c=new FormData;c.append("id",u),c.append("acc","15"),c.append("type","image/png");for(let p=0;p<d.length;p++)console.log("image::ruta=>::>",d[p]),c.append("images[]",d[p],`image_${p}.jpg`);return this.httpClient.post(this.urlApiProd,c)}catch(c){console.error("Error al enviar im\xe1genes al API:",c)}}LoadPdfInformeTecnico(d){let u=JSON.stringify({acc:14,idchecklistcab:d});return this.httpClient.post(this.urlApiProd,u).toPromise().then(g=>g)}deleteImage(d){return this.httpClient.delete(`${this.urlApiProd}?acc=16&id=${d}`)}}return D.\u0275fac=function(d){return new(d||D)(I.LFG(A.eN),I.LFG(f.K))},D.\u0275prov=I.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})()},6090:(N,T,l)=>{function I(){const A=new FileReader;return A.__zone_symbol__originalInstance||A}l.d(T,{y3:()=>I})},2626:(N,T,l)=>{l.r(T),l.d(T,{MttoWinInformeTecnico1Page:()=>_e});var m=l(5861),C=l(3951),I=l(6895),A=l(4053),f=l(433),v=l(5562),D=l(6388),M=l(1067),d=l(6090),u=l(655),c=l(9751),p=l(4968),w={error:"cordova_not_available"},R={error:"plugin_not_installed"};function F(n){if(typeof window<"u"&&window.angular){var e=window.document,t=window.angular.element(e.querySelector("[ng-app]")||e.body).injector();if(t)return t.get("$q")(function(a,s){n(a,s)});console.warn("Angular 1 was detected but $q couldn't be retrieved. This is usually when the app is not bootstrapped on the html or body tag. Falling back to native promises which won't trigger an automatic digest when promises resolve.")}return function(){if(Promise)return new Promise(function(a,s){n(a,s)});console.error("No Promise support or polyfill found. To enable Ionic Native support, please add the es6-promise polyfill before this script, or run with a library like Angular or on a recent browser.")}()}function z(n,i,e){var t,r;"string"==typeof n?t=n:(t=n.constructor.getPluginRef(),e=n.constructor.getPluginName(),r=n.constructor.getPluginInstallName());var a=$(t);return!(!a||i&&typeof a[i]>"u")||(typeof window>"u"||!window.cordova?(function ie(n,i){typeof process>"u"&&console.warn(i?"Native: tried calling "+n+"."+i+", but Cordova is not available. Make sure to include cordova.js or run in a device/simulator":"Native: tried accessing the "+n+" plugin but Cordova is not available. Make sure to include cordova.js or run in a device/simulator")}(e,i),w):(function oe(n,i,e){console.warn(e?"Native: tried calling "+n+"."+e+", but the "+n+" plugin is not installed.":"Native: tried accessing the "+n+" plugin but it's not installed."),i&&console.warn("Install the "+n+" plugin: 'ionic cordova plugin add "+i+"'")}(e,r,i),R))}function L(n,i,e,t,r,a){void 0===t&&(t={}),e=function Q(n,i,e,t){if(void 0===i&&(i={}),i.sync)return n;if("reverse"===i.callbackOrder)n.unshift(t),n.unshift(e);else if("node"===i.callbackStyle)n.push(function(h,_){h?t(h):e(_)});else if("object"===i.callbackStyle&&i.successName&&i.errorName){var r={};r[i.successName]=e,r[i.errorName]=t,n.push(r)}else if(typeof i.successIndex<"u"||typeof i.errorIndex<"u"){var a=function(){i.successIndex>n.length?n[i.successIndex]=e:n.splice(i.successIndex,0,e)},s=function(){i.errorIndex>n.length?n[i.errorIndex]=t:n.splice(i.errorIndex,0,t)};i.successIndex>i.errorIndex?(s(),a()):(a(),s())}else n.push(e),n.push(t);return n}(e,t,r,a);var s=z(n,i);if(!0===s){var h=$(n.constructor.getPluginRef());return h[i].apply(h,e)}return s}function $(n){return typeof window<"u"?H(window,n):null}function H(n,i){for(var e=i.split("."),t=n,r=0;r<e.length;r++){if(!t)return null;t=t[e[r]]}return t}var ne=function(n,i,e){return void 0===e&&(e={}),function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.sync?L(n,i,t,e):e.observable?function q(n,i,e,t){return void 0===t&&(t={}),new c.y(function(r){var a;return a=t.destruct?L(n,i,e,t,function(){for(var s=[],h=0;h<arguments.length;h++)s[h]=arguments[h];return r.next(s)},function(){for(var s=[],h=0;h<arguments.length;h++)s[h]=arguments[h];return r.error(s)}):L(n,i,e,t,r.next.bind(r),r.error.bind(r)),a&&a.error&&(r.error(a.error),r.complete()),function(){try{if(t.clearFunction)return t.clearWithArgs?L(n,t.clearFunction,e,t,r.next.bind(r),r.error.bind(r)):L(n,t.clearFunction,[])}catch(s){console.warn("Unable to clear the previous observable watch for",n.constructor.getPluginName(),i),console.warn(s)}}})}(n,i,t,e):e.eventObservable&&e.event?function Z(n,i){return i=typeof window<"u"&&i?H(window,i):i||(typeof window<"u"?window:{}),(0,p.R)(i,n)}(e.event,e.element):e.otherPromise?function V(n,i,e,t){return void 0===t&&(t={}),F(function(r,a){var s=L(n,i,e,t);s?s.error?a(s.error):s.then&&s.then(r).catch(a):a({error:"unexpected_error"})})}(n,i,t,e):function B(n,i,e,t){void 0===t&&(t={});var r,a,s=F(function(h,_){r=t.destruct?L(n,i,e,t,function(){for(var y=[],P=0;P<arguments.length;P++)y[P]=arguments[P];return h(y)},function(){for(var y=[],P=0;P<arguments.length;P++)y[P]=arguments[P];return _(y)}):L(n,i,e,t,h,_),a=_});return r&&r.error&&(s.catch(function(){}),"function"==typeof a&&a(r.error)),s}(n,i,t,e)}},ae=function(){function n(){}return n.installed=function(){return!0===z(this.pluginRef)},n.getPlugin=function(){return typeof window<"u"?function re(n,i){for(var e=i.split("."),t=n,r=0;r<e.length;r++){if(!t)return null;t=t[e[r]]}return t}(window,this.pluginRef):null},n.getPluginName=function(){return this.pluginName},n.getPluginRef=function(){return this.pluginRef},n.getPluginInstallName=function(){return this.plugin},n.getSupportedPlatforms=function(){return this.platforms},n.pluginName="",n.pluginRef="",n.plugin="",n.repo="",n.platforms=[],n.install="",n}();function Y(n,i,e,t){return ne(n,i,e).apply(this,t)}!function g(){if(typeof process>"u"){var n=typeof window<"u"?window:{},e=Date.now(),t=!1;n.document.addEventListener("deviceready",function(){console.log("Ionic Native: deviceready event fired after "+(Date.now()-e)+" ms"),t=!0}),setTimeout(function(){!t&&n.cordova&&console.warn("Ionic Native: deviceready did not fire within 5000ms. This can happen when plugins are in an inconsistent state. Try removing plugins from plugins/ and reinstalling them.")},5e3)}}();var o=l(8256),X=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return(0,u.ZT)(i,n),i.prototype.getSupportInfo=function(){return Y(this,"getSupportInfo",{},arguments)},i.prototype.canViewDocument=function(e,t,r,a,s,h,_){return Y(this,"canViewDocument",{sync:!0},arguments)},i.prototype.viewDocument=function(e,t,r,a,s,h,_){return Y(this,"viewDocument",{sync:!0},arguments)},i.\u0275fac=function(){let e;return function(r){return(e||(e=o.n5z(i)))(r||i)}}(),i.\u0275prov=o.Yz7({token:i,factory:i.\u0275fac}),i.pluginName="Document Viewer",i.plugin="cordova-plugin-document-viewer",i.pluginRef="SitewaertsDocumentViewer",i.repo="https://github.com/sitewaerts/cordova-plugin-document-viewer",i.platforms=["Android","iOS","Windows"],i=(0,u.gn)([],i)}(ae),ce=(l(7423),l(6101)),de=l(849),ue=l(1407),fe=l(7883);function he(n,i){if(1&n&&(o.TgZ(0,"ion-select-option",22),o._uU(1),o.qZA()),2&n){const e=i.$implicit;o.Q6J("value",e.codigo),o.xp6(1),o.hij("",e.nombre," ")}}function me(n,i){if(1&n&&(o.TgZ(0,"ion-item")(1,"ion-radio",23),o._uU(2),o.qZA()()),2&n){const e=i.$implicit;o.xp6(1),o.s9C("value",e.id),o.xp6(1),o.Oqu(e.text)}}function ge(n,i){if(1&n&&(o.TgZ(0,"ion-list")(1,"ion-item-divider")(2,"ion-label"),o._uU(3),o.qZA()(),o.YNc(4,me,3,2,"ion-item",15),o.qZA()),2&n){const e=i.$implicit;o.xp6(3),o.hij(" ",e.text," "),o.xp6(1),o.Q6J("ngForOf",e.children)}}function pe(n,i){if(1&n&&(o.TgZ(0,"ion-select-option",22),o._uU(1),o.qZA()),2&n){const e=i.$implicit;o.Q6J("value",e.codigo),o.xp6(1),o.hij("",e.nombre," ")}}function ve(n,i){if(1&n){const e=o.EpF();o.TgZ(0,"ion-item")(1,"ion-thumbnail",24),o._UZ(2,"ion-img",25),o.qZA(),o._UZ(3,"ion-img",25),o.TgZ(4,"ion-label"),o._uU(5),o.qZA(),o.TgZ(6,"ion-button",26),o.NdJ("click",function(){const r=o.CHM(e),a=r.$implicit,s=r.index,h=o.oxw();return o.KtG(h.deleteImage(a.idadjunto,s))}),o._UZ(7,"ion-icon",27),o.qZA()()}if(2&n){const e=i.$implicit,t=o.oxw();o.xp6(2),o.Q6J("src",t.DirectorioFotos+e.idnomadjunto),o.xp6(1),o.Q6J("src",e.webviewPath),o.xp6(2),o.Oqu(e.name)}}let _e=(()=>{class n{constructor(e,t,r,a,s,h,_,y,P,b,E){let k;this.formBuilder=e,this.navCtrl=t,this.loadingController=r,this.ApiService=a,this.storage=s,this.alertController=h,this.router=_,this.globalVal=y,this.ref=P,this.actionSheetCtrl=b,this.documentViewer=E,this.disableButtonPaso1=!0,this.checklist_paso1_apli_ck=!1,this.aisla_tierra_apl_ck=!0,this.aisla_entre_fases_apl_ck=!0,this.repara_chapa_apl_ck=!0,this.montaje_estator_apl_ck=!0,this.imgs=[],this.images=[],this.DirectorioFotos=A.N.UrlDomainLocal+"aw_file/adjuntos/",this.imageBlobs=[],this.convertBlobToBase64=O=>new Promise((x,ee)=>{this.popLodingMenaje=this.loadingController.create({message:"Guardando foto...",translucent:!0}).then(J=>{J.present()}),new FileReader;let U=(0,d.y3)();U.readAsDataURL(O),U.onload=J=>{let W;W=J.target.result,W=this.dataURLtoBlob(W),this.ApiService.uploadImage(W,this.corre_inf_cab,"png").subscribe(K=>{this.loadingController.dismiss(),this.loadImages(this.corre_inf_cab),console.log("salio okkkk::",K)},K=>{console.log("error__::>",K)})}}).finally(()=>{console.log("convertBlobToBase64:::",this.convertBlobToBase64)}),this.ConvertToBlobToBase64=O=>new Promise((x,ee)=>{const G=new FileReader;G.readAsDataURL(O),G.onload=()=>{const J=new Blob([G.result],{type:"image/jpeg"});this.addImageBlob(J),x()},G.onerror=U=>{ee(U)}}),this.storage.get("USER_INFO").then(O=>{k=O,this.NombresUsuarioLocal=k.user_name,this.IdUsuarioLocal=k.user_id,this.storage.get("DEVICE_INFO").then(x=>{k=x,this.NombreDispositivo=k.name,this.IdDispositivo=k.uuid})}),this.FormCheckListPaso1=this.formBuilder.group({fech_de_registro:["",f.kI.required],corre_fisico:["",f.kI.required],id_persona:["",f.kI.required],Fech_de_sistema:[""],fech_de_inicio:["",f.kI.required],tec_responsable:["",f.kI.required],Procedencia:["",f.kI.required],equipo:["",f.kI.required],equipo_model:["",f.kI.required],dias_trabajados:[""],Taller_lima:["",f.kI.required],operaciones:["",f.kI.required],estado_informe:["",f.kI.required],conf_jefe_planta:[""],conf_super_planta:["",f.kI.required],Conf_tecnico:["",f.kI.required],analisis_del_problema:[""],componentes_de_reclamo:[""],nro_fotos:[""],Y06002:["",f.kI.required],nrofisico_alternativo:[""],codsmg:[""],corre_inf_cab:["",f.kI.required],idactivos:[""],idisla_ic:[""],dias_trabajados_manual:[""],idresponsabilidad:[""],falla_primaria_ic:["",f.kI.required],falla_secundaria_ic:["",f.kI.required]}),console.log(this.router.getCurrentNavigation().extras);var j=this;if(""==this.globalVal.checklist_paso_pivot)try{this.navParamsAny=this.router.getCurrentNavigation().extras.state.Row,y.corre_inf_cab=this.navParamsAny.corre_inf_cab}catch(O){console.log(O),this.corre_inf_cab=y.corre_inf_cab}else this.corre_inf_cab=y.corre_inf_cab;this.storage.get("USER_PERMISO").then(O=>{O.forEach(function(x){j.disableButtonPaso1=32!=x.Nivel})})}onTouched(e){console.log(e)}FLoadForms(){this.loadingController.create({message:"Cargando lista....",translucent:!0}).then(t=>{t.present(),this.corre_inf_cab=this.globalVal.corre_inf_cab,console.log(this.corre_inf_cab),this.ApiService.FormFindPaso1(this.corre_inf_cab,"1","H").then(r=>{this.EditDataRest=r.form,this.DsResponabilidad=r.responsabilidad,this.Opciones1=r.responsable,this.DsIsla=r.isla,console.log("this.Opciones1",this.Opciones1),console.log(this.DsResponabilidad);try{this.FormCheckListPaso1.setValue({dias_trabajados_manual:this.EditDataRest[0].dias_trabajados_manual,Y06002:this.EditDataRest[0].Y06002,estado_informe:this.EditDataRest[0].estado_informe,fech_de_registro:this.EditDataRest[0].fech_de_registro,corre_fisico:this.EditDataRest[0].corre_fisico,id_persona:this.EditDataRest[0].id_persona,Fech_de_sistema:this.EditDataRest[0].Fech_de_sistema,fech_de_inicio:this.EditDataRest[0].fech_de_inicio,tec_responsable:this.EditDataRest[0].tec_responsable,Procedencia:this.EditDataRest[0].Procedencia,equipo:this.EditDataRest[0].equipo,equipo_model:this.EditDataRest[0].equipo_model,dias_trabajados:this.EditDataRest[0].dias_trabajados,Taller_lima:this.EditDataRest[0].Taller_lima,operaciones:this.EditDataRest[0].operaciones,conf_jefe_planta:this.EditDataRest[0].conf_jefe_planta,conf_super_planta:this.EditDataRest[0].conf_super_planta,Conf_tecnico:this.EditDataRest[0].Conf_tecnico,analisis_del_problema:this.EditDataRest[0].analisis_del_problema,componentes_de_reclamo:this.EditDataRest[0].componentes_de_reclamo,nro_fotos:this.EditDataRest[0].nro_fotos,nrofisico_alternativo:this.EditDataRest[0].nrofisico_alternativo,codsmg:this.EditDataRest[0].codsmg,corre_inf_cab:this.EditDataRest[0].corre_inf_cab,idactivos:this.EditDataRest[0].idactivos,idisla_ic:this.EditDataRest[0].idisla_ic,idresponsabilidad:this.EditDataRest[0].idresponsabilidad,falla_primaria_ic:this.EditDataRest[0].falla_primaria_ic,falla_secundaria_ic:this.EditDataRest[0].falla_secundaria_ic}),this.reponsablePivotSelectedText=this.EditDataRest[0].responsabilidad,this.islaPivotSelectedText=this.EditDataRest[0].isla,this.loadImages(this.corre_inf_cab)}catch(a){console.log("error:::>",a)}}).finally(()=>{this.loadingController.dismiss()})})}SaveFormTerminadoPaso1(){if(this.FormCheckListPaso1.valid)this.alertSiNo=this.alertController.create({header:"CONTROL DE MOTOR ELECTRICO",subHeader:"",mode:"ios",backdropDismiss:!0,message:"Confirmar que desea guardar?",buttons:[{text:"Aceptar",cssClass:"alert-button-group",role:"A",handler:()=>{}},{text:"Cancelar",role:"F",handler:()=>{}}]}).then(e=>{e.present(),e.onDidDismiss().then(t=>{console.log("aceptaPop::::>>",t),"A"==t.role&&(this.corre_inf_cab=this.globalVal.corre_inf_cab,0==this.disableButtonPaso1&&this.FormCheckListPaso1.controls.idsupervisor_responsable_cmc.setValue(this.IdUsuarioLocal),this.loadingController.create({message:"Guardando Paso 1...",translucent:!0}).then(a=>{a.present()}),this.ApiService.GuardarFormPaso1(this.FormCheckListPaso1.value).then(a=>{this.loadingController.dismiss(),alert("Guardado correctamente.")}).finally(()=>{}).catch(a=>{console.log("errror:::>>>>>>>>>",a)}))})});else{for(let e in this.FormCheckListPaso1.controls)this.FormCheckListPaso1.controls[e].setValue(this.FormCheckListPaso1.controls[e].value),this.FormCheckListPaso1.controls[e].markAsTouched();this.alertSiNo=this.alertController.create({header:"CONTROL DE MOTOR ELECTRICO",subHeader:"",mode:"ios",backdropDismiss:!0,message:"Falta seleccionar todos los datos",buttons:[{text:"Aceptar",cssClass:"alert-button-group",role:"A",handler:()=>{}}]}).then(e=>{e.present(),e.onDidDismiss().then(t=>{})})}}SaveFormBorradorPaso1(){var e=this;this.alertSiNo=this.alertController.create({header:"INFORME TECNICO",subHeader:"DATOS GENERALES",mode:"ios",backdropDismiss:!0,cssClass:"alerta-ok",message:"Confirmar que desea guardar?",buttons:[{text:"Aceptar",cssClass:"alert-button-group",role:"A",handler:()=>{}},{text:"Cancelar",role:"F",handler:()=>{}}]}).then(t=>{t.present(),t.onDidDismiss().then(r=>{"A"==r.role&&(this.loadingController.create({message:"Guardando datos generales...",translucent:!0}).then(s=>{s.present()}),this.corre_inf_cab=this.globalVal.corre_inf_cab,this.ApiService.GuardarFormPaso1(this.FormCheckListPaso1.value).then(function(){var s=(0,m.Z)(function*(h){e.loadingController.dismiss();let _="0"==h[0].o_nres?"alerta-error":"alerta-ok";yield(yield e.alertController.create({header:"ORDEN DE TRABAJO",subHeader:"DATOS GENERALES",cssClass:_,mode:"ios",animated:!0,message:h[0].o_msj,buttons:[{text:"Aceptar",handler:()=>{console.log("Operaci\xf3n confirmada")}}]})).present()});return function(h){return s.apply(this,arguments)}}()).finally(()=>{}).catch(s=>{console.log("errror:::>>>>>>>>>",s)}))})})}ionViewWillEnter(){let e;this.checklist_paso1_apli_ck="0"==this.globalVal.checklist_paso1_apli,this.FLoadForms(),e={detail:{checked:this.checklist_paso1_apli_ck,jc:0}}}ngOnInit(){}FSelectChangeResponsable(e,t){console.log("select_change_material::",this.DsResponabilidad);for(const r of this.DsResponabilidad)console.log(r.codigo,e.detail.value),r.codigo==e.detail.value&&(this.FormCheckListPaso1.controls.idresponsabilidad.setValue(r.codigo),this.reponsablePivotSelectedText=r.nombre)}FSelectChangeIsla(e,t){for(const r of this.DsIsla)console.log(r.codigo,e.detail.value),r.codigo==e.detail.value&&(this.FormCheckListPaso1.controls.idisla_ic.setValue(r.codigo),this.islaPivotSelectedText=r.nombre)}deleteImage(e,t){this.alertSiNo=this.alertController.create({header:"INFORME TECNICO",subHeader:"GENERAL",mode:"ios",backdropDismiss:!0,message:"Confirmar que desea eliminar?",buttons:[{text:"Aceptar",cssClass:"alert-button-group",role:"A",handler:()=>{}},{text:"Cancelar",role:"F",handler:()=>{}}]}).then(r=>{r.present(),r.onDidDismiss().then(a=>{console.log("aceptaPop::::>>",a),"A"==a.role&&this.ApiService.deleteImage(e).subscribe(s=>{this.images.splice(t,1)})})})}loadImages(e){this.ApiService.getImages(e).subscribe(t=>{this.images=t,this.ref.detectChanges()})}selectImageSource(){var e=this;return(0,m.Z)(function*(){const t=[{text:"Tome una Foto",icon:"camera",handler:()=>{console.log(D.oK.Camera),e.addNewToGallery(1)}},{text:"Elegir desde las fotos",icon:"image",handler:()=>{console.log("Photos",D.oK.Photos),e.pickImages_buton()}}];yield(yield e.actionSheetCtrl.create({header:"Selecionar Image",buttons:t})).present()})()}addNewToGallery(e){var t=this;return(0,m.Z)(function*(){let r;console.log("addNewToGallery::::tp::::>",e),1==e&&(r=yield D.V1.getPhoto({resultType:D.dk.Uri,source:D.oK.Camera,quality:100,width:800,height:800}).finally(()=>{console.log("capturedPhoto::::",r)})),yield t.savePicture(r)})()}convertToBase64(e){return(0,m.Z)(function*(){return(yield M.fy.readFile({path:e})).data})()}sendImagesToAPI(e){var t=this;return(0,m.Z)(function*(){for(const s of e){const _=yield(yield fetch(s)).blob();yield t.ConvertToBlobToBase64(_)}return t.imageBlobs})()}savePicture(e){var t=this;return(0,m.Z)(function*(){const r=yield t.readAsBase64(e),a=(new Date).getTime()+".jpeg";return yield M.fy.writeFile({path:a,data:r,directory:M.tP.Data}),{filepath:a,webviewPath:e.webPath}})()}readAsBase64(e){var t=this;return(0,m.Z)(function*(){const a=yield(yield fetch(e.webPath)).blob();return yield t.convertBlobToBase64(a)})()}dataURLtoBlob(e){console.log("dentro fucion dataURLtoBlob:",e);for(var t=e.split(","),r=t[0].match(/:(.*?);/)[1],a=atob(t[1]),s=a.length,h=new Uint8Array(s);s--;)h[s]=a.charCodeAt(s);return new Blob([h],{type:r})}DownloadOpenLocalPdf(){this.ApiService.LoadPdfInformeTecnico(this.corre_inf_cab).then(e=>{this.EditDataRest=e,console.log("this.Opciones1",this.EditDataRest);try{let t=A.N.UrlDomainLocal+"aw_file/"+this.EditDataRest.nomfile;console.log(t),C.A.open({url:t}),setTimeout(()=>{C.A.close()},5e3)}catch(t){console.log("error:::>",t)}}).finally(()=>{this.loadingController.dismiss()})}OpenLocalPdf(){let e=A.N.UrlDomainLocal+"aw_file/pdfxd.pdf";console.log(e),this.documentViewer.viewDocument(e,"application/pdf",{title:"My PDF"})}addImageBlob(e){this.imageBlobs.push(e)}pickImages_buton(){var e=this;return(0,m.Z)(function*(){const t={width:800,height:800,quality:100,correctOrientation:!0};try{const a=(yield D.V1.pickImages(t)).photos;e.imgs=[],e.imageBlobs=[];for(let s=0;s<a.length;s++)e.imgs.push(a[s].webPath);e.sendImages()}catch(r){console.error("Error picking images",r)}})()}sendImages(){this.popLodingMenaje=this.loadingController.create({message:"Guardando foto...",translucent:!0}).then(e=>{e.present()}),Promise.all(this.imgs.map(e=>this.convertAndAddToBlobs(e))).then(()=>{this.ApiService.UpLoadImageMultiple(this.imageBlobs,this.corre_inf_cab,"png").subscribe(t=>{this.loadingController.dismiss(),this.loadImages(this.corre_inf_cab),console.log("salio okkkk::",t)},t=>{console.log("error__::>",t)})}).catch(e=>{console.error("Error converting and adding Blobs",e)})}convertAndAddToBlobs(e){var t=this;return(0,m.Z)(function*(){try{console.log("convertAndAddToBlobs",e);const r=yield t.getBlobFromImagePath(e);t.addImageBlob(r)}catch(r){console.error("Error converting image to Blob",r)}})()}getBlobFromImagePath(e){return(0,m.Z)(function*(){return yield(yield fetch(e)).blob()})()}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(f.QS),o.Y36(v.SH),o.Y36(v.HT),o.Y36(ce.J),o.Y36(de.K),o.Y36(v.Br),o.Y36(ue.F0),o.Y36(fe.X),o.Y36(o.sBO),o.Y36(v.BX),o.Y36(X))},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-mtto-win-informe-tecnico1"]],standalone:!0,features:[o._Bn([X]),o.jDz],decls:63,vars:8,consts:[["mode","ios"],["text-capitalize",""],[1,"ion-padding"],[3,"formGroup"],["f","ngForm"],["mode","ios",1,"ion-no-padding"],["slot","start",3,"click"],["slot","start","name","cloud-download-sharp"],["cancelText","Cancelar","placeholder","Seleccionar Responsabilidad","color","primary","interface","action-sheet","mode","ios",3,"selectedText","ionChange"],[3,"value",4,"ngFor","ngForOf"],["type","text","formControlName","dias_trabajados_manual"],["type","text","maxlength","80","formControlName","Y06002"],["type","text","maxlength","80","formControlName","equipo_model"],[2,"width","50%"],["formControlName","Taller_lima",3,"allowEmptySelection"],[4,"ngFor","ngForOf"],["type","text","maxlength","80","formControlName","fech_de_registro"],["cancelText","Cancelar","placeholder","Seleccionar Isla","color","primary","interface","action-sheet","mode","ios",3,"selectedText","ionChange"],["expand","block"],["slot","end",3,"click"],["name","camera"],["expand","full",3,"click"],[3,"value"],["aria-label","Custom checkbox",3,"value"],["slot","start"],[3,"src"],["slot","end","fill","clear",3,"click"],["slot","icon-only","name","trash-outline"]],template:function(e,t){1&e&&(o.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-item")(3,"ion-title",1)(4,"ion-label"),o._uU(5,"DATOS GENERALES"),o.qZA()()()()(),o.TgZ(6,"ion-content",2)(7,"form",3,4)(9,"ion-list",5)(10,"ion-item")(11,"ion-button",6),o.NdJ("click",function(){return t.DownloadOpenLocalPdf()}),o._UZ(12,"ion-icon",7),o._uU(13," Descargar PDF"),o.qZA()(),o.TgZ(14,"ion-item")(15,"ion-label")(16,"p"),o._uU(17,"RESPONSABILIDAD"),o.qZA(),o.TgZ(18,"ion-select",8),o.NdJ("ionChange",function(a){return t.FSelectChangeResponsable(a,0)}),o.YNc(19,he,2,2,"ion-select-option",9),o.qZA()()(),o.TgZ(20,"ion-item")(21,"ion-label")(22,"p"),o._uU(23,"DIAS TRABAJADOS"),o.qZA(),o._UZ(24,"ion-input",10),o.qZA()(),o.TgZ(25,"ion-item")(26,"ion-label")(27,"p"),o._uU(28,"PROCEDENCIA"),o.qZA(),o._UZ(29,"ion-input",11),o.qZA()(),o.TgZ(30,"ion-item")(31,"ion-label")(32,"p"),o._uU(33,"POTENCIA TIPO:"),o.qZA(),o._UZ(34,"ion-input",12),o.qZA()(),o.TgZ(35,"ion-item")(36,"ion-label")(37,"p"),o._uU(38,"FALLA COM\xdaN"),o.qZA(),o.TgZ(39,"ion-card",13)(40,"ion-card-content")(41,"ion-radio-group",14),o.YNc(42,ge,5,2,"ion-list",15),o.qZA()()()()(),o.TgZ(43,"ion-item")(44,"ion-label")(45,"p"),o._uU(46,"F.INFORME:"),o.qZA(),o._UZ(47,"ion-input",16),o.qZA()(),o.TgZ(48,"ion-item")(49,"ion-label")(50,"p"),o._uU(51,"ISLA:"),o.qZA(),o.TgZ(52,"ion-select",17),o.NdJ("ionChange",function(a){return t.FSelectChangeIsla(a,0)}),o.YNc(53,pe,2,2,"ion-select-option",9),o.qZA()()(),o.TgZ(54,"ion-item",18),o._uU(55,"Fotos: "),o.TgZ(56,"ion-fab-button",19),o.NdJ("click",function(){return t.selectImageSource()}),o._UZ(57,"ion-icon",20),o.qZA()(),o.TgZ(58,"ion-list"),o.YNc(59,ve,8,3,"ion-item",15),o.qZA()()()(),o.TgZ(60,"ion-footer")(61,"ion-button",21),o.NdJ("click",function(){return t.SaveFormBorradorPaso1()}),o._uU(62,"GUARDAR"),o.qZA()()),2&e&&(o.xp6(7),o.Q6J("formGroup",t.FormCheckListPaso1),o.xp6(11),o.Q6J("selectedText",t.reponsablePivotSelectedText),o.xp6(1),o.Q6J("ngForOf",t.DsResponabilidad),o.xp6(22),o.Q6J("allowEmptySelection",!0),o.xp6(1),o.Q6J("ngForOf",t.Opciones1),o.xp6(10),o.Q6J("selectedText",t.islaPivotSelectedText),o.xp6(1),o.Q6J("ngForOf",t.DsIsla),o.xp6(6),o.Q6J("ngForOf",t.images))},dependencies:[v.Pc,v.YG,v.PM,v.FN,v.W2,v.W4,v.fr,v.Gu,v.gu,v.Xz,v.pK,v.Ie,v.rH,v.Q$,v.q_,v.B7,v.se,v.t9,v.n0,v.Bs,v.wd,v.sr,v.U5,v.QI,v.j9,I.ez,I.sg,f.u5,f._Y,f.JJ,f.JL,f.nD,f.UX,f.sg,f.u]}),n})()}}]);