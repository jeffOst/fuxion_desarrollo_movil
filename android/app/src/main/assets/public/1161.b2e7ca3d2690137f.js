"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1161],{1161:(Z,p,r)=>{r.r(p),r.d(p,{MttoWinOrdenTrabajo5Page:()=>R});var c=r(5861),C=r(6814),s=r(95),o=r(6728),E=r(1243),t=r(6242),O=r(5472),M=r(1991),T=r(2014),P=r(6172);const D=["IdHtmlInputSearch"],A=()=>({standalone:!0});function v(l,m){if(1&l){const _=t.EpF();t.TgZ(0,"ion-datetime",16),t.NdJ("ngModelChange",function(a){t.CHM(_);const n=t.oxw();return t.KtG(n.ng_fch_ini_inf=a)}),t.qZA()}if(2&l){const _=t.oxw();t.Q6J("preferWheel",!0)("showDefaultButtons",!0)("ngModel",_.ng_fch_ini_inf)("ngModelOptions",t.DdM(4,A))}}let R=(()=>{var l;class m{constructor(e,a,n,i,d,u,g,f){this.navCtrl=e,this.loadingController=a,this.ApiService=n,this.storage=i,this.formBuilder=d,this.alertController=u,this.globalVal=g,this.modalCtrl=f,this.ArrayItemsSelectedDesti=[],this.estaCargando=!1,this.scanActive=!0,this.FormCheckListPaso5=this.formBuilder.group({fch_entrega_mtto:[""],codsmg:[""],correlativo_mtto:[""],obs_entrega:[""],id_orden_trab_cab_2:this.globalVal.id_orden_trab_cab,idusuario:[""],id_orden_trab_cab:[""],guia_salida_mtto:[""],r_nucleo:[""],equipo_ini:[""],cod_nucleo_lt:[""]})}ngOnInit(){let e;this.estaCargando=!0,this.storage.get("USER_INFO").then(a=>{e=a,this.NombresUsuarioLocal=e.user_name,this.IdUsuarioLocal=e.user_id,console.log(e)}),this.FLoadmot()}onTouched(e){console.log(e)}mostrarConfirmacion(){var e=this;return(0,c.Z)(function*(){yield(yield e.alertController.create({header:"Confirmaci\xf3n",message:"\xbfDesea realizar esta acci\xf3n?",cssClass:"alerta-confirma",mode:"ios",buttons:[{text:"Cancelar",role:"cancel",handler:()=>{console.log("Acci\xf3n cancelada")}},{text:"Aceptar",handler:()=>{e.SaveFormTerminadoPaso1()}}]})).present()})()}SaveFormTerminadoPaso1(){var e=this;return(0,c.Z)(function*(){e.loadingController.create({message:"Guardando O.T...",translucent:!0}).then(n=>{n.present()}),console.log("FORMULARIOOOOOO:",e.FormCheckListPaso5.value),e.FormCheckListPaso5.controls.fch_entrega_mtto.setValue(e.ng_fch_ini_inf),yield e.ApiService.GuardarFormPaso5(e.FormCheckListPaso5.value).then(function(){var n=(0,c.Z)(function*(i){e.loadingController.dismiss(),console.log(i);let d="0"==i[0].o_nres?"alerta-error":"alerta-ok";yield(yield e.alertController.create({header:"ORDEN DE TRABAJO",subHeader:"MATERIALES",cssClass:d,mode:"ios",animated:!0,message:i[0].o_msj,buttons:[{text:"Aceptar",handler:()=>{console.log("Operaci\xf3n confirmada")}}]})).present()});return function(i){return n.apply(this,arguments)}}()).finally(()=>{console.log("finally:::>>LN:394")}).catch(n=>{console.log("errror:::>>>>>>>>>",n)})})()}ionViewWillEnter(){let e;this.estaCargando=!0,this.storage.get("USER_INFO").then(a=>{e=a,this.NombresUsuarioLocal=e.user_name,this.IdUsuarioLocal=e.user_id})}open_popup_bombas(){var e=this;return(0,c.Z)(function*(){if(1==e.FormCheckListPaso5.controls.guia_salida_mtto.value)return void(yield(yield e.alertController.create({header:"Alerta",message:"Este motor ya a sido enviado a mina, no se aceptan modificaciones",cssClass:"alerta-confirma",mode:"ios",buttons:[{text:"Aceptar",handler:()=>{}}]})).present());const b=yield e.modalCtrl.create({component:E.PopUpBombaPage,backdropDismiss:!0,showBackdrop:!0,mode:"ios",componentProps:{id_orden_trab_cab:void 0}});return b.onDidDismiss().then(h=>{null!==h&&(e.dataReturned=h.data,console.log("datos",e.dataReturned),e.FormCheckListPaso5.controls.codsmg.setValue(e.dataReturned.codsmg),e.FormCheckListPaso5.controls.correlativo_mtto.setValue(e.dataReturned.id_orden_trab_fis_cab),e.FormCheckListPaso5.controls.id_orden_trab_cab.setValue(e.dataReturned.id_orden_trab_cab))}),yield b.present()})()}FLoadmot(){this.loadingController.create({message:"Cargando lista....",translucent:!0}).then(a=>{a.present(),this.ApiService.FormFindPaso2(this.globalVal.id_orden_trab_cab).then(n=>{this.EditDataRest=n.form,console.log("hrlppp",n.form);try{this.FormCheckListPaso5.setValue({id_orden_trab_cab_2:this.globalVal.id_orden_trab_cab,fch_entrega_mtto:this.EditDataRest[0].fch_entrega_mtto,codsmg:this.EditDataRest[0].equipo_mtto,obs_entrega:this.EditDataRest[0].obs_mtto,correlativo_mtto:this.EditDataRest[0].correlativo_mtto,idusuario:this.IdUsuarioLocal,id_orden_trab_cab:this.EditDataRest[0].nro_ot_salida_mtto,guia_salida_mtto:this.EditDataRest[0].guia_salida_mtto,r_nucleo:this.EditDataRest[0].r_nucleo_listmot,equipo_ini:this.EditDataRest[0].equipo_ini,cod_nucleo_lt:this.EditDataRest[0].cod_nucleo_lt}),this.ng_fch_ini_inf=this.EditDataRest[0].fch_entrega_mtto,console.log(this.EditDataRest)}catch(i){console.log("error:::>",i)}}).finally(()=>{this.loadingController.dismiss()})})}}return(l=m).\u0275fac=function(e){return new(e||l)(t.Y36(O.SH),t.Y36(o.HT),t.Y36(M.k),t.Y36(T.K),t.Y36(s.QS),t.Y36(o.Br),t.Y36(P.X),t.Y36(o.IN))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-mtto-win-orden-trabajo5"]],viewQuery:function(e,a){if(1&e&&t.Gf(D,5),2&e){let n;t.iGM(n=t.CRH())&&(a.IdHtmlInputSearch=n.first)}},standalone:!0,features:[t.jDz],decls:47,vars:2,consts:[["mode","ios"],["text-capitalize",""],[1,"ion-padding"],[3,"formGroup"],["mode","ios",1,"ion-no-padding"],["label","F.Registro Guia:","locale","es-PE","datetime","datetime"],["trigger","popover-button","animated","true","arrow","true","mode","ios",3,"keepContentsMounted"],["readonly","","color","primary","formControlName","fch_entrega_mtto"],["readonly","","formControlName","equipo_ini"],["type","text","placeholder","Seleccionar Bomba","mode","ios","readonly","","formControlName","codsmg",3,"click"],["formControlName","correlativo_mtto","readonly",""],["formControlName","obs_entrega"],["mode","ios","formControlName","r_nucleo",3,"ionChange"],["value","1"],["value","2"],["color","primary","expand","full",3,"click"],["locale","es-PE","id","datetime","mode","ios","displayFormat","YYYY-MM-DD HH:mm","presentation","date-time","pickerFormat","YYYY-MM-DD HH:mm",3,"preferWheel","showDefaultButtons","ngModel","ngModelOptions","ngModelChange"]],template:function(e,a){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-item")(3,"ion-title",1)(4,"ion-label"),t._uU(5,"ENTREGA DE MOTOR"),t.qZA()()()()(),t.TgZ(6,"ion-content",2)(7,"form",3)(8,"ion-list",4)(9,"ion-item")(10,"ion-label"),t._uU(11,"F. Asignacion:"),t.qZA(),t._UZ(12,"ion-datetime-button",5),t.TgZ(13,"ion-popover",6),t.YNc(14,v,1,5,"ng-template"),t.qZA()(),t.TgZ(15,"ion-item")(16,"ion-label"),t._uU(17,"F. Lectura:"),t.qZA(),t._UZ(18,"ion-input",7),t.qZA(),t.TgZ(19,"ion-item")(20,"ion-label"),t._uU(21,"Equipo Inicial: \xa0"),t.qZA(),t._UZ(22,"ion-input",8),t.qZA(),t.TgZ(23,"ion-item")(24,"ion-searchbar",9),t.NdJ("click",function(){return a.open_popup_bombas()}),t._uU(25," Equipo Final:\xa0 "),t.qZA()(),t.TgZ(26,"ion-item")(27,"ion-label"),t._uU(28,"Correlativo: \xa0 "),t.qZA(),t._UZ(29,"ion-input",10),t.qZA(),t.TgZ(30,"ion-item")(31,"ion-label"),t._uU(32,"Observaciones:\xa0 "),t.qZA(),t._UZ(33,"ion-input",11),t.qZA(),t.TgZ(34,"ion-item")(35,"ion-label"),t._uU(36," R. Nucleo: "),t.TgZ(37,"ion-segment",12),t.NdJ("ionChange",function(i){return a.onTouched(i)}),t.TgZ(38,"ion-segment-button",13)(39,"ion-label"),t._uU(40,"SI"),t.qZA()(),t.TgZ(41,"ion-segment-button",14)(42,"ion-label"),t._uU(43,"NO"),t.qZA()()()()()()()(),t.TgZ(44,"ion-footer")(45,"ion-button",15),t.NdJ("click",function(){return a.mostrarConfirmacion()}),t._uU(46,"Guardar Cambios"),t.qZA()()),2&e&&(t.xp6(7),t.Q6J("formGroup",a.FormCheckListPaso5),t.xp6(6),t.Q6J("keepContentsMounted",!0))},dependencies:[o.Pc,o.YG,o.W2,o.x4,o.Mj,o.fr,o.Gu,o.pK,o.Ie,o.Q$,o.q_,o.VI,o.cJ,o.GO,o.wd,o.sr,o.d8,o.QI,o.j9,C.ez,s.u5,s._Y,s.JJ,s.JL,s.On,s.UX,s.sg,s.u]}),m})()}}]);