"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1141,1456],{1456:(y,f,h)=>{h.d(f,{k:()=>C});var g=h(5861),M=h(4053),m=h(8256),d=h(529),t=h(849);let C=(()=>{class P{constructor(e,o,i){this.httpClient=e,this.http=o,this.storage=i,this.urlApiProd=M.N.UrlDomainLocal+"aw_modulos/mante/api/CApiOrdenTrabajo.php",this.DirectorioImg=M.N.UrlDomainLocal+"aw_file/img_tablet/",this.confirmRequest="",this.key="123456",this.counts_rows=0,this.ArrayItemsSelected=[],this.EditArItemsSelected=[],this.o_nres="",this.o_msj="",this.idhorasxVueltaOtCab="",this.radioRevisionSelected=""}load_lista_solse(e,o){let i=this.urlApiProd,n=JSON.stringify({idot:e,acc:5,idtablet:"this.device.uuid",idotsolse_otd:o});return this.http.post(i,n).toPromise().then(s=>s)}FListOtPorSolsePieza(e,o,i,n){let s=this.urlApiProd,l=JSON.stringify({s:e,acc:i,tipo:o,idtablet:"this.device.uuid",madre_hija:n});return this.httpClient.post(s,l).toPromise().then(p=>p)}listado_principal_ot(e,o,i,n){let s=this.urlApiProd,l=JSON.stringify({s:e,acc:i,tipo:o,idtablet:"this.device.uuid",madre_hija:n});return this.httpClient.post(s,l).toPromise().then(p=>p)}listado_servicio_popup(e,o,i,n,s){let l=this.urlApiProd,p=JSON.stringify({s:e,acc:o,avatar:i,idpieza:n,idtablet:"this.device.uuid",idtablet2:s});return this.http.post(l,p).toPromise().then(a=>a)}guardar_servicios_selected_ot(e,o){let i=JSON.stringify(e);return console.log("paramsToBd:::>",e),this.httpClient.post(this.urlApiProd+"?acc=4&idot="+o,i).toPromise().then(s=>s)}update_solse_ot(e,o){let i=JSON.stringify(e);return console.log("paramsToBd:::>",e),this.httpClient.post(this.urlApiProd+"?acc=6&idot="+o,i).toPromise().then(s=>s)}update_solse_ot_qr(e,o){let i=JSON.stringify(e);return console.log("paramsToBd:::>",e),this.httpClient.post(this.urlApiProd+"?acc=7&idsolse="+o,i).toPromise().then(s=>s)}listado_equipos_service(e,o,i,n){let s=this.urlApiProd,l=JSON.stringify({s:e,acc:i,tipo:o,idtablet:"this.device.uuid",madre_hija:n});return this.http.post(s,l).toPromise().then(p=>p)}load_lista_servicios(e){let o=this.urlApiProd,i=JSON.stringify({idot:e,acc:3,idtablet:"this.device.uuid"});return this.http.post(o,i).toPromise().then(n=>n)}llamarMaestroServicios(e,o,i,n,s){let l=this.urlApiProd,p=JSON.stringify({s:e,acc:i,tipo:o,idtablet:s,madre_hija:n});return this.http.post(l,p).toPromise().then(a=>a)}EjServQuitarItemSelected(e){var o=this;return(0,g.Z)(function*(){let i=o.urlApiProd,n={id:e.idvaleservidetot,avatar:e.avatar,acc:6};o.ArrayItemsSelectedPivot=e,o.http.post(i,n).subscribe(s=>{},s=>{console.log("Error- something is wrong!")}),o.CntAgregado=o.EjeSerQuitarStorage(o.ArrayItemsSelectedPivot)})()}EjeSerQuitarStorage(e){let o=this.ArrayItemsSelected.indexOf(e);return o>-1&&this.ArrayItemsSelected.splice(o,1),this.storage.set("my-items",this.ArrayItemsSelected),this.ArrayItemsSelected.length}FListCbosDejarEje(e){let o=this.urlApiProd,i=JSON.stringify({idot:e,acc:9,idtablet:"this.device.uuid"});return this.http.post(o,i).toPromise().then(n=>n)}SaveRecojerPieza(e){let o=JSON.stringify(e);return this.httpClient.post(this.urlApiProd,o).toPromise().then(i=>i)}ListFindTecnico(e,o,i){let n=JSON.stringify({acc:11,s:e,idusu:o,iddevice:i});return this.httpClient.post(this.urlApiProd,n).toPromise().then(s=>s)}ListFindEquipo(e,o,i){let n=JSON.stringify({acc:12,s:e,idusu:o,iddevice:i});return this.httpClient.post(this.urlApiProd,n).toPromise().then(s=>s)}load_cbo_site(){let e=JSON.stringify({acc:13});return this.httpClient.post(this.urlApiProd,e).toPromise().then(o=>o)}SaveOtNoProgramada(e){let o=JSON.stringify(e);return this.httpClient.post(this.urlApiProd,o).toPromise().then(i=>i)}ListFindOts(e,o,i){let n=JSON.stringify({acc:15,s:e,idusu:o,iddevice:i});return this.httpClient.post(this.urlApiProd,n).toPromise().then(s=>s)}FormFindPaso1(e,o,i){let n=JSON.stringify({acc:16,id_orden_trab_cab:e,idusu:o,iddevice:i});return this.httpClient.post(this.urlApiProd,n).toPromise().then(s=>s)}GuardarFormPaso1(e){var o=this;return(0,g.Z)(function*(){console.log("Dentro::GuardarFormulario::>",e);let n=o.urlApiProd,s=JSON.stringify(e);return o.httpClient.post(n+"?acc=17",s).toPromise()})()}LoadPdfInformeTecnico(e){let o=JSON.stringify({acc:14,idchecklistcab:e});return this.httpClient.post(this.urlApiProd,o).toPromise().then(i=>i)}ListBombasxFabTableros(e,o,i){let n=JSON.stringify({acc:18,s:e,idusu:o,familia:i});return this.httpClient.post(this.urlApiProd,n).toPromise().then(s=>s)}GuardarNuevoEquipo(e){var o=this;return(0,g.Z)(function*(){console.log("Dentro::GuardarFormulario::>",e);let n=o.urlApiProd,s=JSON.stringify(e);return o.httpClient.post(n+"?acc=19",s).toPromise()})()}ListRepuestosxBomba(e,o){let i=JSON.stringify({acc:20,idot:e,idusu:o});return this.httpClient.post(this.urlApiProd,i).toPromise().then(n=>n)}GuardarFormPaso2(e,o){var i=this;return(0,g.Z)(function*(){let s=i.urlApiProd,l=JSON.stringify(e);return i.httpClient.post(s+"?acc=21&idusu="+o,l).toPromise()})()}listadoArticulos(e,o,i,n,s){console.log(e);let l=this.urlApiProd,p=JSON.stringify({s:e,idpieza:o,cantidad:i,toggle:n,acc:s});return this.http.post(l,p).toPromise().then(a=>a)}GuardarArticulo(e){var o=this;return(0,g.Z)(function*(){console.log("Dentro::GuardarFormulario::>",e);let n=o.urlApiProd,s=JSON.stringify(e);return o.httpClient.post(n+"?acc=23",s).toPromise()})()}ListServiciosxBomba(e,o){let i=JSON.stringify({acc:24,idot:e,idusu:o});return this.httpClient.post(this.urlApiProd,i).toPromise().then(n=>n)}ListFindSolse(e,o){let i=JSON.stringify({acc:26,idot:e,idusu:o});return this.httpClient.post(this.urlApiProd,i).toPromise().then(n=>n)}GuardarOtTerminado(e,o){var i=this;return(0,g.Z)(function*(){let s=i.urlApiProd,l=JSON.stringify({acc:27,idot:e,idusuario:o});return i.httpClient.post(s,l).toPromise()})()}LoadPdfOrdentrabajo(e){let o=JSON.stringify({acc:28,idchecklistcab:e});return this.httpClient.post(this.urlApiProd,o).toPromise().then(i=>i)}FLoadMotivoAdicional(e,o){let i=JSON.stringify({acc:29,idusu:e,iddevice:o});return this.httpClient.post(this.urlApiProd,i).toPromise().then(n=>n)}FQuitarItem(e){var o=this;return(0,g.Z)(function*(){let i=o.urlApiProd,n=JSON.stringify(e);return o.httpClient.post(i,n).toPromise()})()}ListaPartList(e,o,i,n,s,l,p){let a=this.urlApiProd,r=JSON.stringify({s:e,pd:o,ot:i,im:n,it:s,acc:l,idot:p});return this.http.post(a,r).toPromise().then(u=>u)}GuardarPartList(e){var o=this;return(0,g.Z)(function*(){console.log("Dentro::GuardarFormulario::>",e);let n=o.urlApiProd,s=JSON.stringify(e);return o.httpClient.post(n+"?acc=32",s).toPromise()})()}}return P.\u0275fac=function(e){return new(e||P)(m.LFG(d.eN),m.LFG(d.eN),m.LFG(t.K))},P.\u0275prov=m.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})()},1141:(y,f,h)=>{h.r(f),h.d(f,{MttoOtisPopUpAddItemPage:()=>s});var g=h(5861),M=h(6895),m=h(433),d=h(5562),t=h(8256),O=h(1456),C=h(1407),P=h(849);const v=["idinputsearch_equipo"];function e(l,p){if(1&l&&(t.TgZ(0,"ion-select-option",20),t._uU(1),t.qZA()),2&l){const a=p.$implicit;t.Q6J("value",a.codigo),t.xp6(1),t.hij("",a.nombre," ")}}function o(l,p){1&l&&(t.TgZ(0,"ion-col",17),t._uU(1,"Stock Alm.General"),t.qZA())}function i(l,p){if(1&l&&(t.TgZ(0,"ion-col",25),t._uU(1),t.qZA()),2&l){const a=t.oxw().$implicit;t.xp6(1),t.Oqu(a.Y08056)}}function n(l,p){if(1&l){const a=t.EpF();t.TgZ(0,"ion-row",21),t.NdJ("click",function(){const c=t.CHM(a).$implicit,_=t.oxw();return t.KtG(_.SeleccionarEquipo(c))}),t.TgZ(1,"ion-col",22),t._uU(2),t.qZA(),t.TgZ(3,"ion-col",23),t._uU(4),t.qZA(),t.YNc(5,i,2,1,"ion-col",24),t.TgZ(6,"ion-col",25),t._uU(7),t.qZA(),t.TgZ(8,"ion-col",22)(9,"ion-chip"),t._UZ(10,"ion-icon",26),t.TgZ(11,"ion-label",27),t._uU(12),t.qZA(),t._UZ(13,"ion-icon",28),t.qZA()()()}if(2&l){const a=p.$implicit,r=t.oxw();t.ekj("selected",1===r.selectedRow),t.xp6(2),t.Oqu(a.Y04001),t.xp6(2),t.Oqu(a.Y04002),t.xp6(1),t.Q6J("ngIf","1"===r.FormModel.rs),t.xp6(2),t.Oqu(a.ma00_descrip),t.xp6(5),t.Oqu(a.nomclase)}}let s=(()=>{class l{constructor(a,r,u,c,_,F,T,S){let A;this.loadingController=a,this.ApiService=r,this.modalCtrl=u,this.route=c,this.navParams=_,this.alertController=F,this.toastController=T,this.storage=S,this.search_term_equipo="",this.switchButtonSegmento="",this.selectedRow=null,this.tituloVentana="",this.storage.get("USER_INFO").then(Z=>{A=Z,this.NombresUsuarioLocal=A.user_name,this.IdUsuarioLocal=A.user_id}),this.FormModel={},this.FormModel.idpieza=this.navParams.get("row").idclase,this.FormModel.pieza=this.navParams.get("row").nomclase,this.FormModel.rs=this.navParams.get("row").rs,this.FormModel.toggle="0"!=this.FormModel.idpieza,this.FormModel.o_nres=0,this.FormModel.window="0"==this.FormModel.idpieza,this.tituloVentana="1"==this.FormModel.rs?"Agregar Materiales":"Agregar Servicios",this.FormModel.id_orden_trab_cab=this.navParams.get("row").id_orden_trab_cab}ngOnInit(){}cancelar_listaequipos(a,r,u){var c=this;return(0,g.Z)(function*(){const _={idequipo:a,id_orden_trab_fis_cab:r,fch_inicio_ot:u};yield c.modalCtrl.dismiss(_)})()}lista_equipos(a){a.preventDefault(),this.loadingController.create({message:"Cargando lista...::",translucent:!0}).then(u=>{u.present(),this.ApiService.listadoArticulos(this.search_term_equipo,this.FormModel.idpieza,this.FormModel.cantidad,this.FormModel.toggle,"1"==this.FormModel.rs?"22":"25").then(_=>{this.results_equipos=_,this.loadingController.dismiss()}).finally(()=>{this.loadingController.dismiss(),setTimeout(()=>{},700)})})}SeleccionarEquipo(a){var r=this;return(0,g.Z)(function*(){yield(yield r.alertController.create({header:"Confirmaci\xf3n",message:"\xbfDesea agregar este producto?",cssClass:"alerta-confirma",mode:"ios",buttons:[{text:"Cancelar",role:"cancel",handler:()=>{console.log("Acci\xf3n cancelada")}},{text:"Aceptar",handler:()=>{r.SaveItemAdded(a)}}]})).present()})()}SaveItemAdded(a){var r=this;return(0,g.Z)(function*(){console.log(r.FormModel.cantidad),console.log(r.FormModel),""!=r.FormModel.cantidad&&r.FormModel.cantidad>0?(r.loadingController.create({message:"Guardando item...",translucent:!0}).then(c=>{c.present()}),r.FormModel.Y04001=a.Y04001,r.FormModel.IdUsuarioLocal=r.IdUsuarioLocal,yield r.ApiService.GuardarArticulo(r.FormModel).then(function(){var c=(0,g.Z)(function*(_){r.loadingController.dismiss(),console.log(_);let F="0"==_[0].o_nres?"alerta-error":"alerta-ok";var S;yield(yield r.alertController.create({header:"ORDEN DE TRABAJO",subHeader:"MATERIALES",cssClass:F,mode:"ios",animated:!0,message:_[0].o_msj,buttons:[{text:"Aceptar",handler:(S=(0,g.Z)(function*(){if(console.log("Operaci\xf3n confirmada"),r.FormModel.o_nres=_[0].o_nres,"1"==_[0].o_nres){if(console.log(r.FormModel.window),r.presentToast(_[0].o_msj),!r.FormModel.window){const A=r.FormModel;yield r.modalCtrl.dismiss(A)}}else r.presentToast(_[0].o_msj)}),function(){return S.apply(this,arguments)})}]})).present()});return function(_){return c.apply(this,arguments)}}()).finally(()=>{console.log("finally:::>>LN:394")}).catch(c=>{console.log("errror:::>>>>>>>>>",c)})):yield(yield r.alertController.create({header:"ORDEN DE TRABAJO",subHeader:"MATERIALES",cssClass:"alerta-error",mode:"ios",animated:!0,message:"Falta asignar cantidad",buttons:[{text:"Aceptar",handler:()=>{console.log("Operaci\xf3n confirmada")}}]})).present()})()}FSelectChangeTipoMotivo(a){}ionViewWillEnter(){this.FLoadForms()}FLoadForms(){this.loadingController.create({message:"Cargando lista....",translucent:!0}).then(r=>{r.present(),this.ApiService.FLoadMotivoAdicional("0","1").then(u=>{this.DsTipoMotivo=u.motivo,r.dismiss()})})}presentToast(a){var r=this;return(0,g.Z)(function*(){console.log("ingreso toast"),yield(yield r.toastController.create({message:a,duration:1500,position:"bottom"})).present()})()}}return l.\u0275fac=function(a){return new(a||l)(t.Y36(d.HT),t.Y36(O.k),t.Y36(d.IN),t.Y36(C.gz),t.Y36(d.X1),t.Y36(d.Br),t.Y36(d.yF),t.Y36(P.K))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-mtto-otis-pop-up-add-item"]],viewQuery:function(a,r){if(1&a&&t.Gf(v,5),2&a){let u;t.iGM(u=t.CRH())&&(r.idinputsearch_equipo=u.first)}},standalone:!0,features:[t.jDz],decls:56,vars:16,consts:[["mode","ios"],["slot","start"],["color","danger",3,"click"],["name","close"],["nopadding",""],["type","text","maxlength","80",3,"ngModel","ngModelChange"],["slot","end","mode","ios","labelPlacement","start",2,"font-size","x-small",3,"checked","ngModel","ngModelChange"],["color","warning"],["mode","ios",3,"autoGrow","autofocus","ngModel","ngModelChange"],["cancelText","Cancelar","placeholder","Seleccionar Motivo","color","primary","interface","action-sheet","mode","ios",3,"ngModel","ionChange","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["show-clear-button","focus","animated","true","mode","ios","debounce","1700","cancelButtonText","Cancelar","enterkeyhint","done","placeholder","Buscar items...","color","secondary",3,"ngModel","ngModelChange","ionInput"],["idinputsearch_equipo",""],[1,"header-grid"],["size","2",1,"header"],["size","6",1,"header"],["class","header","size","1",4,"ngIf"],["size","1",1,"header"],[1,"content-grid"],[3,"selected","click",4,"ngFor","ngForOf"],[3,"value"],[3,"click"],["size","2",1,"detail"],["size","6",1,"detail"],["class","detail","size","1",4,"ngIf"],["size","1",1,"detail"],["name","add-outline"],[2,"font-size","smaller"],["name","caret-forward-outline"]],template:function(a,r){1&a&&(t.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),t._uU(3),t.qZA(),t.TgZ(4,"ion-buttons",1)(5,"ion-button",2),t.NdJ("click",function(){return r.cancelar_listaequipos(0,0,0)}),t._UZ(6,"ion-icon",3),t._uU(7," Cancelar "),t.qZA()()(),t.TgZ(8,"ion-item",4)(9,"ion-label",1)(10,"p"),t._uU(11,"Pieza Seleccionada:"),t.qZA()(),t.TgZ(12,"ion-input",5),t.NdJ("ngModelChange",function(c){return r.FormModel.pieza=c}),t.qZA(),t.TgZ(13,"ion-toggle",6),t.NdJ("ngModelChange",function(c){return r.FormModel.toggle=c}),t._uU(14," Aplicar al Filtro de busqueda: "),t.qZA()(),t.TgZ(15,"ion-item",4)(16,"ion-label")(17,"p"),t._uU(18,"Cantidad a Solicitar:"),t.qZA()(),t.TgZ(19,"ion-input",5),t.NdJ("ngModelChange",function(c){return r.FormModel.cantidad=c}),t.qZA(),t.TgZ(20,"ion-toggle",6),t.NdJ("ngModelChange",function(c){return r.FormModel.window=c}),t._uU(21," Agregar items sin cerrar ventana: "),t.qZA()(),t.TgZ(22,"ion-item",4)(23,"ion-label")(24,"p"),t._uU(25,"Observasiones "),t.TgZ(26,"ion-text",7),t._uU(27,"(Adicional)"),t.qZA(),t._uU(28,":"),t.qZA()(),t.TgZ(29,"ion-textarea",8),t.NdJ("ngModelChange",function(c){return r.FormModel.otd_detalle=c}),t.qZA()(),t.TgZ(30,"ion-item",4)(31,"ion-label")(32,"p"),t._uU(33,"Motivo "),t.TgZ(34,"ion-text",7),t._uU(35,"(Adicional)"),t.qZA(),t._uU(36,":"),t.qZA()(),t.TgZ(37,"ion-select",9),t.NdJ("ionChange",function(c){return r.FSelectChangeTipoMotivo(c)})("ngModelChange",function(c){return r.FormModel.motivo_adicional_otd=c}),t.YNc(38,e,2,2,"ion-select-option",10),t.qZA()(),t.TgZ(39,"ion-item",4)(40,"ion-searchbar",11,12),t.NdJ("ngModelChange",function(c){return r.search_term_equipo=c})("ionInput",function(c){return r.lista_equipos(c)}),t.qZA()()(),t.TgZ(42,"ion-content")(43,"ion-grid",13)(44,"ion-row")(45,"ion-col",14),t._uU(46,"Codigo"),t.qZA(),t.TgZ(47,"ion-col",15),t._uU(48,"Descripci\xf3n"),t.qZA(),t.YNc(49,o,2,0,"ion-col",16),t.TgZ(50,"ion-col",17),t._uU(51,"Unidad Medida"),t.qZA(),t.TgZ(52,"ion-col",14),t._uU(53,"Pieza"),t.qZA()()(),t.TgZ(54,"ion-grid",18),t.YNc(55,n,14,7,"ion-row",19),t.qZA()()),2&a&&(t.xp6(3),t.Oqu(r.tituloVentana),t.xp6(9),t.Q6J("ngModel",r.FormModel.pieza),t.xp6(1),t.Q6J("checked",!0)("ngModel",r.FormModel.toggle),t.xp6(6),t.Q6J("ngModel",r.FormModel.cantidad),t.xp6(1),t.Q6J("checked",!0)("ngModel",r.FormModel.window),t.xp6(9),t.Q6J("autoGrow",!0)("autofocus",!0)("autoGrow",!0)("ngModel",r.FormModel.otd_detalle),t.xp6(8),t.Q6J("ngModel",r.FormModel.motivo_adicional_otd),t.xp6(1),t.Q6J("ngForOf",r.DsTipoMotivo),t.xp6(2),t.Q6J("ngModel",r.search_term_equipo),t.xp6(9),t.Q6J("ngIf","1"===r.FormModel.rs),t.xp6(6),t.Q6J("ngForOf",r.results_equipos))},dependencies:[d.Pc,d.YG,d.Sm,d.hM,d.wI,d.W2,d.jY,d.Gu,d.gu,d.pK,d.Ie,d.Q$,d.Nd,d.VI,d.t9,d.n0,d.yW,d.g2,d.wd,d.ho,d.sr,d.w,d.QI,d.j9,M.ez,M.sg,M.O5,m.u5,m.JJ,m.nD,m.On],styles:['@charset "UTF-8";.ion-row[_ngcontent-%COMP%]{font-size:10px;color:#000;font-weight:700}ion-col[_ngcontent-%COMP%]{font-size:9px;color:#555}ion-col.header[_ngcontent-%COMP%]{border:1px solid #ccc;padding:8px;color:#000;font-weight:700}ion-col.detail[_ngcontent-%COMP%]{border-bottom:1px solid #ccc;padding:4px}.header-grid[_ngcontent-%COMP%]{display:grid;grid-template-rows:auto}.content-grid[_ngcontent-%COMP%]{display:grid;grid-template-rows:repeat(auto-fill,minmax(40px,1fr));overflow-y:scroll;max-height:500px}ion-chip[_ngcontent-%COMP%]{height:25px;font-size:9px;margin-inline:0px;margin-top:0;margin-bottom:0}']}),l})()}}]);