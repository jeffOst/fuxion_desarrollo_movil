"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5974],{5974:(E,M,l)=>{l.r(M),l.d(M,{MttoOtisPopUpAddPartListPage:()=>L});var u=l(5861),P=l(6814),p=l(95),a=l(6728),e=l(6242),A=l(5472),O=l(1991),T=l(4248),C=l(2014),Z=l(6172);const U=["idinputsearch_equipo"];function q(d,c){if(1&d){const r=e.EpF();e.TgZ(0,"ion-item-group",16),e.NdJ("click",function(){const n=e.CHM(r).$implicit,o=e.oxw();return e.KtG(o.SeleccionarEquipo(n))}),e.TgZ(1,"ion-item-divider")(2,"ion-note",1),e._uU(3),e.qZA(),e.TgZ(4,"ion-label")(5,"ion-chip",17),e._UZ(6,"ion-icon",18),e.TgZ(7,"ion-label",19),e._uU(8),e.qZA(),e._UZ(9,"ion-icon",20),e.qZA(),e.TgZ(10,"ion-chip",21),e._uU(11),e.qZA()()(),e.TgZ(12,"ion-item",4)(13,"ion-note",1),e._uU(14,"Tipo:"),e.qZA(),e.TgZ(15,"ion-label"),e._uU(16),e.qZA(),e.TgZ(17,"ion-note",22),e._uU(18,"Potencia:"),e.qZA(),e.TgZ(19,"ion-label",22),e._uU(20),e.qZA()(),e.TgZ(21,"ion-item",4)(22,"ion-note",1),e._uU(23,"Marca:"),e.qZA(),e.TgZ(24,"ion-label"),e._uU(25),e.qZA(),e.TgZ(26,"ion-note",22),e._uU(27,"Modelo:\xa0"),e.qZA(),e.TgZ(28,"ion-label",22),e._uU(29),e.qZA()(),e.TgZ(30,"ion-item",4)(31,"ion-note",1),e._uU(32,"Configuracion:"),e.qZA(),e.TgZ(33,"ion-label"),e._uU(34),e.qZA()()()}if(2&d){const r=c.$implicit,i=c.index;e.xp6(3),e.Oqu(i+1),e.xp6(2),e.s9C("color",r.color),e.xp6(3),e.Oqu(r.tipofuente),e.xp6(3),e.hij("",r.totitem,"\xa0Items"),e.xp6(5),e.Oqu(r.tipo),e.xp6(4),e.Oqu(r.potencia),e.xp6(5),e.Oqu(r.marca),e.xp6(4),e.Oqu(r.modelo),e.xp6(5),e.Oqu(r.configuracion)}}let L=(()=>{var d;class c{constructor(i,t,n,o,s,g,f,m,_){let h;this.loadingController=i,this.ApiService=t,this.modalCtrl=n,this.route=o,this.navParams=s,this.alertController=g,this.toastController=f,this.storage=m,this.globalVal=_,this.search_term_equipo="",this.switchButtonSegmento="",this.selectedRow=null,this.tituloVentana="",this.searchTerm="",this.storage.get("USER_INFO").then(F=>{h=F,this.NombresUsuarioLocal=h.user_name,this.IdUsuarioLocal=h.user_id}),this.FormModel={},this.FormModel.idot=this.navParams.get("row").id_orden_trab_cab,this.FormModel.ot=!1,this.FormModel.im=!0,this.FormModel.it=!0,this.FormModel.o_nres=0,this.tituloVentana="PartList",this.FormModel.tipo=_.tipo,this.FormModel.modelo=_.modelo,this.FormModel.marca=_.marca,this.FormModel.potencia=_.potencia}ngOnInit(){}cancelar_listaequipos(i,t,n){var o=this;return(0,u.Z)(function*(){const s={idequipo:i,id_orden_trab_fis_cab:t,fch_inicio_ot:n};yield o.modalCtrl.dismiss(s)})()}lista_equipos(i,t){i.preventDefault(),this.searchTerm=i.target.value,(this.searchTerm.trim().length>=5||1===t)&&this.loadingController.create({message:"Cargando lista...::",translucent:!0}).then(o=>{o.present(),this.ApiService.ListaPartList(this.search_term_equipo,this.FormModel.pd,this.FormModel.ot,this.FormModel.im,this.FormModel.it,"31",this.FormModel.idot).then(g=>{this.results_equipos=g,this.loadingController.dismiss()}).finally(()=>{this.loadingController.dismiss(),setTimeout(()=>{this.idinputsearch_equipo.setFocus()},700)})})}SeleccionarEquipo(i){var t=this;return(0,u.Z)(function*(){yield(yield t.alertController.create({header:"Confirmaci\xf3n",message:"\xbfDesea cargar el PartList seleccionado?",cssClass:"alerta-confirma",mode:"ios",buttons:[{text:"Cancelar",role:"cancel",handler:()=>{console.log("Acci\xf3n cancelada")}},{text:"Aceptar",handler:()=>{t.SaveItemAdded(i)}}]})).present()})()}SaveItemAdded(i){var t=this;return(0,u.Z)(function*(){""!=t.FormModel.potencia?(t.loadingController.create({message:"Guardando PartList...",translucent:!0}).then(o=>{o.present()}),t.FormModel.Y04001=i.Y04001,t.FormModel.IdUsuarioLocal=t.IdUsuarioLocal,yield t.ApiService.GuardarPartList(i).then(function(){var o=(0,u.Z)(function*(s){t.loadingController.dismiss();let g="0"==s[0].o_nres?"alerta-error":"alerta-ok";var m;yield(yield t.alertController.create({header:"ORDEN DE TRABAJO",subHeader:"PartList",cssClass:g,mode:"ios",animated:!0,message:s[0].o_msj,buttons:[{text:"Aceptar",handler:(m=(0,u.Z)(function*(){if(console.log("Operaci\xf3n confirmada"),t.FormModel.o_nres=s[0].o_nres,"1"==s[0].o_nres){if(console.log(t.FormModel.window),t.presentToast(s[0].o_msj),!t.FormModel.window){const _=i;yield t.modalCtrl.dismiss(_)}}else t.presentToast(s[0].o_msj)}),function(){return m.apply(this,arguments)})}]})).present()});return function(s){return o.apply(this,arguments)}}()).finally(()=>{console.log("finally:::>>LN:394")}).catch(o=>{console.log("errror:::>>>>>>>>>",o)})):yield(yield t.alertController.create({header:"ORDEN DE TRABAJO",subHeader:"MATERIALES",cssClass:"alerta-error",mode:"ios",animated:!0,message:"Falta asignar cantidad",buttons:[{text:"Aceptar",handler:()=>{console.log("Operaci\xf3n confirmada")}}]})).present()})()}FSelectChangeTipoMotivo(i){}ionViewWillEnter(){this.FLoadForms()}FLoadForms(){this.loadingController.create({message:"Cargando lista....",translucent:!0}).then(t=>{t.present(),this.ApiService.FLoadMotivoAdicional("0","1").then(n=>{this.DsTipoMotivo=n.motivo,t.dismiss()})})}presentToast(i){var t=this;return(0,u.Z)(function*(){console.log("ingreso toast"),yield(yield t.toastController.create({message:i,duration:1500,position:"bottom"})).present()})()}}return(d=c).\u0275fac=function(i){return new(i||d)(e.Y36(a.HT),e.Y36(O.k),e.Y36(a.IN),e.Y36(T.gz),e.Y36(A.X1),e.Y36(a.Br),e.Y36(a.yF),e.Y36(C.K),e.Y36(Z.X))},d.\u0275cmp=e.Xpm({type:d,selectors:[["app-mtto-otis-pop-up-add-part-list"]],viewQuery:function(i,t){if(1&i&&e.Gf(U,5),2&i){let n;e.iGM(n=e.CRH())&&(t.idinputsearch_equipo=n.first)}},standalone:!0,features:[e.jDz],decls:47,vars:19,consts:[["mode","ios"],["slot","start"],["color","danger",3,"click"],["name","close"],[2,"font-size","x-small","padding","0px","min-height","0px"],[2,"font-size","x-small"],["color","dark"],["lines","none",2,"font-size","x-small","padding","0px","min-height","0px"],["slot","start","mode","ios",2,"font-size","x-small",3,"enableOnOffLabels","checked","ngModel","ngModelChange","ionChange"],["slot","end","mode","ios",2,"font-size","x-small",3,"enableOnOffLabels","checked","ngModel","ngModelChange","ionChange"],[2,"font-size","x-small","padding","0px","min-height","10px !important"],["show-clear-button","focus","animated","true","mode","ios","cancelButtonText","Cancelar","enterkeyhint","done","placeholder","Buscar...","color","secondary",3,"ngModel","ngModelChange","ionInput"],["idinputsearch_equipo",""],["slot","end","name","sync-outline",3,"click"],["idIconButtonSync",""],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[3,"color"],["name","add-outline"],[2,"font-size","smaller"],["name","caret-forward-outline"],["color","danger"],["slot","end"]],template:function(i,t){1&i&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),e._uU(3),e.qZA(),e.TgZ(4,"ion-buttons",1)(5,"ion-button",2),e.NdJ("click",function(){return t.cancelar_listaequipos(0,0,0)}),e._UZ(6,"ion-icon",3),e._uU(7," Cancelar "),e.qZA()()(),e.TgZ(8,"ion-item",4)(9,"ion-label")(10,"h3",5),e._uU(11,"Caracteristicas del equipo:"),e.qZA(),e.TgZ(12,"p"),e._uU(13," Modelo:"),e.TgZ(14,"ion-text",6),e._uU(15),e.qZA(),e._uU(16,", Marca:"),e.TgZ(17,"ion-text",6),e._uU(18),e.qZA(),e._uU(19,", Tipo:"),e.TgZ(20,"ion-text",6),e._uU(21),e.qZA(),e._uU(22,", Potencia:"),e.TgZ(23,"ion-text",6),e._uU(24),e.qZA()()()(),e.TgZ(25,"ion-item-group")(26,"ion-item-divider")(27,"ion-label"),e._uU(28," Filtros: "),e.qZA()(),e.TgZ(29,"ion-item",7)(30,"ion-toggle",8),e.NdJ("ngModelChange",function(o){return t.FormModel.ot=o})("ionChange",function(o){return t.lista_equipos(o,1)}),e._uU(31," Solo Plantillas de OTs: "),e.qZA(),e.TgZ(32,"ion-toggle",9),e.NdJ("ngModelChange",function(o){return t.FormModel.pd=o})("ionChange",function(o){return t.lista_equipos(o,1)}),e._uU(33," Solo PartList Dise\xf1o: "),e.qZA()(),e.TgZ(34,"ion-item",7)(35,"ion-toggle",8),e.NdJ("ngModelChange",function(o){return t.FormModel.im=o})("ionChange",function(o){return t.lista_equipos(o,1)}),e._uU(36," Igual al Modelo: "),e.qZA(),e.TgZ(37,"ion-toggle",9),e.NdJ("ngModelChange",function(o){return t.FormModel.it=o})("ionChange",function(o){return t.lista_equipos(o,1)}),e._uU(38," Igual al Tipo: "),e.qZA()()(),e.TgZ(39,"ion-item",10)(40,"ion-searchbar",11,12),e.NdJ("ngModelChange",function(o){return t.search_term_equipo=o})("ionInput",function(o){return t.lista_equipos(o,2)}),e.qZA(),e.TgZ(42,"ion-icon",13,14),e.NdJ("click",function(o){return t.lista_equipos(o,1)}),e.qZA()()(),e.TgZ(44,"ion-content")(45,"ion-list"),e.YNc(46,q,35,9,"ion-item-group",15),e.qZA()()),2&i&&(e.xp6(3),e.Oqu(t.tituloVentana),e.xp6(12),e.Oqu(t.FormModel.modelo),e.xp6(3),e.Oqu(t.FormModel.marca),e.xp6(3),e.Oqu(t.FormModel.tipo),e.xp6(3),e.Oqu(t.FormModel.potencia),e.xp6(6),e.Q6J("enableOnOffLabels",!0)("checked",!0)("ngModel",t.FormModel.ot),e.xp6(2),e.Q6J("enableOnOffLabels",!0)("checked",!0)("ngModel",t.FormModel.pd),e.xp6(3),e.Q6J("enableOnOffLabels",!0)("checked",!0)("ngModel",t.FormModel.im),e.xp6(2),e.Q6J("enableOnOffLabels",!0)("checked",!0)("ngModel",t.FormModel.it),e.xp6(3),e.Q6J("ngModel",t.search_term_equipo),e.xp6(6),e.Q6J("ngForOf",t.results_equipos))},dependencies:[a.Pc,a.YG,a.Sm,a.hM,a.W2,a.Gu,a.gu,a.Ie,a.rH,a.Ub,a.Q$,a.q_,a.uN,a.VI,a.yW,a.wd,a.ho,a.sr,a.w,a.j9,P.ez,P.sg,p.u5,p.JJ,p.On],styles:["ion-item[_ngcontent-%COMP%]{min-height:0px}"]}),c})()}}]);