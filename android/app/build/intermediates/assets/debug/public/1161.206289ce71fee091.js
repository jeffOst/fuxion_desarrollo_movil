"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1161],{1161:(U,b,r)=>{r.r(b),r.d(b,{MttoWinOrdenTrabajo5Page:()=>s});var p=r(5861),f=r(6814),m=r(95),a=r(6728),e=r(1243),t=r(6242),E=r(5472),P=r(1991),O=r(2014),M=r(6172);const g=["IdHtmlInputSearch"],h=()=>({standalone:!0});function d(n,l){if(1&n){const _=t.EpF();t.TgZ(0,"ion-datetime",16),t.NdJ("ngModelChange",function(i){t.CHM(_);const c=t.oxw();return t.KtG(c.ng_fch_ini_inf=i)}),t.qZA()}if(2&n){const _=t.oxw();t.Q6J("preferWheel",!0)("showDefaultButtons",!0)("ngModel",_.ng_fch_ini_inf)("ngModelOptions",t.DdM(4,h))}}let s=(()=>{var n;class l{constructor(o,i,c,u,C,T,A,v){this.navCtrl=o,this.loadingController=i,this.ApiService=c,this.storage=u,this.formBuilder=C,this.alertController=T,this.globalVal=A,this.modalCtrl=v,this.ArrayItemsSelectedDesti=[],this.estaCargando=!1,this.scanActive=!0,this.FormCheckListPaso5=this.formBuilder.group({fch_entrega_mtto:[""],codsmg:[""],correlativo_mtto:[""],obs_entrega:[""],id_orden_trab_cab_2:this.globalVal.id_orden_trab_cab,idusuario:[""],id_orden_trab_cab:[""],guia_salida_mtto:[""],r_nucleo:[""],equipo_ini:[""],cod_nucleo_lt:[""]})}ngOnInit(){let o;this.estaCargando=!0,this.storage.get("USER_INFO").then(i=>{o=i,this.NombresUsuarioLocal=o.user_name,this.IdUsuarioLocal=o.user_id,console.log(o)}),this.FLoadmot()}onTouched(o){console.log(o)}mostrarConfirmacion(){var o=this;return(0,p.Z)(function*(){yield(yield o.alertController.create({header:"Confirmaci\xf3n",message:"\xbfDesea realizar esta acci\xf3n?",cssClass:"alerta-confirma",mode:"ios",buttons:[{text:"Cancelar",role:"cancel",handler:()=>{console.log("Acci\xf3n cancelada")}},{text:"Aceptar",handler:()=>{o.SaveFormTerminadoPaso1()}}]})).present()})()}SaveFormTerminadoPaso1(){var o=this;return(0,p.Z)(function*(){o.loadingController.create({message:"Guardando O.T...",translucent:!0}).then(c=>{c.present()}),console.log("FORMULARIOOOOOO:",o.FormCheckListPaso5.value),o.FormCheckListPaso5.controls.fch_entrega_mtto.setValue(o.ng_fch_ini_inf),yield o.ApiService.GuardarFormPaso5(o.FormCheckListPaso5.value).then(function(){var c=(0,p.Z)(function*(u){o.loadingController.dismiss(),console.log(u);let C="0"==u[0].o_nres?"alerta-error":"alerta-ok";yield(yield o.alertController.create({header:"ORDEN DE TRABAJO",subHeader:"MATERIALES",cssClass:C,mode:"ios",animated:!0,message:u[0].o_msj,buttons:[{text:"Aceptar",handler:()=>{console.log("Operaci\xf3n confirmada")}}]})).present()});return function(u){return c.apply(this,arguments)}}()).finally(()=>{console.log("finally:::>>LN:394")}).catch(c=>{console.log("errror:::>>>>>>>>>",c)})})()}ionViewWillEnter(){let o;this.estaCargando=!0,this.storage.get("USER_INFO").then(i=>{o=i,this.NombresUsuarioLocal=o.user_name,this.IdUsuarioLocal=o.user_id})}open_popup_bombas(){var o=this;return(0,p.Z)(function*(){if(1==o.FormCheckListPaso5.controls.guia_salida_mtto.value)return void(yield(yield o.alertController.create({header:"Alerta",message:"Este motor ya a sido enviado a mina, no se aceptan modificaciones",cssClass:"alerta-confirma",mode:"ios",buttons:[{text:"Aceptar",handler:()=>{}}]})).present());const Z=yield o.modalCtrl.create({component:e.PopUpBombaPage,backdropDismiss:!0,showBackdrop:!0,mode:"ios",componentProps:{id_orden_trab_cab:void 0}});return Z.onDidDismiss().then(D=>{null!==D&&(o.dataReturned=D.data,console.log("datos",o.dataReturned),o.FormCheckListPaso5.controls.codsmg.setValue(o.dataReturned.codsmg),o.FormCheckListPaso5.controls.correlativo_mtto.setValue(o.dataReturned.id_orden_trab_fis_cab),o.FormCheckListPaso5.controls.id_orden_trab_cab.setValue(o.dataReturned.id_orden_trab_cab))}),yield Z.present()})()}FLoadmot(){this.loadingController.create({message:"Cargando lista....",translucent:!0}).then(i=>{i.present(),this.ApiService.FormFindPaso2(this.globalVal.id_orden_trab_cab).then(c=>{this.EditDataRest=c.form,console.log("hrlppp",c.form);try{this.FormCheckListPaso5.setValue({id_orden_trab_cab_2:this.globalVal.id_orden_trab_cab,fch_entrega_mtto:this.EditDataRest[0].fch_entrega_mtto,codsmg:this.EditDataRest[0].equipo_mtto,obs_entrega:this.EditDataRest[0].obs_mtto,correlativo_mtto:this.EditDataRest[0].correlativo_mtto,idusuario:this.IdUsuarioLocal,id_orden_trab_cab:this.EditDataRest[0].nro_ot_salida_mtto,guia_salida_mtto:this.EditDataRest[0].guia_salida_mtto,r_nucleo:this.EditDataRest[0].r_nucleo_listmot,equipo_ini:this.EditDataRest[0].equipo_ini,cod_nucleo_lt:this.EditDataRest[0].cod_nucleo_lt}),this.ng_fch_ini_inf=this.EditDataRest[0].fch_entrega_mtto,console.log(this.EditDataRest)}catch(u){console.log("error:::>",u)}}).finally(()=>{this.loadingController.dismiss()})})}}return(n=l).\u0275fac=function(o){return new(o||n)(t.Y36(E.SH),t.Y36(a.HT),t.Y36(P.k),t.Y36(O.K),t.Y36(m.QS),t.Y36(a.Br),t.Y36(M.X),t.Y36(a.IN))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-mtto-win-orden-trabajo5"]],viewQuery:function(o,i){if(1&o&&t.Gf(g,5),2&o){let c;t.iGM(c=t.CRH())&&(i.IdHtmlInputSearch=c.first)}},standalone:!0,features:[t.jDz],decls:47,vars:2,consts:[["mode","ios"],["text-capitalize",""],[1,"ion-padding"],[3,"formGroup"],["mode","ios",1,"ion-no-padding"],["label","F.Registro Guia:","locale","es-PE","datetime","datetime"],["trigger","popover-button","animated","true","arrow","true","mode","ios",3,"keepContentsMounted"],["readonly","","color","primary","formControlName","fch_entrega_mtto"],["readonly","","formControlName","equipo_ini"],["type","text","placeholder","Seleccionar Bomba","mode","ios","readonly","","formControlName","codsmg",3,"click"],["formControlName","correlativo_mtto","readonly",""],["formControlName","obs_entrega"],["mode","ios","formControlName","r_nucleo",3,"ionChange"],["value","1"],["value","2"],["color","primary","expand","full",3,"click"],["locale","es-PE","id","datetime","mode","ios","displayFormat","YYYY-MM-DD HH:mm","presentation","date-time","pickerFormat","YYYY-MM-DD HH:mm",3,"preferWheel","showDefaultButtons","ngModel","ngModelOptions","ngModelChange"]],template:function(o,i){1&o&&(t.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-item")(3,"ion-title",1)(4,"ion-label"),t._uU(5,"ENTREGA DE MOTOR"),t.qZA()()()()(),t.TgZ(6,"ion-content",2)(7,"form",3)(8,"ion-list",4)(9,"ion-item")(10,"ion-label"),t._uU(11,"F. Asignacion:"),t.qZA(),t._UZ(12,"ion-datetime-button",5),t.TgZ(13,"ion-popover",6),t.YNc(14,d,1,5,"ng-template"),t.qZA()(),t.TgZ(15,"ion-item")(16,"ion-label"),t._uU(17,"F. Lectura:"),t.qZA(),t._UZ(18,"ion-input",7),t.qZA(),t.TgZ(19,"ion-item")(20,"ion-label"),t._uU(21,"Equipo Inicial: \xa0"),t.qZA(),t._UZ(22,"ion-input",8),t.qZA(),t.TgZ(23,"ion-item")(24,"ion-searchbar",9),t.NdJ("click",function(){return i.open_popup_bombas()}),t._uU(25," Equipo Final:\xa0 "),t.qZA()(),t.TgZ(26,"ion-item")(27,"ion-label"),t._uU(28,"Correlativo: \xa0 "),t.qZA(),t._UZ(29,"ion-input",10),t.qZA(),t.TgZ(30,"ion-item")(31,"ion-label"),t._uU(32,"Observaciones:\xa0 "),t.qZA(),t._UZ(33,"ion-input",11),t.qZA(),t.TgZ(34,"ion-item")(35,"ion-label"),t._uU(36," R. Nucleo: "),t.TgZ(37,"ion-segment",12),t.NdJ("ionChange",function(u){return i.onTouched(u)}),t.TgZ(38,"ion-segment-button",13)(39,"ion-label"),t._uU(40,"SI"),t.qZA()(),t.TgZ(41,"ion-segment-button",14)(42,"ion-label"),t._uU(43,"NO"),t.qZA()()()()()()()(),t.TgZ(44,"ion-footer")(45,"ion-button",15),t.NdJ("click",function(){return i.mostrarConfirmacion()}),t._uU(46,"Guardar Cambios"),t.qZA()()),2&o&&(t.xp6(7),t.Q6J("formGroup",i.FormCheckListPaso5),t.xp6(6),t.Q6J("keepContentsMounted",!0))},dependencies:[a.Pc,a.YG,a.W2,a.x4,a.Mj,a.fr,a.Gu,a.pK,a.Ie,a.Q$,a.q_,a.VI,a.cJ,a.GO,a.wd,a.sr,a.d8,a.QI,a.j9,f.ez,m.u5,m._Y,m.JJ,m.JL,m.On,m.UX,m.sg,m.u]}),l})()},1243:(U,b,r)=>{r.r(b),r.d(b,{PopUpBombaPage:()=>M});var p=r(5861),f=r(6814),m=r(95),a=r(6728),e=r(6242),t=r(5472),E=r(1991),P=r(6172);function O(g,h){if(1&g){const d=e.EpF();e.TgZ(0,"ion-list",9)(1,"ion-item",10),e.NdJ("click",function(){const l=e.CHM(d).$implicit,_=e.oxw();return e.KtG(_.FSelectedItem(l.codsmg,l.id_orden_trab_fis_cab,l.nombre,l.id_orden_trab_cab,l.ot_estado_general,l.guia_salida_mtto))}),e.TgZ(2,"ion-label")(3,"strong"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA(),e.TgZ(7,"p"),e._uU(8),e.qZA(),e.TgZ(9,"p"),e._uU(10),e.qZA(),e.TgZ(11,"p"),e._uU(12),e.qZA()()()()}if(2&g){const d=h.$implicit,n=h.even;e.ekj("odd",h.odd)("even",n),e.xp6(4),e.Oqu(d.codsmg),e.xp6(2),e.Oqu(d.id_orden_trab_fis_cab+" - Motor: "+d.cod_motor_mtto),e.xp6(2),e.Oqu("Tecnico: "+d.tecnico),e.xp6(2),e.Oqu("Estado O.T: "+d.nombre),e.xp6(1),e.Udp("color","DISPONIBLE"===d.guia_salida_mtto?"green":"red"),e.xp6(1),e.Oqu("Estado Bomba: "+d.guia_salida_mtto)}}let M=(()=>{var g;class h{constructor(s,n,l,_,o,i){this.loadingController=s,this.modalCtrl=n,this.ApiService=l,this.navParams=_,this.alertController=o,this.globalVal=i,this.codsmg=_.get("codsmg"),this.id_orden_trab_fis_cab=_.get("id_orden_trab_fis_cab"),this.nombre=_.get("nombre"),this.id_orden_trab_cab=_.get("id_orden_trab_cab"),this.ot_estado_general=_.get("ot_estado_general"),this.id_orden_trab_cab2=i.id_orden_trab_cab}ngOnInit(){}cancelar_listaservicios(s,n,l,_,o){var i=this;return(0,p.Z)(function*(){const c={id_orden_trab_fis_cab:n,codsmg:s,nombre:l,id_orden_trab_cab:_,ot_estado_general:o};yield i.modalCtrl.dismiss(c)})()}ionViewDidEnter(){this.FFindRows()}FFindRows(){this.loadingController.create({message:"Cargando lista...",translucent:!0}).then(n=>{n.present(),console.log(this.id_orden_trab_cab2),this.ApiService.ListBombasDisponible(this.NgModInputSearch,this.id_orden_trab_cab2).then(l=>{this.DataSetGrid=l}).finally(()=>{this.loadingController.dismiss()})})}FSelectedItem(s,n,l,_,o,i){"ENVIADO A MINA"==i?this.mostrarmnsj2():3==o?(this.mostrarmnsj1(s),this.cancelar_listaservicios(s,n,l,_,o)):this.mostrarmnsj()}mostrarmnsj1(s){var n=this;return(0,p.Z)(function*(){yield(yield n.alertController.create({header:"Asignacion Motor",message:`Esta asignando este motor a la bomba  ${s}`,cssClass:"alerta-confirma",mode:"ios",buttons:[{text:"Aceptar",handler:()=>{}}]})).present()})()}mostrarmnsj(){var s=this;return(0,p.Z)(function*(){yield(yield s.alertController.create({header:"Atenci\xf3n",message:"No se puede aperturar el registro, el estado debe ser aprobado",cssClass:"alerta-confirma",mode:"ios",buttons:[{text:"Aceptar",handler:()=>{}}]})).present()})()}mostrarmnsj2(){var s=this;return(0,p.Z)(function*(){yield(yield s.alertController.create({header:"Atenci\xf3n",message:"La bomba seleccionada, a sido enviada a Mina, no se puede seleccionar",cssClass:"alerta-confirma",mode:"ios",buttons:[{text:"Aceptar",handler:()=>{}}]})).present()})()}}return(g=h).\u0275fac=function(s){return new(s||g)(e.Y36(a.HT),e.Y36(a.IN),e.Y36(E.k),e.Y36(t.X1),e.Y36(a.Br),e.Y36(P.X))},g.\u0275cmp=e.Xpm({type:g,selectors:[["app-pop-up-bomba"]],standalone:!0,features:[e.jDz],decls:15,vars:2,consts:[["mode","ios"],["slot","start"],[1,"",3,"click"],["part","icon","aria-hidden","true","role","img","name","chevron-back-outline",1,"md","hydrated"],["mode","ios","cancelButtonText","Cancelar","enterkeyhint","done","placeholder","Filtrar Servicios",2,"width","98%",3,"ngModel","ngModelChange"],["IdHtmlInputSearch",""],["slot","end","name","sync-outline",3,"click"],["idIconButtonSync",""],["lines","full","inset","true",3,"odd","even",4,"ngFor","ngForOf"],["lines","full","inset","true"],["button","",3,"click"]],template:function(s,n){1&s&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),e._uU(3,"Lista de Bombas"),e.qZA(),e.TgZ(4,"ion-buttons",1)(5,"ion-button",2),e.NdJ("click",function(){return n.cancelar_listaservicios(0,0,0,0,0)}),e._UZ(6,"ion-icon",3),e._uU(7," Cancelar "),e.qZA()()()(),e.TgZ(8,"ion-content")(9,"ion-item")(10,"ion-searchbar",4,5),e.NdJ("ngModelChange",function(_){return n.NgModInputSearch=_}),e.qZA(),e.TgZ(12,"ion-icon",6,7),e.NdJ("click",function(){return n.FFindRows()}),e.qZA()(),e.YNc(14,O,13,11,"ion-list",8),e.qZA()),2&s&&(e.xp6(10),e.Q6J("ngModel",n.NgModInputSearch),e.xp6(4),e.Q6J("ngForOf",n.DataSetGrid))},dependencies:[a.Pc,a.YG,a.Sm,a.W2,a.Gu,a.gu,a.Ie,a.Q$,a.q_,a.VI,a.wd,a.sr,a.j9,f.ez,f.sg,m.u5,m.JJ,m.On]}),h})()}}]);