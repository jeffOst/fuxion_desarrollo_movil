"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1874],{1874:(F,f,_)=>{_.r(f),_.d(f,{MttoWinOrdenTrabajo3Page:()=>y});var d=_(5861),p=_(6814),h=_(95),i=_(6728),b=_(9911),o=_(6242),O=_(5472),C=_(1991),P=_(2014),M=_(4248),E=_(6172);const A=["listenerOut"];function v(c,u){if(1&c){const a=o.EpF();o.TgZ(0,"ion-item-divider",11)(1,"ion-label"),o._uU(2,"\xa0"),o.TgZ(3,"strong"),o._uU(4),o.qZA()(),o.TgZ(5,"ion-chip",4),o.NdJ("click",function(){o.CHM(a);const e=o.oxw().$implicit,n=o.oxw();return o.KtG(n.agregarItem(e))}),o.TgZ(6,"ion-label"),o._uU(7,"Agregar"),o.qZA(),o._UZ(8,"ion-icon",5),o.qZA()()}if(2&c){const a=o.oxw().$implicit;o.xp6(4),o.Oqu(a.nomclase)}}function x(c,u){if(1&c){const a=o.EpF();o.TgZ(0,"ion-item",12)(1,"ion-button",13),o.NdJ("click",function(e){o.CHM(a);const n=o.oxw().$implicit,l=o.oxw();return o.KtG(l.FItemEliminar(e,n))}),o._uU(2," Quitar "),o._UZ(3,"ion-icon",14),o.qZA(),o.TgZ(4,"ion-toggle",15),o.NdJ("ionChange",function(e){o.CHM(a);const n=o.oxw().$implicit,l=o.oxw();return o.KtG(l.FasignaServicio(e,n))}),o.TgZ(5,"p",16)(6,"ion-badge",17),o._uU(7),o.qZA(),o.TgZ(8,"ion-text",18),o._uU(9),o.qZA(),o._uU(10," Cnt.Teorica: "),o.TgZ(11,"ion-text",19),o._uU(12),o.qZA()()(),o.TgZ(13,"ion-input",20),o.NdJ("ngModelChange",function(e){o.CHM(a);const n=o.oxw().$implicit;return o.KtG(n.otd_cantidad=e)})("ionBlur",function(e){o.CHM(a);const n=o.oxw().$implicit,l=o.oxw();return o.KtG(l.FBlourInput(e,n))}),o.qZA()()}if(2&c){const a=o.oxw().$implicit;o.xp6(4),o.Q6J("disabled","0"===a.habilitar_toggle)("checked","1"===a.check_toggle),o.xp6(2),o.s9C("color",a.color_atendido),o.xp6(1),o.Oqu(a.estado_abre),o.xp6(2),o.Oqu(a.nomclase),o.xp6(3),o.Oqu(a.otd_cantidad_plan),o.xp6(1),o.Q6J("disabled","0"===a.habilitar_input)("ngModel",a.otd_cantidad)}}function Z(c,u){if(1&c&&(o.TgZ(0,"ion-item-group"),o.YNc(1,v,9,1,"ion-item-divider",9)(2,x,14,8,"ion-item",10),o.qZA()),2&c){const a=u.$implicit;o.xp6(1),o.Q6J("ngIf","1"===a.orden),o.xp6(1),o.Q6J("ngIf","2"===a.orden)}}let y=(()=>{var c;class u{constructor(t,e,n,l,r,s,T,m,I,D,U){let g;this.navCtrl=t,this.loadingController=e,this.ApiService=n,this.storage=l,this.alertController=r,this.router=s,this.globalVal=T,this.ref=m,this.actionSheetCtrl=I,this.toastController=D,this.modalCtrl=U,this.DsServiciosxPieza={},this.ValuesAcordionGroup=["551571","551579"],this.storage.get("USER_INFO").then(W=>{g=W,this.NombresUsuarioLocal=g.user_name,this.IdUsuarioLocal=g.user_id,this.storage.get("DEVICE_INFO").then(j=>{g=j,this.NombreDispositivo=g.name,this.IdDispositivo=g.uuid})})}ngOnInit(){}ionViewWillEnter(){this.FLoadPiezasAcordion()}FLoadPiezasAcordion(){this.loadingController.create({message:"Cargando lista....",translucent:!0}).then(e=>{e.present(),console.log(this.corre_inf_cab),this.ApiService.ListServiciosxBomba(this.globalVal.id_orden_trab_cab,this.IdUsuarioLocal).then(n=>{this.EditDataRest=n}).finally(()=>{this.loadingController.dismiss()})})}presentToast(t){var e=this;return(0,d.Z)(function*(){console.log("ingreso toast"),yield(yield e.toastController.create({message:t,duration:1500,position:"bottom"})).present()})()}FasignaServicio(t,e){var n=this;return(0,d.Z)(function*(){console.log(t),e.check_toggle=t.detail.checked?"1":"0",e.habilitar_input=t.detail.checked?"1":"0",yield n.ApiService.GuardarFormPaso2(e,n.IdUsuarioLocal).then(function(){var r=(0,d.Z)(function*(s){console.log(s),n.presentToast(s[0].o_msj)});return function(s){return r.apply(this,arguments)}}()).finally(()=>{}).catch(r=>{console.log("errror:::>>>>>>>>>",r)})})()}FBlourInput(t,e){var n=this;return(0,d.Z)(function*(){console.log(t),yield n.ApiService.GuardarFormPaso2(e,n.IdUsuarioLocal).then(function(){var r=(0,d.Z)(function*(s){console.log(s),n.presentToast(s[0].o_msj)});return function(s){return r.apply(this,arguments)}}()).finally(()=>{}).catch(r=>{console.log("errror:::>>>>>>>>>",r)}),t.preventDefault()})()}agregarItem(t){var e=this;return(0,d.Z)(function*(){console.log(t);const n=yield e.modalCtrl.create({component:b.MttoOtisPopUpAddItemPage,backdropDismiss:!0,showBackdrop:!0,mode:"ios",componentProps:{row:t}});return n.onDidDismiss().then(function(){var l=(0,d.Z)(function*(r){e.FLoadPiezasAcordion(),null!==r&&(e.dataReturned=r.data,console.log("Modal Sent Data :",e.dataReturned),"1"==r.data.o_nres||console.log("no guardo nada"))});return function(r){return l.apply(this,arguments)}}()),yield n.present()})()}agregarItemSinPieza(){this.agregarItem({idclase:0,nomclase:"Sin Pieza Definida",rs:"0",id_orden_trab_cab:this.globalVal.id_orden_trab_cab})}mostrarConfirmacion(){var t=this;return(0,d.Z)(function*(){yield(yield t.alertController.create({header:"Confirmaci\xf3n",message:"\xbfDesea realizar esta acci\xf3n?",cssClass:"alerta-confirma",mode:"ios",buttons:[{text:"Cancelar",role:"cancel",handler:()=>{console.log("Acci\xf3n cancelada")}},{text:"Aceptar",handler:()=>{t.SaveFormTerminadoPaso1()}}]})).present()})()}SaveFormTerminadoPaso1(){var t=this;return(0,d.Z)(function*(){t.loadingController.create({message:"Guardando O.T...",translucent:!0}).then(n=>{n.present()}),yield t.ApiService.GuardarOtTerminado(t.globalVal.id_orden_trab_cab,t.IdUsuarioLocal).then(function(){var n=(0,d.Z)(function*(l){t.loadingController.dismiss(),console.log(l);let r="0"==l[0].o_nres?"alerta-error":"alerta-ok";yield(yield t.alertController.create({header:"ORDEN DE TRABAJO",subHeader:"MATERIALES",cssClass:r,mode:"ios",animated:!0,message:l[0].o_msj,buttons:[{text:"Aceptar",handler:()=>{console.log("Operaci\xf3n confirmada"),"1"==l[0].o_nres&&t.navCtrl.navigateForward(["mtto-list-orden-trabajo"])}}]})).present()});return function(l){return n.apply(this,arguments)}}()).finally(()=>{console.log("finally:::>>LN:394")}).catch(n=>{console.log("errror:::>>>>>>>>>",n)})})()}FItemEliminar(t,e){var n=this;return(0,d.Z)(function*(){console.log(t,e),yield(yield n.alertController.create({header:"Confirmaci\xf3n",message:"\xbfDesea quitar el item seleccionado?",cssClass:"alerta-confirma",mode:"ios",buttons:[{text:"Cancelar",role:"cancel",handler:()=>{console.log("Acci\xf3n cancelada")}},{text:"Aceptar",handler:()=>{n.FQuitarItem(e)}}]})).present()})()}FQuitarItem(t){var e=this;return(0,d.Z)(function*(){e.loadingController.create({message:"Guardando O.T...",translucent:!0}).then(r=>{r.present()});const l=[t];console.log('// Recorre el array y agrega la columna "idusuario" a cada objeto',t),l.forEach(r=>{r.IdUsuarioLocal=e.IdUsuarioLocal,r.acc=30}),console.log(l),yield e.ApiService.FQuitarItem(l[0]).then(function(){var r=(0,d.Z)(function*(s){if(e.loadingController.dismiss(),console.log(s),e.presentToast(s[0].o_msj),console.log(s[0].o_nres),"1"==s[0].o_nres){const m=e.EditDataRest.indexOf(t);m>-1&&e.EditDataRest.splice(m,1)}});return function(s){return r.apply(this,arguments)}}()).finally(()=>{console.log("finally:::>>LN:394")}).catch(r=>{console.log("errror:::>>>>>>>>>",r)})})()}}return(c=u).\u0275fac=function(t){return new(t||c)(o.Y36(O.SH),o.Y36(i.HT),o.Y36(C.k),o.Y36(P.K),o.Y36(i.Br),o.Y36(M.F0),o.Y36(E.X),o.Y36(o.sBO),o.Y36(i.BX),o.Y36(i.yF),o.Y36(i.IN))},c.\u0275cmp=o.Xpm({type:c,selectors:[["app-mtto-win-orden-trabajo3"]],viewQuery:function(t,e){if(1&t&&o.Gf(A,7),2&t){let n;o.iGM(n=o.CRH())&&(e.listenerOut=n.first)}},standalone:!0,features:[o.jDz],decls:20,vars:2,consts:[["mode","ios"],["slot","start","color","primary",3,"click"],["name","refresh-outline"],["text-capitalize",""],["slot","end","mode","ios","color","primary",3,"click"],["name","add"],[1,"ion-padding"],[4,"ngFor","ngForOf"],["expand","full","color","primary",3,"disabled","click"],["button","true","class","divider",4,"ngIf"],["style","border-style: hidden",4,"ngIf"],["button","true",1,"divider"],[2,"border-style","hidden"],["color","danger","slot","start","no-padding","",2,"margin-inline-end","2px",3,"click"],["name","trash","slot","start"],["mode","ios","labelPlacement","start",2,"width","98%","border-style","hidden",3,"disabled","checked","ionChange"],[2,"font-size","small"],["slot","end",3,"color"],["color","primary"],["color","secondary"],["slot","end","type","number",2,"text-align","end","height","35px !important","width","15%","border-color","black","margin-inline-start","2px","border","1px",3,"disabled","ngModel","ngModelChange","ionBlur"]],template:function(t,e){1&t&&(o.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-item")(3,"ion-chip",1),o.NdJ("click",function(){return e.FLoadPiezasAcordion()}),o._UZ(4,"ion-icon",2),o.TgZ(5,"ion-label"),o._uU(6,"Actualizar"),o.qZA()(),o.TgZ(7,"ion-title",3)(8,"ion-label"),o._uU(9,"SERVICIOS INTERNOS Y EXTERNOS "),o.qZA()(),o.TgZ(10,"ion-chip",4),o.NdJ("click",function(){return e.agregarItemSinPieza()}),o.TgZ(11,"ion-label"),o._uU(12,"Agregar"),o.qZA(),o._UZ(13,"ion-icon",5),o.qZA()()()(),o.TgZ(14,"ion-content",6)(15,"ion-list"),o.YNc(16,Z,3,2,"ion-item-group",7),o.qZA()(),o.TgZ(17,"ion-footer")(18,"ion-button",8),o.NdJ("click",function(){return e.mostrarConfirmacion()}),o._uU(19,"Terminado"),o.qZA()()),2&t&&(o.xp6(16),o.Q6J("ngForOf",e.EditDataRest),o.xp6(2),o.Q6J("disabled",e.globalVal.ot_estado_general>"2"))},dependencies:[i.Pc,i.yp,i.YG,i.hM,i.W2,i.fr,i.Gu,i.gu,i.pK,i.Ie,i.rH,i.Ub,i.Q$,i.q_,i.yW,i.wd,i.ho,i.sr,i.w,i.as,p.ez,p.sg,p.O5,h.u5,h.JJ,h.On],styles:[".divider[_ngcontent-%COMP%]{color:#000;font-weight:700;background-color:#d7d8da;padding:0!important;border-radius:5px;border-width:2px;font-weight:bolder}"]}),u})()}}]);