"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9911],{9911:(E,M,d)=>{d.r(M),d.d(M,{MttoOtisPopUpAddItemPage:()=>I});var _=d(5861),m=d(6814),p=d(95),n=d(6728),e=d(6242),f=d(5472),C=d(1991),P=d(4248),T=d(2014);const O=["idinputsearch_equipo"];function Z(r,c){if(1&r&&(e.TgZ(0,"ion-select-option",20),e._uU(1),e.qZA()),2&r){const l=c.$implicit;e.Q6J("value",l.codigo),e.xp6(1),e.hij("",l.nombre," ")}}function U(r,c){1&r&&(e.TgZ(0,"ion-col",17),e._uU(1,"Stock Alm.General"),e.qZA())}function F(r,c){if(1&r&&(e.TgZ(0,"ion-col",25),e._uU(1),e.qZA()),2&r){const l=e.oxw().$implicit;e.xp6(1),e.Oqu(l.Y08056)}}function v(r,c){if(1&r){const l=e.EpF();e.TgZ(0,"ion-row",21),e.NdJ("click",function(){const i=e.CHM(l).$implicit,t=e.oxw();return e.KtG(t.SeleccionarEquipo(i))}),e.TgZ(1,"ion-col",22),e._uU(2),e.qZA(),e.TgZ(3,"ion-col",23),e._uU(4),e.qZA(),e.YNc(5,F,2,1,"ion-col",24),e.TgZ(6,"ion-col",25),e._uU(7),e.qZA(),e.TgZ(8,"ion-col",22)(9,"ion-chip"),e._UZ(10,"ion-icon",26),e.TgZ(11,"ion-label",27),e._uU(12),e.qZA(),e._UZ(13,"ion-icon",28),e.qZA()()()}if(2&r){const l=c.$implicit,a=e.oxw();e.ekj("selected",1===a.selectedRow),e.xp6(2),e.Oqu(l.Y04001),e.xp6(2),e.Oqu(l.Y04002),e.xp6(1),e.Q6J("ngIf","1"===a.FormModel.rs),e.xp6(2),e.Oqu(l.ma00_descrip),e.xp6(5),e.Oqu(l.nomclase)}}let I=(()=>{var r;class c{constructor(a,o,i,t,s,u,A,h){let g;this.loadingController=a,this.ApiService=o,this.modalCtrl=i,this.route=t,this.navParams=s,this.alertController=u,this.toastController=A,this.storage=h,this.search_term_equipo="",this.switchButtonSegmento="",this.selectedRow=null,this.tituloVentana="",this.storage.get("USER_INFO").then(q=>{g=q,this.NombresUsuarioLocal=g.user_name,this.IdUsuarioLocal=g.user_id,this.parametro=this.navParams.get("param1")}),this.FormModel={},this.FormModel.idpieza=this.navParams.get("row").idclase,this.FormModel.pieza=this.navParams.get("row").nomclase,this.FormModel.rs=this.navParams.get("row").rs,this.FormModel.toggle="0"!=this.FormModel.idpieza,this.FormModel.o_nres=0,this.FormModel.window="0"==this.FormModel.idpieza,this.tituloVentana="1"==this.FormModel.rs?"Agregar Materiales":"Agregar Servicios",this.FormModel.id_orden_trab_cab=this.navParams.get("row").id_orden_trab_cab}ngOnInit(){}cancelar_listaequipos(a,o,i){var t=this;return(0,_.Z)(function*(){const s={idequipo:a,id_orden_trab_fis_cab:o,fch_inicio_ot:i};yield t.modalCtrl.dismiss(s)})()}lista_equipos(a){a.preventDefault(),console.log(this.parametro),this.loadingController.create({message:"Cargando lista...::",translucent:!0}).then(i=>{i.present(),this.ApiService.listadoArticulos(this.search_term_equipo,this.FormModel.idpieza,this.FormModel.cantidad,this.FormModel.toggle,"1"==this.FormModel.rs?"22":"25",this.parametro).then(s=>{this.results_equipos=s,this.loadingController.dismiss()}).finally(()=>{this.loadingController.dismiss(),setTimeout(()=>{},700)})})}SeleccionarEquipo(a){var o=this;return(0,_.Z)(function*(){yield(yield o.alertController.create({header:"Confirmaci\xf3n",message:"\xbfDesea agregar este producto?",cssClass:"alerta-confirma",mode:"ios",buttons:[{text:"Cancelar",role:"cancel",handler:()=>{console.log("Acci\xf3n cancelada")}},{text:"Aceptar",handler:()=>{o.SaveItemAdded(a)}}]})).present()})()}SaveItemAdded(a){var o=this;return(0,_.Z)(function*(){console.log(o.FormModel.cantidad),console.log(o.FormModel),""!=o.FormModel.cantidad&&o.FormModel.cantidad>0?(o.loadingController.create({message:"Guardando item...",translucent:!0}).then(t=>{t.present()}),o.FormModel.Y04001=a.Y04001,o.FormModel.IdUsuarioLocal=o.IdUsuarioLocal,yield o.ApiService.GuardarArticulo(o.FormModel).then(function(){var t=(0,_.Z)(function*(s){o.loadingController.dismiss(),console.log(s);let u="0"==s[0].o_nres?"alerta-error":"alerta-ok";var h;yield(yield o.alertController.create({header:"ORDEN DE TRABAJO",subHeader:"MATERIALES",cssClass:u,mode:"ios",animated:!0,message:s[0].o_msj,buttons:[{text:"Aceptar",handler:(h=(0,_.Z)(function*(){if(console.log("Operaci\xf3n confirmada"),o.FormModel.o_nres=s[0].o_nres,"1"==s[0].o_nres){if(console.log(o.FormModel.window),o.presentToast(s[0].o_msj),!o.FormModel.window){const g=o.FormModel;yield o.modalCtrl.dismiss(g)}}else o.presentToast(s[0].o_msj)}),function(){return h.apply(this,arguments)})}]})).present()});return function(s){return t.apply(this,arguments)}}()).finally(()=>{console.log("finally:::>>LN:394")}).catch(t=>{console.log("errror:::>>>>>>>>>",t)})):yield(yield o.alertController.create({header:"ORDEN DE TRABAJO",subHeader:"MATERIALES",cssClass:"alerta-error",mode:"ios",animated:!0,message:"Falta asignar cantidad",buttons:[{text:"Aceptar",handler:()=>{console.log("Operaci\xf3n confirmada")}}]})).present()})()}FSelectChangeTipoMotivo(a){}ionViewWillEnter(){this.FLoadForms()}FLoadForms(){this.loadingController.create({message:"Cargando lista....",translucent:!0}).then(o=>{o.present(),this.ApiService.FLoadMotivoAdicional("0","1").then(i=>{this.DsTipoMotivo=i.motivo,o.dismiss()})})}presentToast(a){var o=this;return(0,_.Z)(function*(){console.log("ingreso toast"),yield(yield o.toastController.create({message:a,duration:1500,position:"bottom"})).present()})()}}return(r=c).\u0275fac=function(a){return new(a||r)(e.Y36(n.HT),e.Y36(C.k),e.Y36(n.IN),e.Y36(P.gz),e.Y36(f.X1),e.Y36(n.Br),e.Y36(n.yF),e.Y36(T.K))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-mtto-otis-pop-up-add-item"]],viewQuery:function(a,o){if(1&a&&e.Gf(O,5),2&a){let i;e.iGM(i=e.CRH())&&(o.idinputsearch_equipo=i.first)}},standalone:!0,features:[e.jDz],decls:56,vars:16,consts:[["mode","ios"],["slot","start"],["color","danger",3,"click"],["name","close"],["nopadding",""],["type","text","maxlength","80",3,"ngModel","ngModelChange"],["slot","end","mode","ios","labelPlacement","start",2,"font-size","x-small",3,"checked","ngModel","ngModelChange"],["color","warning"],["mode","ios",3,"autoGrow","autofocus","ngModel","ngModelChange"],["cancelText","Cancelar","placeholder","Seleccionar Motivo","color","primary","interface","action-sheet","mode","ios",3,"ngModel","ionChange","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["show-clear-button","focus","animated","true","mode","ios","debounce","1700","cancelButtonText","Cancelar","enterkeyhint","done","placeholder","Buscar items...","color","secondary",3,"ngModel","ngModelChange","ionInput"],["idinputsearch_equipo",""],[1,"header-grid"],["size","2",1,"header"],["size","6",1,"header"],["class","header","size","1",4,"ngIf"],["size","1",1,"header"],[1,"content-grid"],[3,"selected","click",4,"ngFor","ngForOf"],[3,"value"],[3,"click"],["size","2",1,"detail"],["size","6",1,"detail"],["class","detail","size","1",4,"ngIf"],["size","1",1,"detail"],["name","add-outline"],[2,"font-size","smaller"],["name","caret-forward-outline"]],template:function(a,o){1&a&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),e._uU(3),e.qZA(),e.TgZ(4,"ion-buttons",1)(5,"ion-button",2),e.NdJ("click",function(){return o.cancelar_listaequipos(0,0,0)}),e._UZ(6,"ion-icon",3),e._uU(7," Cancelar "),e.qZA()()(),e.TgZ(8,"ion-item",4)(9,"ion-label",1)(10,"p"),e._uU(11,"Pieza Seleccionada:"),e.qZA()(),e.TgZ(12,"ion-input",5),e.NdJ("ngModelChange",function(t){return o.FormModel.pieza=t}),e.qZA(),e.TgZ(13,"ion-toggle",6),e.NdJ("ngModelChange",function(t){return o.FormModel.toggle=t}),e._uU(14," Aplicar al Filtro de busqueda: "),e.qZA()(),e.TgZ(15,"ion-item",4)(16,"ion-label")(17,"p"),e._uU(18,"Cantidad a Solicitar:"),e.qZA()(),e.TgZ(19,"ion-input",5),e.NdJ("ngModelChange",function(t){return o.FormModel.cantidad=t}),e.qZA(),e.TgZ(20,"ion-toggle",6),e.NdJ("ngModelChange",function(t){return o.FormModel.window=t}),e._uU(21," Agregar items sin cerrar ventana: "),e.qZA()(),e.TgZ(22,"ion-item",4)(23,"ion-label")(24,"p"),e._uU(25,"Observasiones "),e.TgZ(26,"ion-text",7),e._uU(27,"(Adicional)"),e.qZA(),e._uU(28,":"),e.qZA()(),e.TgZ(29,"ion-textarea",8),e.NdJ("ngModelChange",function(t){return o.FormModel.otd_detalle=t}),e.qZA()(),e.TgZ(30,"ion-item",4)(31,"ion-label")(32,"p"),e._uU(33,"Motivo "),e.TgZ(34,"ion-text",7),e._uU(35,"(Adicional)"),e.qZA(),e._uU(36,":"),e.qZA()(),e.TgZ(37,"ion-select",9),e.NdJ("ionChange",function(t){return o.FSelectChangeTipoMotivo(t)})("ngModelChange",function(t){return o.FormModel.motivo_adicional_otd=t}),e.YNc(38,Z,2,2,"ion-select-option",10),e.qZA()(),e.TgZ(39,"ion-item",4)(40,"ion-searchbar",11,12),e.NdJ("ngModelChange",function(t){return o.search_term_equipo=t})("ionInput",function(t){return o.lista_equipos(t)}),e.qZA()()(),e.TgZ(42,"ion-content")(43,"ion-grid",13)(44,"ion-row")(45,"ion-col",14),e._uU(46,"Codigo"),e.qZA(),e.TgZ(47,"ion-col",15),e._uU(48,"Descripci\xf3n"),e.qZA(),e.YNc(49,U,2,0,"ion-col",16),e.TgZ(50,"ion-col",17),e._uU(51,"Unidad Medida"),e.qZA(),e.TgZ(52,"ion-col",14),e._uU(53,"Pieza"),e.qZA()()(),e.TgZ(54,"ion-grid",18),e.YNc(55,v,14,7,"ion-row",19),e.qZA()()),2&a&&(e.xp6(3),e.Oqu(o.tituloVentana),e.xp6(9),e.Q6J("ngModel",o.FormModel.pieza),e.xp6(1),e.Q6J("checked",!0)("ngModel",o.FormModel.toggle),e.xp6(6),e.Q6J("ngModel",o.FormModel.cantidad),e.xp6(1),e.Q6J("checked",!0)("ngModel",o.FormModel.window),e.xp6(9),e.Q6J("autoGrow",!0)("autofocus",!0)("autoGrow",!0)("ngModel",o.FormModel.otd_detalle),e.xp6(8),e.Q6J("ngModel",o.FormModel.motivo_adicional_otd),e.xp6(1),e.Q6J("ngForOf",o.DsTipoMotivo),e.xp6(2),e.Q6J("ngModel",o.search_term_equipo),e.xp6(9),e.Q6J("ngIf","1"===o.FormModel.rs),e.xp6(6),e.Q6J("ngForOf",o.results_equipos))},dependencies:[n.Pc,n.YG,n.Sm,n.hM,n.wI,n.W2,n.jY,n.Gu,n.gu,n.pK,n.Ie,n.Q$,n.Nd,n.VI,n.t9,n.n0,n.yW,n.g2,n.wd,n.ho,n.sr,n.w,n.QI,n.j9,m.ez,m.sg,m.O5,p.u5,p.JJ,p.nD,p.On],styles:['@charset "UTF-8";.ion-row[_ngcontent-%COMP%]{font-size:10px;color:#000;font-weight:700}ion-col[_ngcontent-%COMP%]{font-size:9px;color:#555}ion-col.header[_ngcontent-%COMP%]{border:1px solid #ccc;padding:8px;color:#000;font-weight:700}ion-col.detail[_ngcontent-%COMP%]{border-bottom:1px solid #ccc;padding:4px}.header-grid[_ngcontent-%COMP%]{display:grid;grid-template-rows:auto}.content-grid[_ngcontent-%COMP%]{display:grid;grid-template-rows:repeat(auto-fill,minmax(40px,1fr));overflow-y:scroll;max-height:500px}ion-chip[_ngcontent-%COMP%]{height:25px;font-size:9px;margin-inline:0px;margin-top:0;margin-bottom:0}']}),c})()}}]);